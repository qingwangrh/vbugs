diff --git a/avocado_vt/conf.d/vt_joblock.conf b/avocado_vt/conf.d/vt_joblock.conf
index b901bbfc..23069a1d 100644
--- a/avocado_vt/conf.d/vt_joblock.conf
+++ b/avocado_vt/conf.d/vt_joblock.conf
@@ -1,4 +1,4 @@
 [plugins.vtjoblock]
 # Directory where the lock file will be located. Avocado should have permission
 # to write to this directory.
-dir=/tmp
+dir=/workdir/kar/workspace/tmp
diff --git a/requirements.txt b/requirements.txt
index b23dba19..121d7dc1 100644
--- a/requirements.txt
+++ b/requirements.txt
@@ -1,5 +1,5 @@
-autotest>=0.16.2; python_version < '3.0'
-aexpect>1.5.0
+#autotest>=0.16.2; python_version < '3.0'
+#aexpect>1.5.0
 simplejson>=3.5.3
 netaddr>=0.7.18
 netifaces>=0.10.5
diff --git a/shared/cfg/guest-os/Linux.cfg b/shared/cfg/guest-os/Linux.cfg
index 7efd17b3..7a59ea93 100644
--- a/shared/cfg/guest-os/Linux.cfg
+++ b/shared/cfg/guest-os/Linux.cfg
@@ -127,3 +127,77 @@
         test_timeout = 1800
         check_cmd = 'pgrep stress'
         stop_cmd = "killall -g stress"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    get_time_cmd = date +'TIME: %a %m/%d/%Y %H:%M:%S.%N'
+    shell_prompt = "\[root@.{0,50}][\#\$] "
+    migration_test_command = uname -r
+    grub_file = /boot/grub/grub.conf
+    block_stream, drive_mirror:
+        tmp_dir = "/tmp"
+        md5sum_bin = "md5sum"
+    multi_disks_boot:
+        images += " stg25"
+        image_name_stg25 = images/storage25
+    stress_boot:
+        alive_test_cmd = ps aux
+    unattended_install:
+        #pre_command += "scripts/private_br.sh tftp;"
+        # If you want to use floppy to hold kickstarts,
+        # comment the 3 lines below
+        syslog_server_enabled = no
+        enable_gluster_cd1 = no
+        enable_gluster_unattended = no
+        enable_gluster_fl = no
+        enable_ceph_cd1 = no
+        enable_ceph_unattended = no
+        enable_ceph_fl = no
+        enable_iscsi_cd1 = no
+        enable_iscsi_unattended = no
+        enable_iscsi_fl = no
+    unattended_install.cdrom..multi_disk_install:
+        images += " stg25"
+    unattended_install..multi_disk_install:
+        image_size = 512M
+        image_size_image1 = 10G
+    timedrift, timerdevice..boot_test:
+        guest_load_command = touch /tmp/guest_load_timedrift; taskset -c %s /bin/bash -c 'while [ -e /tmp/guest_load_timedrift ]; do X=1; done&'
+        guest_load_stop_command = rm -f /tmp/guest_load_timedrift
+        host_load_command = /bin/bash -c 'for ((;;)); do X=1; done'
+    suspend:
+        check_s3_support_cmd = grep -q mem /sys/power/state
+        set_s3_cmd = echo mem > /sys/power/state
+    nic_hotplug:
+        modprobe_module = acpiphp
+    block_hotplug:
+        modprobe_module = acpiphp
+    readonly_floppy:
+        format_floppy0_cmd = mkfs -t ext3 /dev/fd0
+        format_floppy1_cmd = mkfs -t ext3 /dev/fd1
+    set_link:
+        tmp_dir = /tmp/
+        clean_cmd = rm -f
+    multi_disk:
+        copy_to_command = "/bin/cp -rf /bin/ls /mnt/%s"
+        copy_from_command = "/bin/cp -rf /mnt/%s/ls /tmp/ls"
+        max_disk..virtio_blk:
+            soundcards = ""
+    usb_multi_disk:
+        list_volume_command = cd /dev && \ls [vhs]d[a-z]* |grep -v [0-9]$
+        re_str = "[vhs]d[a-z]+"
+    drive_mirror.with_powerdown:
+        download_link = "http://fileshare.englab.nay.redhat.com/pub/section2/kvm/linux/linux-4.8.1.tar.gz"
+        pkg_md5sum = "8c6622686cf26f49ba454ef919e0e0c2"
+        app_check_cmd = "test -d  ${tmp_dir}/linux-4.8.1"
+        install_cmd = "tar xzvf ${tmp_dir}/linux-4.8.1.tar.gz -C ${tmp_dir}/"
+        config_cmd = "cd ${tmp_dir}/linux-4.8.1 && make defconfig"
+        start_cmd = "cd ${tmp_dir}/linux-4.8.1 && make clean && make -j `grep processor /proc/cpuinfo|wc -l` && make modules"
+        check_cmd = "pidof make"
+        stop_cmd = "pkill -g make && rm -rf ${tmp_dir}/linux*"
+    multi_disk_install:
+        # The kernel and initrd's bootindex=0 which is set as default in the qemu.
+        # Need set the boot image index=1
+        bootindex_image1 = 1
+        no iscsi emulational_iscsi
+    qemu_guest_agent..check_snapshot:
+        no iscsi emulational_iscsi
diff --git a/shared/cfg/guest-os/Linux/Debian.cfg b/shared/cfg/guest-os/Linux/Debian.cfg
index a6693dab..4d033fe2 100644
--- a/shared/cfg/guest-os/Linux/Debian.cfg
+++ b/shared/cfg/guest-os/Linux/Debian.cfg
@@ -7,3 +7,6 @@
         initrd = initrd
         wait_no_ack = yes
         kernel_params = "console=ttyS0,115200 console=tty0"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    shell_prompt = "^root@.*[\#\$]\s*$"
diff --git a/shared/cfg/guest-os/Linux/OpenSUSE.cfg b/shared/cfg/guest-os/Linux/OpenSUSE.cfg
index 42061117..345482fb 100644
--- a/shared/cfg/guest-os/Linux/OpenSUSE.cfg
+++ b/shared/cfg/guest-os/Linux/OpenSUSE.cfg
@@ -12,3 +12,7 @@
     block_hotplug, pci_hotplug:
         modprobe_module = acpiphp
         no block_scsi
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    unattended_install..floppy_ks:
+        cdrom_unattended = ""
diff --git a/shared/cfg/guest-os/Linux/RHEL.cfg b/shared/cfg/guest-os/Linux/RHEL.cfg
index 68185890..0cff6a04 100644
--- a/shared/cfg/guest-os/Linux/RHEL.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL.cfg
@@ -27,3 +27,17 @@
         # https://access.redhat.com/solutions/3293511
         !RHEL.5, RHEL.6:
             vm_mem_minimum = 2G
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    password = kvmautotest
+    image_size = 20G
+    unattended_install, check_block_size..extra_cdrom_ks,with_installation:
+        kill_vm_gracefully = no
+        # You have to use ks=floppy if you want to use floppies to
+        # hold your kickstart file
+        #extra_params += " --append 'ks=floppy nicdelay=60 console=ttyS0,115200 console=tty0'"
+        extra_params += " -no-shutdown"
+        boot_once = d
+    unattended_install..multi_disk_install:
+        image_size = 512M
+        image_size_image1 = 20G
diff --git a/shared/cfg/guest-os/Linux/RHEL/5.11.cfg b/shared/cfg/guest-os/Linux/RHEL/5.11.cfg
index 347b225b..7f8c08bd 100644
--- a/shared/cfg/guest-os/Linux/RHEL/5.11.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/5.11.cfg
@@ -15,3 +15,44 @@
         # thread_siblings_list file to get the thread count in a core.
         # More info, please read cpulist_scnprintf() in include/linux/cpumask.h
         cpu_threads_chk_cmd = "expr $(grep -c ',' /sys/devices/system/cpu/cpu0/topology/thread_siblings_list) + 1"
+## Internal only configuration. Will add to end of upstream file.
+#
+    # virtio-scsi driver support from RHEL6.3
+    no virtio_scsi
+    os_variant = rhel5.11
+    guest_name = rhel511
+    brew_tag = RHEL-5.11-Z-candidate
+    physical_resources_check:
+        catch_serial_cmd =
+    pci_hotplug:
+        modprobe_module = acpiphp
+    guest_s3:
+        # Bug 834511 - Disallow system to enter S3 or S4 states if virtio devices present
+        no virtio_net
+        no virtio_blk
+        global_enable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://mirrors.sonic.net/centos/5/os/x86_64/CentOS/iasl-20090123-1.el5.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+            s3_support_chk_cmd += " && dmesg -c > /dev/null && grep -q mem /sys/power/state"
+        global_disable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://mirrors.sonic.net/centos/5/os/x86_64/CentOS/iasl-20090123-1.el5.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+    guest_s4:
+        no virtio_net
+        no virtio_blk
+        global_enable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://mirrors.sonic.net/centos/5/os/x86_64/CentOS/iasl-20090123-1.el5.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+            s4_support_chk_cmd += " && dmesg -c > /dev/null && grep -q disk /sys/power/state"
+        global_disable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://mirrors.sonic.net/centos/5/os/x86_64/CentOS/iasl-20090123-1.el5.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+
diff --git a/shared/cfg/guest-os/Linux/RHEL/5.11/i386.cfg b/shared/cfg/guest-os/Linux/RHEL/5.11/i386.cfg
index 7a8c8d81..56bb3b85 100644
--- a/shared/cfg/guest-os/Linux/RHEL/5.11/i386.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/5.11/i386.cfg
@@ -13,3 +13,19 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel511-32/ks.vfd
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -32
+    mem_max = 4096
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-5-series.ks
+        cdrom_unattended = images/rhel511-32/ks.iso
+        kernel = images/rhel511-32/vmlinuz
+        initrd = images/rhel511-32/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-5-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL-Server-5.11-i386-DVD.iso
+    unattended_install..floppy_ks:
+        floppies = "fl"
+        floppy_name = images/rhel511-32/ks.vfd
diff --git a/shared/cfg/guest-os/Linux/RHEL/5.11/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/5.11/x86_64.cfg
index 0ba5260c..bc3f2818 100644
--- a/shared/cfg/guest-os/Linux/RHEL/5.11/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/5.11/x86_64.cfg
@@ -37,3 +37,18 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -64
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL-Server-5.11-x86_64-DVD.iso
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-5-series.ks
+        cdrom_unattended = images/rhel511-64/ks.iso
+        kernel = images/rhel511-64/vmlinuz
+        initrd = images/rhel511-64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-5-perf-series.ks
+    unattended_install..floppy_ks:
+        floppies = "fl"
+        floppy_name = images/rhel511-64/ks.vfd
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.1.cfg b/shared/cfg/guest-os/Linux/RHEL/6.1.cfg
index 3c5306a0..ce1a5d99 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.1.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.1.cfg
@@ -33,3 +33,9 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    # virtio-scsi driver support from RHEL6.3
+    no virtio_scsi
+    guest_name = rhel61
+    brew_tag = RHEL-6.1-Z-candidate
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.1/i386.cfg b/shared/cfg/guest-os/Linux/RHEL/6.1/i386.cfg
index 0c7ed1af..6e73a783 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.1/i386.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.1/i386.cfg
@@ -13,3 +13,16 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel61-32/ks.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -32
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.1-Server-i386.iso
+        md5sum_cd1 =
+        md5sum_1m_cd1 =
+    ipi_x2apic:
+        check_x2apic_cmd =
+    check_qmp:
+        kernel_config = http://fileshare.englab.nay.redhat.com/pub/section2/kvm/pub/test_src/config-32
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.1/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/6.1/x86_64.cfg
index 4126ecf4..6577dbcc 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.1/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.1/x86_64.cfg
@@ -13,3 +13,10 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel61-64/ks.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -64
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.1-Server-x86_64.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.2.cfg b/shared/cfg/guest-os/Linux/RHEL/6.2.cfg
index 7f131800..d64105f3 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.2.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.2.cfg
@@ -33,3 +33,9 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    # virtio-scsi driver support from RHEL6.3
+    no virtio_scsi
+    guest_name = rhel62
+    brew_tag = RHEL-6.2-Z-candidate
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.2/i386.cfg b/shared/cfg/guest-os/Linux/RHEL/6.2/i386.cfg
index 2c9acd13..4117dedc 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.2/i386.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.2/i386.cfg
@@ -13,3 +13,16 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel62-32/ks.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -32
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.2-Server-i386.iso
+        md5sum_cd1 =
+        md5sum_1m_cd1 =
+    ipi_x2apic:
+        check_x2apic_cmd =
+    check_qmp:
+        kernel_config = http://fileshare.englab.nay.redhat.com/pub/section2/kvm/pub/test_src/config-32
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.2/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/6.2/x86_64.cfg
index ffa0d3dc..9e517202 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.2/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.2/x86_64.cfg
@@ -13,3 +13,12 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel62-64/ks.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -64
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.2-Server-x86_64.iso
+        md5sum_cd1 =
+        md5sum_1m_cd1 =
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.3.cfg b/shared/cfg/guest-os/Linux/RHEL/6.3.cfg
index ae5e9edd..cb16d7f4 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.3.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.3.cfg
@@ -33,3 +33,7 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name = rhel63
+    brew_tag = RHEL-6.3-Z-candidate
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.3/i386.cfg b/shared/cfg/guest-os/Linux/RHEL/6.3/i386.cfg
index 9297d4f5..d700aa72 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.3/i386.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.3/i386.cfg
@@ -13,3 +13,14 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel63-32/ks.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -32
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.3-Server-i386.iso
+        md5sum_cd1 =
+        md5sum_1m_cd1 =
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.3/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/6.3/x86_64.cfg
index b38ff020..96e06fdc 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.3/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.3/x86_64.cfg
@@ -13,3 +13,14 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel63-64/ks.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -64
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.3-Server-x86_64.iso
+        md5sum_cd1 =
+        md5sum_1m_cd1 =
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.4.cfg b/shared/cfg/guest-os/Linux/RHEL/6.4.cfg
index e64aaef1..60c08f5c 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.4.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.4.cfg
@@ -33,3 +33,7 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name = rhel64
+    brew_tag = RHEL-6.4-Z-candidate
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.4/i386.cfg b/shared/cfg/guest-os/Linux/RHEL/6.4/i386.cfg
index 88eb0835..d661a4f5 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.4/i386.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.4/i386.cfg
@@ -13,3 +13,14 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel64-32/ks.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -32
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.4-Server-i386.iso
+        md5sum_cd1 =
+        md5sum_1m_cd1 =
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.4/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/6.4/x86_64.cfg
index 1d2d85aa..eb38d299 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.4/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.4/x86_64.cfg
@@ -13,3 +13,14 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel64-64/ks.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -64
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.4-Server-x86_64.iso
+        md5sum_cd1 =
+        md5sum_1m_cd1 =
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.5.cfg b/shared/cfg/guest-os/Linux/RHEL/6.5.cfg
index b74f0a16..6683fc17 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.5.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.5.cfg
@@ -33,3 +33,7 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name = rhel65
+    brew_tag = RHEL-6.5-Z-candidate
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.5/i386.cfg b/shared/cfg/guest-os/Linux/RHEL/6.5/i386.cfg
index 155f665c..80700d43 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.5/i386.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.5/i386.cfg
@@ -13,3 +13,12 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel65-32/ks.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    image_name += -32
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.5-Server-i386.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.5/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/6.5/x86_64.cfg
index 570410d4..52596adb 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.5/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.5/x86_64.cfg
@@ -13,3 +13,14 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel65-64/ks.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -64
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.5-Server-x86_64.iso
+        md5sum_cd1 =
+        md5sum_1m_cd1 =
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.6.cfg b/shared/cfg/guest-os/Linux/RHEL/6.6.cfg
index 842f7a25..34873ac0 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.6.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.6.cfg
@@ -33,3 +33,8 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name = rhel66
+    image_size = 20G
+    brew_tag = RHEL-6.6-Z-candidate
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.6/i386.cfg b/shared/cfg/guest-os/Linux/RHEL/6.6/i386.cfg
index 8556c6bc..42093bd3 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.6/i386.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.6/i386.cfg
@@ -13,3 +13,12 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel66-32/ks.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    image_name += -32
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.6-Server-i386.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.6/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/6.6/x86_64.cfg
index dc5ffa2c..c5562fc4 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.6/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.6/x86_64.cfg
@@ -13,3 +13,14 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel66-64/ks.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -64
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.6-Server-x86_64.iso
+        md5sum_cd1 =
+        md5sum_1m_cd1 =
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.7.cfg b/shared/cfg/guest-os/Linux/RHEL/6.7.cfg
index a331060a..93b040d3 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.7.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.7.cfg
@@ -33,3 +33,8 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name = rhel67
+    image_size = 20G
+    brew_tag = RHEL-6.7-Z-candidate
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.7/i386.cfg b/shared/cfg/guest-os/Linux/RHEL/6.7/i386.cfg
index 3b6c9bc6..56644f05 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.7/i386.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.7/i386.cfg
@@ -13,3 +13,12 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel67-32/ks.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    image_name += -32
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.7-Server-i386.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.7/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/6.7/x86_64.cfg
index 39448f7d..8a734cbf 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.7/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.7/x86_64.cfg
@@ -13,3 +13,14 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel67-64/ks.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -64
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.7-Server-x86_64.iso
+        md5sum_cd1 =
+        md5sum_1m_cd1 =
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.8.cfg b/shared/cfg/guest-os/Linux/RHEL/6.8.cfg
index ab9e488a..c9c409ad 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.8.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.8.cfg
@@ -33,3 +33,8 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name = rhel68
+    image_size = 20G
+    brew_tag = RHEL-6.8-Z-candidate
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.8/i386.cfg b/shared/cfg/guest-os/Linux/RHEL/6.8/i386.cfg
index 9f4ef289..c7567a72 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.8/i386.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.8/i386.cfg
@@ -13,3 +13,18 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel68-32/ks.vfd
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -32
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+        cdrom_unattended = images/rhel68-32/ks.iso
+        kernel = images/rhel68-32/vmlinuz
+        initrd = images/rhel68-32/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.8-Server-i386.iso
+    unattended_install..floppy_ks:
+        floppies = "fl"
+        floppy_name = images/rhel68-32/ks.vfd
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.8/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/6.8/x86_64.cfg
index f461f802..a4a37571 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.8/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.8/x86_64.cfg
@@ -13,3 +13,18 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel68-64/ks.vfd
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -64
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-series.ks
+        cdrom_unattended = images/rhel68-64/ks.iso
+        kernel = images/rhel68-64/vmlinuz
+        initrd = images/rhel68-64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL6.8-Server-x86_64.iso
+    unattended_install..floppy_ks:
+        floppies = "fl"
+        floppy_name = images/rhel68-64/ks.vfd
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.9.cfg b/shared/cfg/guest-os/Linux/RHEL/6.9.cfg
index a348d7f0..7275a30d 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.9.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.9.cfg
@@ -35,3 +35,7 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+## Internal only configuration. Will add to end of upstream file.
+#
+    image_size = 20G
+    brew_tag = RHEL-6.9-Z-candidate
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.9/i386.cfg b/shared/cfg/guest-os/Linux/RHEL/6.9/i386.cfg
index 9d5e042c..8cb91bba 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.9/i386.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.9/i386.cfg
@@ -17,3 +17,17 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel69-32/ks.vfd
+## Internal only configuration. Will add to end of upstream file.
+#
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, svirt_install:
+        unattended_file = unattended/RHEL-6-series.ks
+        cdrom_unattended = images/rhel69-32/ks.iso
+        kernel = images/rhel69-32/vmlinuz
+        initrd = images/rhel69-32/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, svirt_install:
+        cdrom_cd1 = isos/linux/RHEL6.9-Server-i386.iso
+    unattended_install..floppy_ks:
+        floppies = "fl"
+        floppy_name = images/rhel69-32/ks.vfd
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.9/ppc64.cfg b/shared/cfg/guest-os/Linux/RHEL/6.9/ppc64.cfg
index fef4479b..f83a33ba 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.9/ppc64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.9/ppc64.cfg
@@ -15,3 +15,15 @@
         cdrom_cd1 = isos/linux/RHEL-6.9-ppc64-DVD.iso
         md5sum_cd1 = bc6153125d8d3d9d87c5ed30fae128a3
         md5sum_1m_cd1 = 13ec77e05d297c742fc64cc4bb845310
+## Internal only configuration. Will add to end of upstream file.
+#
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-6-ppc-series.ks
+        cdrom_unattended = images/rhel69-ppc64/ks.iso
+        kernel = images/rhel69-ppc64/vmlinuz
+        initrd = images/rhel69-ppc64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL6.9-Server-ppc64.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/6.9/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/6.9/x86_64.cfg
index c83ee5a4..5766812e 100644
--- a/shared/cfg/guest-os/Linux/RHEL/6.9/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/6.9/x86_64.cfg
@@ -17,3 +17,17 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel69-64/ks.vfd
+## Internal only configuration. Will add to end of upstream file.
+#
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, svirt_install:
+        unattended_file = unattended/RHEL-6-series.ks
+        cdrom_unattended = images/rhel69-64/ks.iso
+        kernel = images/rhel69-64/vmlinuz
+        initrd = images/rhel69-64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-6-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, svirt_install:
+        cdrom_cd1 = isos/linux/RHEL6.9-Server-x86_64.iso
+    unattended_install..floppy_ks:
+        floppies = "fl"
+        floppy_name = images/rhel69-64/ks.vfd
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.0.cfg b/shared/cfg/guest-os/Linux/RHEL/7.0.cfg
index d2a24f06..3ea89335 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.0.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.0.cfg
@@ -36,3 +36,39 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name = rhel70
+    brew_tag = rhel-7.0-z-candidate
+    inactivity_treshold = 3600
+    grub_file = /boot/grub2/grub.cfg
+    mac_ip_filter = "inet (.\d+.\d+.\d+.\d+).*?ether (.\w+:\w+:\w+:\w+:\w+:\w+)"
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        # RHEL7 Needs to indicate the specific cdrom which contains the ks file
+        kernel_params = "ksdevice=link inst.ks=cdrom:/dev/sr1:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
+    unattended_install.url, unattended_install.nfs:
+        kernel_params = "ksdevice=link inst.ks=cdrom:/dev/sr0:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
+    guest_s3:
+        global_enable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+            s3_support_chk_cmd += " && dmesg -c > /dev/null && grep -q mem /sys/power/state"
+        global_disable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+    guest_s4:
+        global_enable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+            s4_support_chk_cmd += " && dmesg -c > /dev/null && grep -q disk /sys/power/state"
+        global_disable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.0/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.0/x86_64.cfg
index 7dd15107..5c77d898 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.0/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.0/x86_64.cfg
@@ -13,3 +13,15 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel70-64/ks.vfd
+## Internal only configuration. Will add to end of upstream file.
+#
+    vm_arch_name = x86_64
+    guest_name += -64
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, svirt_install:
+        unattended_file = unattended/RHEL-7-series.ks
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, svirt_install:
+        cdrom_cd1 = isos/linux/RHEL7.0-Server-x86_64.iso
+    unattended_install..floppy_ks:
+        kernel_params = "inst.ks=hd:fd0:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.1.cfg b/shared/cfg/guest-os/Linux/RHEL/7.1.cfg
index 4cd286f5..2717f80a 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.1.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.1.cfg
@@ -36,3 +36,39 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name = rhel71
+    brew_tag = rhel-7.1-z-candidate
+    inactivity_treshold = 3600
+    grub_file = /boot/grub2/grub.cfg
+    mac_ip_filter = "inet (.\d+.\d+.\d+.\d+).*?ether (.\w+:\w+:\w+:\w+:\w+:\w+)"
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        # RHEL7 Needs to indicate the specific cdrom which contains the ks file
+        kernel_params = "ksdevice=link inst.ks=cdrom:/dev/sr1:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
+    unattended_install.url, unattended_install.nfs:
+        kernel_params = "ksdevice=link inst.ks=cdrom:/dev/sr0:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
+    guest_s3:
+        global_enable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+            s3_support_chk_cmd += " && dmesg -c > /dev/null && grep -q mem /sys/power/state"
+        global_disable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+    guest_s4:
+        global_enable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+            s4_support_chk_cmd += " && dmesg -c > /dev/null && grep -q disk /sys/power/state"
+        global_disable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.1/ppc64le.cfg b/shared/cfg/guest-os/Linux/RHEL/7.1/ppc64le.cfg
index 4e41909d..6bc121a7 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.1/ppc64le.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.1/ppc64le.cfg
@@ -15,3 +15,7 @@
         cdrom_cd1 = isos/linux/RHEL-7.1-ppc64le-DVD.iso
         md5sum_cd1 = 6332d939bc0dcf47b51a98e72c382f36
         md5sum_1m_cd1 = 147f70aeda36b27b5951437fa469b5ce
+## Internal only configuration. Will add to end of upstream file.
+#
+    rh_kernel_update, kexec:
+        brew_tag = rhel-7.1-ppc64le-z-candidate
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.1/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.1/x86_64.cfg
index 815941ff..37700ac8 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.1/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.1/x86_64.cfg
@@ -13,3 +13,15 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel71-64/ks.vfd
+## Internal only configuration. Will add to end of upstream file.
+#
+    vm_arch_name = x86_64
+    guest_name += -64
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-7-series.ks
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL7.1-Server-x86_64.iso
+    unattended_install..floppy_ks:
+        kernel_params = "inst.ks=hd:fd0:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.2.cfg b/shared/cfg/guest-os/Linux/RHEL/7.2.cfg
index 10b72b52..676da914 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.2.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.2.cfg
@@ -36,3 +36,43 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name = rhel72
+    brew_tag = rhel-7.2-z-candidate
+    inactivity_treshold = 3600
+    grub_file = /boot/grub2/grub.cfg
+    mac_ip_filter = "inet (.\d+.\d+.\d+.\d+).*?ether (.\w+:\w+:\w+:\w+:\w+:\w+)"
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        # RHEL7 Needs to indicate the specific cdrom which contains the ks file
+        kernel_params = "ksdevice=link inst.ks=cdrom:/dev/sr1:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
+    unattended_install.url, unattended_install.nfs:
+        kernel_params = "ksdevice=link inst.ks=cdrom:/dev/sr0:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
+    nic_hotplug:
+        modprobe_module = ""
+    block_hotplug:
+        modprobe_module = ""
+    guest_s3:
+        global_enable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+            s3_support_chk_cmd += " && dmesg -c > /dev/null && grep -q mem /sys/power/state"
+        global_disable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+    guest_s4:
+        global_enable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+            s4_support_chk_cmd += " && dmesg -c > /dev/null && grep -q disk /sys/power/state"
+        global_disable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.2/ppc64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.2/ppc64.cfg
index c99154ad..9e8660e0 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.2/ppc64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.2/ppc64.cfg
@@ -15,3 +15,17 @@
         cdrom_cd1 = isos/linux/RHEL-7.2-ppc64-DVD.iso
         md5sum_cd1 = d4e597629de04a848c124d3589472372
         md5sum_1m_cd1 = 8c3e5a70edb328f58887c99fc4c4654b
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -ppc64
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel72-ppc64/ks.iso
+        kernel = images/rhel72-ppc64/vmlinuz
+        initrd = images/rhel72-ppc64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL7.2-Server-ppc64.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.2/ppc64le.cfg b/shared/cfg/guest-os/Linux/RHEL/7.2/ppc64le.cfg
index 4290a6f0..861a0e57 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.2/ppc64le.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.2/ppc64le.cfg
@@ -15,3 +15,17 @@
         cdrom_cd1 = isos/linux/RHEL-7.2-ppc64le-DVD.iso
         md5sum_cd1 = 7fd0c4d9a034463bcdfdbc69cff3a69d
         md5sum_1m_cd1 = ad122d234b83bf34c55e7df405bd8f22
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -ppc64le
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel72-ppc64le/ks.iso
+        kernel = images/rhel72-ppc64le/vmlinuz
+        initrd = images/rhel72-ppc64le/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL7.2-Server-ppc64le.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.2/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.2/x86_64.cfg
index 21a79910..14839781 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.2/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.2/x86_64.cfg
@@ -13,3 +13,19 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel72-64/ks.vfd
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -64
+    unattended_install, check_block_size.4096_512, check_block_size.512_512:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel72-64/ks.iso
+        kernel = images/rhel72-64/vmlinuz
+        initrd = images/rhel72-64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512:
+        cdrom_cd1 = isos/linux/RHEL7.2-Server-x86_64.iso
+    unattended_install..floppy_ks:
+        floppies = "fl"
+        floppy_name = images/rhel72-64/ks.vfd
+        kernel_params = "inst.ks=hd:fd0:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.3.cfg b/shared/cfg/guest-os/Linux/RHEL/7.3.cfg
index f0ed0aac..e99adcc2 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.3.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.3.cfg
@@ -36,3 +36,43 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name = rhel73
+    brew_tag = rhel-7.3-z-candidate
+    inactivity_treshold = 3600
+    grub_file = /boot/grub2/grub.cfg
+    mac_ip_filter = "inet (.\d+.\d+.\d+.\d+).*?ether (.\w+:\w+:\w+:\w+:\w+:\w+)"
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        # RHEL7 Needs to indicate the specific cdrom which contains the ks file
+        kernel_params = "ksdevice=link inst.repo=cdrom:/dev/sr0 inst.ks=cdrom:/dev/sr1:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
+    unattended_install.url, unattended_install.nfs:
+        kernel_params = "ksdevice=link inst.ks=cdrom:/dev/sr0:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
+    nic_hotplug:
+        modprobe_module = ""
+    block_hotplug:
+        modprobe_module = ""
+    guest_s3:
+        global_enable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+            s3_support_chk_cmd += " && dmesg -c > /dev/null && grep -q mem /sys/power/state"
+        global_disable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+    guest_s4:
+        global_enable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+            s4_support_chk_cmd += " && dmesg -c > /dev/null && grep -q disk /sys/power/state"
+        global_disable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.3/ppc64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.3/ppc64.cfg
index 18af684c..6c79755f 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.3/ppc64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.3/ppc64.cfg
@@ -15,3 +15,17 @@
         cdrom_cd1 = isos/linux/RHEL-7.3-ppc64-DVD.iso
         md5sum_cd1 = 0b295c908491ebf6644082d809e0d63e
         md5sum_1m_cd1 = e11b57d9b3e8e531b82f3936d256d4b6
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -ppc64
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel73-ppc64/ks.iso
+        kernel = images/rhel73-ppc64/vmlinuz
+        initrd = images/rhel73-ppc64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL7.3-Server-ppc64.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.3/ppc64le.cfg b/shared/cfg/guest-os/Linux/RHEL/7.3/ppc64le.cfg
index 1953d8ca..75e1838f 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.3/ppc64le.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.3/ppc64le.cfg
@@ -15,3 +15,17 @@
         cdrom_cd1 = isos/linux/RHEL-7.3-ppc64le-DVD.iso
         md5sum_cd1 = c0542bb27a3d8d87cf04f9f96955f545
         md5sum_1m_cd1 = 650e9b36fcdda852aaf01259d4996183
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -ppc64le
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel73-ppc64le/ks.iso
+        kernel = images/rhel73-ppc64le/vmlinuz
+        initrd = images/rhel73-ppc64le/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL7.3-Server-ppc64le.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.3/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.3/x86_64.cfg
index b7da8b23..ea3d5997 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.3/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.3/x86_64.cfg
@@ -13,3 +13,19 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel73-64/ks.vfd
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -64
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel73-64/ks.iso
+        kernel = images/rhel73-64/vmlinuz
+        initrd = images/rhel73-64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        cdrom_cd1 = isos/linux/RHEL7.3-Server-x86_64.iso
+    unattended_install..floppy_ks:
+        floppies = "fl"
+        floppy_name = images/rhel73-64/ks.vfd
+        kernel_params = "inst.ks=hd:fd0:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.4.cfg b/shared/cfg/guest-os/Linux/RHEL/7.4.cfg
index 2e4d0571..73a8aa76 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.4.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.4.cfg
@@ -36,3 +36,44 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name = rhel74
+    os_variant = rhel7
+    brew_tag = rhel-7.4-z-candidate
+    inactivity_treshold = 3600
+    grub_file = /boot/grub2/grub.cfg
+    mac_ip_filter = "inet (.\d+.\d+.\d+.\d+).*?ether (.\w+:\w+:\w+:\w+:\w+:\w+)"
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        # RHEL7 Needs to indicate the specific cdrom which contains the ks file
+        kernel_params = "ksdevice=link inst.repo=cdrom:/dev/sr0 inst.ks=cdrom:/dev/sr1:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
+    unattended_install.url, unattended_install.nfs:
+        kernel_params = "ksdevice=link inst.ks=cdrom:/dev/sr0:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
+    nic_hotplug:
+        modprobe_module = ""
+    block_hotplug:
+        modprobe_module = ""
+    guest_s3:
+        global_enable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+            s3_support_chk_cmd += " && dmesg -c > /dev/null && grep -q mem /sys/power/state"
+        global_disable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+    guest_s4:
+        global_enable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+            s4_support_chk_cmd += " && dmesg -c > /dev/null && grep -q disk /sys/power/state"
+        global_disable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.4/ppc64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.4/ppc64.cfg
index f44347bd..c4452d4a 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.4/ppc64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.4/ppc64.cfg
@@ -15,3 +15,17 @@
         cdrom_cd1 = isos/linux/RHEL-7.4-ppc64-DVD.iso
         md5sum_cd1 = fb912db70bd4114d0796eb89c0322578
         md5sum_1m_cd1 = 98255e209d8c40ea046c10322534cb7c
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -ppc64
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel74-ppc64/ks.iso
+        kernel = images/rhel74-ppc64/vmlinuz
+        initrd = images/rhel74-ppc64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL7.4-Server-ppc64.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.4/ppc64le.cfg b/shared/cfg/guest-os/Linux/RHEL/7.4/ppc64le.cfg
index c81a90bb..5d5192f5 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.4/ppc64le.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.4/ppc64le.cfg
@@ -15,3 +15,17 @@
         cdrom_cd1 = isos/linux/RHEL-7.4-ppc64le-DVD.iso
         md5sum_cd1 = 6ae2077d4e223e29ed820ea0ff68aded
         md5sum_1m_cd1 = 0feed6b9bc9f8e2edf25b849d44cd15c
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -ppc64le
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel74-ppc64le/ks.iso
+        kernel = images/rhel74-ppc64le/vmlinuz
+        initrd = images/rhel74-ppc64le/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL7.4-Server-ppc64le.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.4/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.4/x86_64.cfg
index 4f4e3e9e..49545e5e 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.4/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.4/x86_64.cfg
@@ -13,3 +13,19 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel74-64/ks.vfd
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -64
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel74-64/ks.iso
+        kernel = images/rhel74-64/vmlinuz
+        initrd = images/rhel74-64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        cdrom_cd1 = isos/linux/RHEL7.4-Server-x86_64.iso
+    unattended_install..floppy_ks:
+        floppies = "fl"
+        floppy_name = images/rhel74-64/ks.vfd
+        kernel_params = "inst.ks=hd:fd0:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.5.cfg b/shared/cfg/guest-os/Linux/RHEL/7.5.cfg
index 1bee10a3..af68a4ef 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.5.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.5.cfg
@@ -36,3 +36,61 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name = rhel75
+    brew_tag = rhel-7.5-z-candidate
+    inactivity_treshold = 3600
+    grub_file = /boot/grub2/grub.cfg
+    mac_ip_filter = "inet (.\d+.\d+.\d+.\d+).*?ether (.\w+:\w+:\w+:\w+:\w+:\w+)"
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        # RHEL7 Needs to indicate the specific cdrom which contains the ks file
+        kernel_params = "inst.sshd ksdevice=link inst.repo=cdrom:/dev/sr0 inst.ks=cdrom:/dev/sr1:/ks.cfg nicdelay=60 biosdevname=0 net.ifnames=0"
+        x86_64, i386:
+            kernel_params += " console=ttyS0,115200 console=tty0"
+        ppc64, ppc64le:
+            kernel_params += " console=hvc0,38400 console=tty0"
+        aarch64:
+            kernel_params += " console=ttyAMA0"
+        s390x:
+            kernel_params += " console=ttysclp0"
+            image_aio = threads
+    unattended_install.url, unattended_install.nfs:
+        kernel_params = "inst.sshd ksdevice=link inst.ks=cdrom:/dev/sr0:/ks.cfg nicdelay=60 biosdevname=0 net.ifnames=0"
+        x86_64, i386:
+            kernel_params += " console=ttyS0,115200 console=tty0"
+        ppc64, ppc64le:
+            kernel_params += " console=hvc0,38400 console=tty0"
+        aarch64:
+            kernel_params += " console=ttyAMA0"
+        s390x:
+            kernel_params += " console=ttysclp0"
+            image_aio = threads
+    nic_hotplug:
+        modprobe_module = ""
+    block_hotplug:
+        modprobe_module = ""
+    guest_s3:
+        global_enable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+            s3_support_chk_cmd += " && dmesg -c > /dev/null && grep -q mem /sys/power/state"
+        global_disable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+    guest_s4:
+        global_enable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+            s4_support_chk_cmd += " && dmesg -c > /dev/null && grep -q disk /sys/power/state"
+        global_disable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.5/ppc64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.5/ppc64.cfg
index f2fcde09..060ff25f 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.5/ppc64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.5/ppc64.cfg
@@ -15,3 +15,17 @@
         cdrom_cd1 = isos/linux/RHEL-7.5-ppc64-DVD.iso
         md5sum_cd1 = 2371e37f91c5c9c56c8f94dbce6bc522
         md5sum_1m_cd1 = 7e61cc6d679f8ac01fb85811db44dd74
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -ppc64
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel75-ppc64/ks.iso
+        kernel = images/rhel75-ppc64/vmlinuz
+        initrd = images/rhel75-ppc64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL7.5-Server-ppc64.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.5/ppc64le.cfg b/shared/cfg/guest-os/Linux/RHEL/7.5/ppc64le.cfg
index 5c06653e..54ed47bb 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.5/ppc64le.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.5/ppc64le.cfg
@@ -15,3 +15,17 @@
         cdrom_cd1 = isos/linux/RHEL-7.5-ppc64le-DVD.iso
         md5sum_cd1 = b7a06bf2ef06bafc38d0d2e72eb29289
         md5sum_1m_cd1 = 5d794b5cffbb606253e4e1eb1e493d7f
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -ppc64le
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel75-ppc64le/ks.iso
+        kernel = images/rhel75-ppc64le/vmlinuz
+        initrd = images/rhel75-ppc64le/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL7.5-Server-ppc64le.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.5/s390x.cfg b/shared/cfg/guest-os/Linux/RHEL/7.5/s390x.cfg
index 61731ad3..8b3fa499 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.5/s390x.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.5/s390x.cfg
@@ -19,3 +19,16 @@
         cdrom_cd1 = isos/linux/RHEL-7.5-s390x-DVD.iso
         md5sum_cd1 = 177286501fc868ceb936a5a4ea7bacc0
         md5sum_1m_cd1 = b09fc53eb48bfa9c274ca076e32b37c5
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -s390x
+    #grub_file = /boot/efi/EFI/redhat/grub.cfg
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        unattended_file = unattended/RHEL-7-s390x-series.ks
+        cdrom_unattended = images/rhel75-s390x/ks.iso
+        kernel = images/rhel75-s390x/kernel.img
+        initrd = images/rhel75-s390x/initrd.img
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        boot_path = images
+        cdrom_cd1 = isos/linux/RHEL7.5-Server-s390x.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.5/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.5/x86_64.cfg
index df092873..c8fe37d7 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.5/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.5/x86_64.cfg
@@ -13,3 +13,19 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel75-64/ks.vfd
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -64
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel75-64/ks.iso
+        kernel = images/rhel75-64/vmlinuz
+        initrd = images/rhel75-64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        cdrom_cd1 = isos/linux/RHEL7.5-Server-x86_64.iso
+    unattended_install..floppy_ks:
+        floppies = "fl"
+        floppy_name = images/rhel75-64/ks.vfd
+        kernel_params = "inst.ks=hd:fd0:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.6.cfg b/shared/cfg/guest-os/Linux/RHEL/7.6.cfg
index fb8f4249..93d95e47 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.6.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.6.cfg
@@ -36,3 +36,61 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name = rhel76
+    brew_tag = rhel-7.6-z-candidate
+    inactivity_treshold = 3600
+    grub_file = /boot/grub2/grub.cfg
+    mac_ip_filter = "inet (.\d+.\d+.\d+.\d+).*?ether (.\w+:\w+:\w+:\w+:\w+:\w+)"
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        # RHEL7 Needs to indicate the specific cdrom which contains the ks file
+        kernel_params = "inst.sshd ksdevice=link inst.repo=cdrom:/dev/sr0 inst.ks=cdrom:/dev/sr1:/ks.cfg nicdelay=60 biosdevname=0 net.ifnames=0"
+        x86_64, i386:
+            kernel_params += " console=ttyS0,115200 console=tty0"
+        ppc64, ppc64le:
+            kernel_params += " console=hvc0,38400 console=tty0"
+        aarch64:
+            kernel_params += " console=ttyAMA0"
+        s390x:
+            kernel_params += " console=ttysclp0"
+            image_aio = threads
+    unattended_install.url, unattended_install.nfs:
+        kernel_params = "inst.sshd ksdevice=link inst.ks=cdrom:/dev/sr0:/ks.cfg nicdelay=60 biosdevname=0 net.ifnames=0"
+        x86_64, i386:
+            kernel_params += " console=ttyS0,115200 console=tty0"
+        ppc64, ppc64le:
+            kernel_params += " console=hvc0,38400 console=tty0"
+        aarch64:
+            kernel_params += " console=ttyAMA0"
+        s390x:
+            kernel_params += " console=ttysclp0"
+            image_aio = threads
+    nic_hotplug:
+        modprobe_module = ""
+    block_hotplug:
+        modprobe_module = ""
+    guest_s3:
+        global_enable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+            s3_support_chk_cmd += " && dmesg -c > /dev/null && grep -q mem /sys/power/state"
+        global_disable_s3:
+            s3_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s3_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s3_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s3_support_chk_cmd += " && grep "_S3" /tmp/ssdt.dsl"
+    guest_s4:
+        global_enable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+            s4_support_chk_cmd += " && dmesg -c > /dev/null && grep -q disk /sys/power/state"
+        global_disable_s4:
+            s4_support_chk_cmd = "rpm --force --nodeps -ivh http://download.devel.redhat.com/brewroot/packages/iasl/20120913/7.el7/x86_64/iasl-20120913-7.el7.x86_64.rpm"
+            s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
+            s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
+            s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.6/ppc64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.6/ppc64.cfg
index 2212bdcc..41fb4582 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.6/ppc64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.6/ppc64.cfg
@@ -15,3 +15,17 @@
         cdrom_cd1 = isos/linux/RHEL-7.6-ppc64-DVD.iso
         md5sum_cd1 = 3e8e21dbf52287c9add5b7881f5ba3f3
         md5sum_1m_cd1 = 8050a577c02f7ad6d071cf567d6270e7
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -ppc64
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel76-ppc64/ks.iso
+        kernel = images/rhel76-ppc64/vmlinuz
+        initrd = images/rhel76-ppc64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL7.6-Server-ppc64.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.6/ppc64le.cfg b/shared/cfg/guest-os/Linux/RHEL/7.6/ppc64le.cfg
index 97b7db40..bfb09421 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.6/ppc64le.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.6/ppc64le.cfg
@@ -15,3 +15,17 @@
         cdrom_cd1 = isos/linux/RHEL-7.6-ppc64le-DVD.iso
         md5sum_cd1 = a57e95a9ce790b3da285c5553097a052
         md5sum_1m_cd1 = 9e4e2b429d41e642926e17fd5e0b736b
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -ppc64le
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel76-ppc64le/ks.iso
+        kernel = images/rhel76-ppc64le/vmlinuz
+        initrd = images/rhel76-ppc64le/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size.4096_512, check_block_size.512_512, with_installation:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL7.6-Server-ppc64le.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.6/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.6/x86_64.cfg
index e890b598..9e3265ed 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.6/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.6/x86_64.cfg
@@ -13,3 +13,19 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel76-64/ks.vfd
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -64
+    unattended_install, check_block_size, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel76-64/ks.iso
+        kernel = images/rhel76-64/vmlinuz
+        initrd = images/rhel76-64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size, with_installation:
+        cdrom_cd1 = isos/linux/RHEL7.6-Server-x86_64.iso
+    unattended_install..floppy_ks:
+        floppies = "fl"
+        floppy_name = images/rhel76-64/ks.vfd
+        kernel_params = "inst.ks=hd:fd0:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.7.cfg b/shared/cfg/guest-os/Linux/RHEL/7.7.cfg
index cbe1f365..6d8bedc7 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.7.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.7.cfg
@@ -36,3 +36,33 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name = rhel77
+    brew_tag = rhel-7.7-z-candidate
+    inactivity_treshold = 3600
+    grub_file = /boot/grub2/grub.cfg
+    mac_ip_filter = "inet (.\d+.\d+.\d+.\d+).*?ether (.\w+:\w+:\w+:\w+:\w+:\w+)"
+    unattended_install.cdrom, check_block_size..extra_cdrom_ks,with_installation:
+        # RHEL7 Needs to indicate the specific cdrom which contains the ks file
+        kernel_params = "inst.sshd ksdevice=link inst.repo=cdrom:/dev/sr0 inst.ks=cdrom:/dev/sr1:/ks.cfg nicdelay=60 biosdevname=0 net.ifnames=0"
+        x86_64, i386:
+            kernel_params += " console=ttyS0,115200 console=tty0"
+        ppc64, ppc64le:
+            kernel_params += " console=hvc0,38400 console=tty0"
+        aarch64:
+            kernel_params += " console=ttyAMA0"
+        s390x:
+            kernel_params += " console=ttysclp0"
+            image_aio = threads
+    unattended_install.url, unattended_install.nfs:
+        kernel_params = "inst.sshd ksdevice=link inst.ks=cdrom:/dev/sr0:/ks.cfg nicdelay=60 biosdevname=0 net.ifnames=0"
+        x86_64, i386:
+            kernel_params += " console=ttyS0,115200 console=tty0"
+        ppc64, ppc64le:
+            kernel_params += " console=hvc0,38400 console=tty0"
+        aarch64:
+            kernel_params += " console=ttyAMA0"
+        s390x:
+            kernel_params += " console=ttysclp0"
+            image_aio = threads
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.7/ppc64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.7/ppc64.cfg
index 5e7343fc..7c0e05d3 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.7/ppc64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.7/ppc64.cfg
@@ -15,3 +15,17 @@
         cdrom_cd1 = isos/linux/RHEL-7.7-ppc64-DVD.iso
         md5sum_cd1 = 4a1e8a27a68a8b4bcc087888003e6c13
         md5sum_1m_cd1 = d5ffb68c4838a0a0aabf2b40f82432e9
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -ppc64
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size..extra_cdrom_ks, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel77-ppc64/ks.iso
+        kernel = images/rhel77-ppc64/vmlinuz
+        initrd = images/rhel77-ppc64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size..extra_cdrom_ks, with_installation:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL7.7-Server-ppc64.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.7/ppc64le.cfg b/shared/cfg/guest-os/Linux/RHEL/7.7/ppc64le.cfg
index 04fae44a..d2263b43 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.7/ppc64le.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.7/ppc64le.cfg
@@ -15,3 +15,17 @@
         cdrom_cd1 = isos/linux/RHEL-7.7-ppc64le-DVD.iso
         md5sum_cd1 = d262cc4118165568b8d1926325485775
         md5sum_1m_cd1 = 138ba27dbde9c4b1c78d5ab7b3defd48
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -ppc64le
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size..extra_cdrom_ks, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel77-ppc64le/ks.iso
+        kernel = images/rhel77-ppc64le/vmlinuz
+        initrd = images/rhel77-ppc64le/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size..extra_cdrom_ks, with_installation:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL7.7-Server-ppc64le.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.7/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.7/x86_64.cfg
index cc7cbb7a..41f9ec19 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.7/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.7/x86_64.cfg
@@ -13,3 +13,19 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel77-64/ks.vfd
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -64
+    unattended_install, check_block_size..extra_cdrom_ks,with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel77-64/ks.iso
+        kernel = images/rhel77-64/vmlinuz
+        initrd = images/rhel77-64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size..extra_cdrom_ks,with_installation:
+        cdrom_cd1 = isos/linux/RHEL7.7-Server-x86_64.iso
+    unattended_install..floppy_ks:
+        floppies = "fl"
+        floppy_name = images/rhel77-64/ks.vfd
+        kernel_params = "inst.ks=hd:fd0:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.8.cfg b/shared/cfg/guest-os/Linux/RHEL/7.8.cfg
index 9ff060df..c2563ce1 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.8.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.8.cfg
@@ -36,3 +36,33 @@
             s4_support_chk_cmd += " && cat /sys/firmware/acpi/tables/SSDT > /tmp/ssdt"
             s4_support_chk_cmd += " && iasl -d /tmp/ssdt"
             s4_support_chk_cmd += " && grep "_S4" /tmp/ssdt.dsl"
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name = rhel78
+    brew_tag = rhel-7.8-z-candidate
+    inactivity_treshold = 3600
+    grub_file = /boot/grub2/grub.cfg
+    mac_ip_filter = "inet (.\d+.\d+.\d+.\d+).*?ether (.\w+:\w+:\w+:\w+:\w+:\w+)"
+    unattended_install.cdrom, check_block_size..extra_cdrom_ks,with_installation:
+        # RHEL7 Needs to indicate the specific cdrom which contains the ks file
+        kernel_params = "inst.sshd ksdevice=link inst.repo=cdrom:/dev/sr0 inst.ks=cdrom:/dev/sr1:/ks.cfg nicdelay=60 biosdevname=0 net.ifnames=0"
+        x86_64, i386:
+            kernel_params += " console=ttyS0,115200 console=tty0"
+        ppc64, ppc64le:
+            kernel_params += " console=hvc0,38400 console=tty0"
+        aarch64:
+            kernel_params += " console=ttyAMA0"
+        s390x:
+            kernel_params += " console=ttysclp0"
+            image_aio = threads
+    unattended_install.url, unattended_install.nfs:
+        kernel_params = "inst.sshd ksdevice=link inst.ks=cdrom:/dev/sr0:/ks.cfg nicdelay=60 biosdevname=0 net.ifnames=0"
+        x86_64, i386:
+            kernel_params += " console=ttyS0,115200 console=tty0"
+        ppc64, ppc64le:
+            kernel_params += " console=hvc0,38400 console=tty0"
+        aarch64:
+            kernel_params += " console=ttyAMA0"
+        s390x:
+            kernel_params += " console=ttysclp0"
+            image_aio = threads
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.8/ppc64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.8/ppc64.cfg
index e464b600..e9969168 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.8/ppc64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.8/ppc64.cfg
@@ -15,3 +15,17 @@
         cdrom_cd1 = isos/linux/RHEL-7.8-ppc64-DVD.iso
         md5sum_cd1 = da717d72803b0a9bcb46e8628cf9d2c5
         md5sum_1m_cd1 = 4f6ebf0eaf20a94cfdcb2fdf08f50fd2
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -ppc64
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size..extra_cdrom_ks, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel78-ppc64/ks.iso
+        kernel = images/rhel78-ppc64/vmlinuz
+        initrd = images/rhel78-ppc64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size..extra_cdrom_ks, with_installation:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL7.8-Server-ppc64.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.8/ppc64le.cfg b/shared/cfg/guest-os/Linux/RHEL/7.8/ppc64le.cfg
index d396bfc8..c70f6d8f 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.8/ppc64le.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.8/ppc64le.cfg
@@ -15,3 +15,17 @@
         cdrom_cd1 = isos/linux/RHEL-7.8-ppc64le-DVD.iso
         md5sum_cd1 = 1cd34eb580e0380a609d91fe3ba0084c
         md5sum_1m_cd1 = e0e65e1ea98e4731903a78ab357f1d7a
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -ppc64le
+    no unattended_install..floppy_ks
+    unattended_install, check_block_size..extra_cdrom_ks, with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel78-ppc64le/ks.iso
+        kernel = images/rhel78-ppc64le/vmlinuz
+        initrd = images/rhel78-ppc64le/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size..extra_cdrom_ks, with_installation:
+        boot_path = ppc/ppc64
+        cdrom_cd1 = isos/linux/RHEL7.8-Server-ppc64le.iso
diff --git a/shared/cfg/guest-os/Linux/RHEL/7.8/x86_64.cfg b/shared/cfg/guest-os/Linux/RHEL/7.8/x86_64.cfg
index a457d838..22606e5b 100644
--- a/shared/cfg/guest-os/Linux/RHEL/7.8/x86_64.cfg
+++ b/shared/cfg/guest-os/Linux/RHEL/7.8/x86_64.cfg
@@ -13,3 +13,19 @@
     unattended_install..floppy_ks:
         floppies = "fl"
         floppy_name = images/rhel78-64/ks.vfd
+## Internal only configuration. Will add to end of upstream file.
+#
+    guest_name += -64
+    unattended_install, check_block_size..extra_cdrom_ks,with_installation:
+        unattended_file = unattended/RHEL-7-series.ks
+        cdrom_unattended = images/rhel78-64/ks.iso
+        kernel = images/rhel78-64/vmlinuz
+        initrd = images/rhel78-64/initrd.img
+        perf:
+            unattended_file = unattended/RHEL-7-perf-series.ks
+    unattended_install.cdrom, check_block_size..extra_cdrom_ks,with_installation:
+        cdrom_cd1 = isos/linux/RHEL7.8-Server-x86_64.iso
+    unattended_install..floppy_ks:
+        floppies = "fl"
+        floppy_name = images/rhel78-64/ks.vfd
+        kernel_params = "inst.ks=hd:fd0:/ks.cfg nicdelay=60 console=ttyS0,115200 console=tty0 biosdevname=0 net.ifnames=0"
diff --git a/shared/cfg/guest-os/Linux/Ubuntu.cfg b/shared/cfg/guest-os/Linux/Ubuntu.cfg
index 17d233ef..11545bb5 100644
--- a/shared/cfg/guest-os/Linux/Ubuntu.cfg
+++ b/shared/cfg/guest-os/Linux/Ubuntu.cfg
@@ -8,3 +8,7 @@
         initrd = initrd
         wait_no_ack = yes
         kernel_params = "console=ttyS0,115200 console=tty0"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+
+    shell_prompt = "^root@.*[\#\$]\s*$"
diff --git a/shared/cfg/guest-os/Windows.cfg b/shared/cfg/guest-os/Windows.cfg
index 96026f32..51774332 100644
--- a/shared/cfg/guest-os/Windows.cfg
+++ b/shared/cfg/guest-os/Windows.cfg
@@ -374,3 +374,134 @@
             install_path = "C:\Program Files (x86)\JAM Software\HeavyLoad"
         i386, i686:
             install_path = "C:\Program Files\JAM Software\HeavyLoad"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    password = Kvm_autotest
+    image_size = 30G
+    vm_mem_minimum = 1G
+    get_time_cmd = "cmd /c echo TIME: %date% %time%"
+    migration_test_command = ver && vol
+    get_nmi_cmd = ::no_cmd
+    enable_gluster_cd1 = no
+    enable_ceph_cd1 = no
+    Win2008..r2, Win7:
+        cpu_model_flags += ",-xsave"
+    enable_iscsi_cd1 = no
+    drive_mirror.with_powerdown:
+        md5sum_bin = "md5sum"
+        download_link = "http://fileshare.englab.nay.redhat.com/pub/section2/kvm/win-tools/HeavyLoadSetup.exe"
+        pkg_md5sum = dceb57331948a1599e4f5b2b915ab1b8
+    unattended_install:
+        process_check = dpinst
+        enable_gluster_cd1 = no
+        enable_gluster_unattended = no
+        enable_gluster_fl = no
+        enable_ceph_cd1 = no
+        enable_ceph_unattended = no
+        enable_ceph_fl = no
+        enable_iscsi_cd1 = no
+        enable_iscsi_unattended = no
+        enable_iscsi_fl = no
+    unattended_install.cdrom, whql.support_vm_install, with_installation, check_block_size..extra_cdrom_ks:
+        boot_once = d
+        enable_gluster_winutils = no
+        enable_ceph_winutils = no
+        enable_iscsi_winutils = no
+        # Turn install_virtio = yes if you want to install the
+        # Windows virtio drivers. It might be a lot of setup though :)
+        virtio_blk, virtio_net, virtio_scsi:
+            install_virtio = yes
+        enable_gluster_virtio = no
+        enable_ceph_virtio = no
+        enable_iscsi_virtio = no
+        #pre_command += "scripts/private_br.sh notftp;"
+        floppies = "fl"
+        virtio_network_installer_path = 'help'
+        cdrom_mount_point = /tmp/mount/
+        floppy_mount_point = /tmp/virtio_win/
+        re_hardware_id = "(PCI.{14,50})\r{0,}\n"
+        # specify which driver is in floppy, this parameter is for windows only
+        driver_in_floppy = qxl.inf
+        # Used to split dirver link from virtio installer path.  Windows guest only
+        re_driver_match = (\S+)\s*hwid
+        unattended_delivery_method = floppy
+    unattended_install..multi_disk_install:
+        image_size = 512M
+        image_size_image1 = 30G
+    migrate.with_file_transfer, migrate.between_vhost_novhost:
+        guest_path = C:\file
+        rtl8139:
+            file_size = 10
+    timedrift:
+        monotonicity:
+            cmd_get_time = "echo %TIME%"
+    network_ping:
+        interface_status_cmd = ipconfig /all
+    nic_hotplug, pci_hotplug.hotplug_nic:
+        modprobe_acpiphp = no
+        reference_cmd = systeminfo
+        find_pci_cmd = ipconfig /all | find "Description"
+        seconds_wait_for_device_install = 10
+        nic_virtio, nic_virtio_net:
+            match_string = "Red Hat VirtIO Ethernet Adapter"
+        nic_e1000:
+            match_string = "Intel\(R\) PRO/1000 MT Network Connection"
+    hotplug_block, block_hotplug:
+        reference_cmd = wmic diskdrive list
+        find_pci_cmd = wmic diskdrive list
+        pci_test_cmd = "echo PCI_NUM"
+        pci_test_cmd += " && C:\tools\diskpart_cmd.py --disk_id=PCI_NUM --op=mount_disk --timeout=120"
+        pci_test_cmd += " && C:\tools\diskpart_cmd.py --disk_id=PCI_NUM --op=umount_disk --timeout=120"
+        blk_virtio_scsi:
+            # Work around for bug #929084
+            # Please remove this after the bug is fixed.
+            rescan_after_unplug = "C:\tools\diskpart_cmd.py --disk_id=0 --op=rescan_disk"
+        with_block_resize:
+             pci_test_cmd = "C:\tools\diskpart_cmd.py --disk_id=PCI_NUM --op=mount_disk --timeout=120"
+             block_size_cmd = wmic diskdrive get size, index
+             block_size_pattern = "1\s+(\d+)"
+             accept_ratio = 0.05
+             guest_prepare_cmd = ""
+    physical_resources_check:
+        # virtio_blk, virtio_net:
+        # As we mostly use unsign drivers before GA, so disable signing check
+        # for Win guests
+        #   vio_driver_chk_cmd = 'driverquery /si | find "Red Hat"'
+        # Since cpu_threads_num = cpu_logical_processors_num / cpu_cores_num
+        # so clean up it.
+        cpu_threads_chk_cmd = ""
+    multi_disk:
+        list_volume_command = 'wmic volume get DriveLetter,FileSystem | more +1 | find /V "CDFS"'
+    live_snapshot:
+        create_cmd = "D:\coreutils\DummyCMD.exe %s 1073741824 1"
+        file_create = "C:\file_create"
+        clean_cmd = del
+        with_file_transfer:
+            tmp_dir = C:\
+    qemu_img.commit:
+        file_create_cmd = "cmd /c echo.> C:\commit_testfile"
+        file_info_cmd = "cmd /c dir C:\commit_testfile"
+        file_exist_chk_cmd = "cmd /c if exist C:\commit_testfile (echo file exist)"
+        file_not_exist_chk_cmd = "cmd /c if not exist C:\commit_testfile (echo file is not exist)"
+        file_del_cmd = "cmd /c del /Q C:\commit_testfile"
+    live_snapshot_chain:
+        # overwrite shutdown command here, because rhel7 always open snapshot file with cache=unsafe,
+        # force write data to disk before shutdown to avoid data inconsistent issue;
+        shutdown_command = smartdrv /c & shutdown /s /t 0
+    usb_basic_test:
+        deviceid_str = "VID_%s&PID_%s"
+        chk_usb_info_cmd = 'wmic path Win32_USBControllerDevice get Dependent | find "USB"'
+        vendor = ""
+        product = ""
+    eject_media:
+        cdroms += " cd2"
+        cdrom_cd1 = /tmp/orig.iso
+        cdrom_cd2 = isos/windows/winutils.iso
+    qemu_guest_agent..Windows, qemu_guest_agent_hotplug:
+        gagent_src_type = virtio-win
+        #gagent_download_cmd = "python %s/get_package.py rhevm-4.0-rhel-7-candidate qemu-ga-win -u http://download.eng.bos.redhat.com"
+    netperf:
+        guest_ver_cmd = wmic datafile where name="C:\\Windows\\system32\\DRIVERS\\netkvm.sys" get version |findstr "[0-9]"
+    multi_disk_install:
+        bootindex_image1 = 0
+        no iscsi emulational_iscsi
diff --git a/shared/cfg/guest-os/Windows/Win10.cfg b/shared/cfg/guest-os/Windows/Win10.cfg
index cc0696eb..4bffb8a3 100644
--- a/shared/cfg/guest-os/Windows/Win10.cfg
+++ b/shared/cfg/guest-os/Windows/Win10.cfg
@@ -1,3 +1,9 @@
 - Win10:
     os_variant = win10
     image_name = images/win10
+    ## Internal only configuration. Will add to end of upstream file.
+    #BZ1044979
+    guest_name = Win10
+    boot_cpu_model.model_cluster:
+        cpu_model_GenuineIntel = "Haswell SandyBridge Westmere Nehalem Penryn"
+        cpu_model_AuthenticAMD = "Opteron_G5 Opteron_G4 Opteron_G3 Opteron_G2"
diff --git a/shared/cfg/guest-os/Windows/Win10/i386.cfg b/shared/cfg/guest-os/Windows/Win10/i386.cfg
index e6f3bbe5..ef78c1f6 100644
--- a/shared/cfg/guest-os/Windows/Win10/i386.cfg
+++ b/shared/cfg/guest-os/Windows/Win10/i386.cfg
@@ -28,3 +28,33 @@
         vm_mem_limit = 3G
         q35:
             vm_mem_limit = 2G
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -32
+    unattended_install.cdrom, whql.support_vm_install, with_installation, check_block_size..extra_cdrom_ks:
+        cdrom_cd1 = isos/ISO/Win10/en_windows_10_business_editions_version_2004_updated_may_2020_x86_dvd_3d5f0bff.iso
+        md5sum_cd1 = 1d875d99bd48b25c23f2856ac0e325e7
+        md5sum_1m_cd1 = 1b4fe1689932144c01c78768038ef9ee
+        # Uncomment virtio_network_installer_path line if
+        # you have an msi installer, also make sure the
+        # paths are properly set in your virtio driver iso.
+        virtio_storage_path = 'A:\i386\Win10'
+        virtio_network_path = 'A:\i386\Win10'
+        virtio_scsi_path = 'A:\i386\Win10'
+        #virtio_network_installer_path = 'F:\RHEV-Network32.msi'
+        extra_cdrom_ks:
+            virtio_storage_path = 'F:\viostor\w10\x86'
+            virtio_network_path = 'F:\NetKVM\w10\x86'
+            virtio_scsi_path = 'F:\vioscsi\w10\x86'
+            virtio_balloon_path = 'F:\Balloon\w10\x86'
+            virtio_viorng_path = 'F:\viorng\w10\x86'
+            virtio_vioser_path = 'F:\vioserial\w10\x86'
+            virtio_vioinput_path = 'F:\vioinput\w10\x86'
+            virtio_pvpanic_path = 'F:\pvpanic\w10\x86'
+            virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\Win8\\x86
+            virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\w10\\x86
+            cd_format = ide
+            q35:
+                cd_format = ahci
+    sysprep:
+        unattended_file = win10-32-autounattend.xml
diff --git a/shared/cfg/guest-os/Windows/Win10/x86_64.cfg b/shared/cfg/guest-os/Windows/Win10/x86_64.cfg
index 2c7370be..6c8138d2 100644
--- a/shared/cfg/guest-os/Windows/Win10/x86_64.cfg
+++ b/shared/cfg/guest-os/Windows/Win10/x86_64.cfg
@@ -28,3 +28,32 @@
         status_balloon_service = "%s:\Balloon\w10\amd64\blnsvr.exe status"
         run_balloon_service = "%s:\Balloon\w10\amd64\blnsvr.exe -r"
         stop_balloon_service = "%s:\Balloon\w10\amd64\blnsvr.exe -s"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -64
+    unattended_install.cdrom, whql.support_vm_install, with_installation, check_block_size..extra_cdrom_ks:
+        cdrom_cd1 = isos/ISO/Win10/en_windows_10_business_editions_version_2004_updated_may_2020_x64_dvd_aa8db2cc.iso
+        md5sum_cd1 =72be410c3bfbc01e1f39cf724ee26965
+        md5sum_1m_cd1 = 9af372816c777297d552b46eac69987c
+        # Uncomment virtio_network_installer_path line if
+        # you have an msi installer, also make sure the
+        # paths are properly set in your virtio driver iso.
+        virtio_storage_path = 'A:\amd64\Win10'
+        virtio_network_path = 'A:\amd64\Win10'
+        virtio_scsi_path = 'A:\amd64\Win10'
+        extra_cdrom_ks:
+            virtio_storage_path = 'F:\viostor\w10\amd64'
+            virtio_network_path = 'F:\NetKVM\w10\amd64'
+            virtio_scsi_path = 'F:\vioscsi\w10\amd64'
+            virtio_balloon_path = 'F:\Balloon\w10\amd64'
+            virtio_viorng_path = 'F:\viorng\w10\amd64'
+            virtio_vioser_path = 'F:\vioserial\w10\amd64'
+            virtio_vioinput_path = 'F:\vioinput\w10\amd64'
+            virtio_pvpanic_path = 'F:\pvpanic\w10\amd64'
+            virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\Win8\\x64
+            virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\w10\\amd64
+            cd_format = ide
+            q35:
+                cd_format = ahci
+    sysprep:
+        unattended_file = win10-64-autounattend.xml
diff --git a/shared/cfg/guest-os/Windows/Win2003.cfg b/shared/cfg/guest-os/Windows/Win2003.cfg
index ec9fbf8a..90824c43 100644
--- a/shared/cfg/guest-os/Windows/Win2003.cfg
+++ b/shared/cfg/guest-os/Windows/Win2003.cfg
@@ -18,3 +18,39 @@
     no iometer_windows.performance.msi_on
     # MSI is not supported on WinXP/2003
     # download.microsoft.com/download/9/c/5/9c5b2167-8017-4bae-9fde-d599bac8184a/PCI-PCIe_FAQ.doc
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    # disable according bz#985660
+    no virtio_scsi
+    no iometer_windows.performance.msi_on
+    # MSI is not supported on WinXP/2003
+    # download.microsoft.com/download/9/c/5/9c5b2167-8017-4bae-9fde-d599bac8184a/PCI-PCIe_FAQ.doc
+    guest_name = Win2003
+    inactivity_treshold = 2700
+    unattended_install.cdrom, whql.support_vm_install:
+        # Due to BZ1167605 which is closed as "WONTFIX", win2003 should use the driver which is not higher than virtio-win-1.7.2.
+        cdrom_virtio = isos/windows/virtio-win.win2003.iso
+    block_hotplug, format_disk, physical_resources_check, iometer_windows, iometer_performance, netperf_win.netperf_exe.best_registry_setting:
+        shell_port = 23
+        shell_client = telnet
+    iometer_windows:
+        sleep_before_test = 0
+        create_partition_cmd = "echo select disk 1 > imDiskpart.script &&"
+        create_partition_cmd += " echo create partition primary >> imDiskpart.script &&"
+        create_partition_cmd += " echo assign letter=I >> imDiskpart.script &&"
+        create_partition_cmd += " echo exit >> imDiskpart.script &&"
+        create_partition_cmd += " C:\windows\system32\diskpart.exe /s imDiskpart.script"
+    iometer_performance:
+        sleep_before_test = 0
+        create_partition_cmd = "echo select disk 1 > imDiskpart.script &&"
+        create_partition_cmd += " echo create partition primary >> imDiskpart.script &&"
+        create_partition_cmd += " echo assign letter=I >> imDiskpart.script &&"
+        create_partition_cmd += " echo exit >> imDiskpart.script &&"
+        create_partition_cmd += " C:\windows\system32\diskpart.exe /s imDiskpart.script"
+    physical_resources_check:
+        # Note: The NumberOfCores and NumberOfLogicalProcessors property
+        #       is not available in Windows Server 2003.
+        #       The link is http://support.microsoft.com/kb/932370/en-us
+        del cpu_logical_processors_chk_cmd
+        del cpu_cores_chk_cmd
+        del cpu_threads_chk_cmd
diff --git a/shared/cfg/guest-os/Windows/Win2003/i386.cfg b/shared/cfg/guest-os/Windows/Win2003/i386.cfg
index 1ce67337..7553128d 100644
--- a/shared/cfg/guest-os/Windows/Win2003/i386.cfg
+++ b/shared/cfg/guest-os/Windows/Win2003/i386.cfg
@@ -49,3 +49,35 @@
         uninstall_balloon_service = "%s:\Balloon\2k3\x86\blnsvr.exe -u"
         status_balloon_service = "%s:\Balloon\2k3\x86\blnsvr.exe status"
         run_balloon_service = "%s:\Balloon\2k3\x86\blnsvr.exe -r"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -32
+    vcpu_maxcpus_max = 32
+    vcpu_sockets_max = 32
+    unattended_install.cdrom:
+        cdrom_cd1 = isos/ISO/Win2003/32/en_win_srv_2003_r2_enterprise_with_sp2_X13.iso
+        md5sum_cd1 =
+        md5sum_1m_cd1 =
+        sha1sum_cd1 =
+        sha1sum_1m_cd1 =
+        # Uncomment virtio_network_installer_path line if
+        # you have an msi installer, also make sure the
+        # paths are properly set in your virtio driver iso.
+        virtio_oemsetup_id = WNET32
+        virtio_network_path = 'A:\i386\Win2003'
+        #virtio_network_installer_path = 'F:\RHEV-Network.msi'
+        virtio_network_installer_path = E:\\install_driver.bat A:\i386\Win2003
+        virtio_qxl_installer_path = E:\\install_driver.bat A:\\i386\\WinXP
+        virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\2k3\\x86
+    whql_env_setup:
+        cdrom_whql = images/win2k3-32/whql.iso
+    whql_env_setup.block_device:
+        symbol_files = "git://qe-git.englab.nay.redhat.com/whql/win2k3_32"
+    win_virtio_update:
+        images = "image1 stg"
+        drivers_install = "balloon;virtio_blk;nic;virtio_serial"
+        driver_install_cmd_balloon = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\Balloon\2k3\x86
+        driver_install_cmd_virtio_blk = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\viostor\2k3\x86
+        driver_install_cmd_nic = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\NetKVM\2k3\x86
+        driver_install_cmd_virtio_serial = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\vioserial\2k3\x86
+        kill_rundll = yes
diff --git a/shared/cfg/guest-os/Windows/Win2003/x86_64.cfg b/shared/cfg/guest-os/Windows/Win2003/x86_64.cfg
index 6553b485..9af66c9e 100644
--- a/shared/cfg/guest-os/Windows/Win2003/x86_64.cfg
+++ b/shared/cfg/guest-os/Windows/Win2003/x86_64.cfg
@@ -46,3 +46,35 @@
         uninstall_balloon_service = "%s:\Balloon\2k3\amd64\blnsvr.exe -u"
         status_balloon_service = "%s:\Balloon\2k3\amd64\blnsvr.exe status"
         run_balloon_service = "%s:\Balloon\2k3\amd64\blnsvr.exe -r"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -64
+    vcpu_maxcpus_max = 64
+    vcpu_sockets_max = 64
+    unattended_install.cdrom, whql.support_vm_install:
+        cdrom_cd1 = isos/ISO/Win2003/64/en_win_srv_2003_r2_enterprise_x64_with_sp2_X13.iso
+        md5sum_cd1 =
+        md5sum_1m_cd1 =
+        sha1sum_cd1 =
+        sha1sum_1m_cd1 =
+        # Uncomment virtio_network_installer_path line if
+        # you have an msi installer, also make sure the
+        # paths are properly set in your virtio driver iso.
+        virtio_oemsetup_id = WNET64
+        virtio_network_path = 'A:\amd64\Win2003'
+        #virtio_network_installer_path = 'F:\RHEV-Network64.msi'
+        virtio_network_installer_path = E:\\install_driver.bat A:\amd64\Win2003
+        virtio_qxl_installer_path = E:\\install_driver.bat A:\\amd64\\Win7
+        virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\2k3\\amd64
+    whql_env_setup:
+        cdrom_whql = images/win2k3-64/whql.iso
+    whql_env_setup.block_device:
+        symbol_files = "git://qe-git.englab.nay.redhat.com/whql/win2k3_64"
+    win_virtio_update:
+        images = "image1 stg"
+        drivers_install = "balloon;virtio_blk;nic"
+        driver_install_cmd_balloon = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\Balloon\2k3\amd64
+        driver_install_cmd_virtio_blk = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\viostor\2k3\amd64
+        driver_install_cmd_nic = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\NetKVM\2k3\amd64
+        driver_install_cmd_virtio_serial = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\vioserial\2k3\amd64
+        kill_rundll = yes
diff --git a/shared/cfg/guest-os/Windows/Win2008.cfg b/shared/cfg/guest-os/Windows/Win2008.cfg
index c78ff6d9..eb94d8f7 100644
--- a/shared/cfg/guest-os/Windows/Win2008.cfg
+++ b/shared/cfg/guest-os/Windows/Win2008.cfg
@@ -14,3 +14,9 @@
         nic_model_nic1 = e1000
     physical_resources_check:
         catch_serial_cmd =
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name = Win2008
+    netperf_win.netperf_exe.best_registry_setting:
+        shell_port = 23
+        shell_client = telnet
diff --git a/shared/cfg/guest-os/Windows/Win2008/i386.cfg b/shared/cfg/guest-os/Windows/Win2008/i386.cfg
index 945c87c3..abe1ef64 100644
--- a/shared/cfg/guest-os/Windows/Win2008/i386.cfg
+++ b/shared/cfg/guest-os/Windows/Win2008/i386.cfg
@@ -54,3 +54,35 @@
                     drive_index_winutils = 2
                     drive_index_unattended = 3
                     cdrom_unattended = "images/win2008-sp2-32/autounattend.iso"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    no sp1
+    vcpu_maxcpus_max = 32
+    vcpu_sockets_max = 32
+    sp2:
+        guest_name += -sp2-32
+        unattended_install.cdrom, with_installation:
+            cdrom_cd1 = isos/ISO/Win2008/32/en_windows_server_2008_datacenter_enterprise_standard_sp2_x86_dvd_342333.iso
+            md5sum_cd1 =
+            md5sum_1m_cd1 =
+            sha1sum_cd1 =
+            sha1sum_1m_cd1 =
+            # Uncomment virtio_network_installer_path line if
+            # you have an msi installer, also make sure the
+            # paths are properly set in your virtio driver iso.
+            virtio_storage_path = 'A:\i386\Win2008'
+            virtio_network_path = 'A:\i386\Win2008'
+            virtio_scsi_path = 'A:\i386\Win2008'
+            #virtio_network_installer_path = 'F:\RHEV-Network.msi'
+            virtio_scsi:
+                virtio_scsi_cdrom = yes
+            extra_cdrom_ks:
+                virtio_storage_path = "F:\viostor\2k8\x86"
+                virtio_network_path = 'F:\NetKVM\2k8\x86'
+                virtio_scsi_path = 'F:\vioscsi\2k8\x86'
+                #virtio_balloon_installer_path = pnputil -i -a F:\\Balloon\\2k8\\x86\\balloon.inf
+                virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\2k8\\x86
+                virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\w7\\x86
+                cd_format = ide
+                q35:
+                    cd_format = ahci
diff --git a/shared/cfg/guest-os/Windows/Win2008/x86_64.cfg b/shared/cfg/guest-os/Windows/Win2008/x86_64.cfg
index 9238029a..9611f2f4 100644
--- a/shared/cfg/guest-os/Windows/Win2008/x86_64.cfg
+++ b/shared/cfg/guest-os/Windows/Win2008/x86_64.cfg
@@ -92,3 +92,59 @@
                 status_balloon_service = "%s:\Balloon\2k8R2\amd64\blnsvr.exe status"
                 run_balloon_service = "%s:\Balloon\2k8R2\amd64\blnsvr.exe -r"
                 stop_balloon_service = "%s:\Balloon\2k8R2\amd64\blnsvr.exe -s"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    no sp1
+    vcpu_maxcpus_max = 64
+    vcpu_sockets_max = 32
+    unattended_install.cdrom, with_installation:
+        # Uncomment virtio_network_installer_path line if
+        # you have an msi installer, also make sure the
+        # paths are properly set in your virtio driver iso.
+        extra_cdrom_ks:
+            cd_format = ide
+            q35:
+                cd_format = ahci
+    sp2:
+        guest_name += -sp2-64
+        unattended_install.cdrom, with_installation:
+            cdrom_cd1 = isos/ISO/Win2008/64/en_windows_server_2008_datacenter_enterprise_standard_sp2_x64_dvd_342336.iso
+            virtio_storage_path = 'A:\amd64\Win2008'
+            virtio_network_path = 'A:\amd64\Win2008'
+            virtio_scsi_path = 'A:\amd64\Win2008'
+            #virtio_network_installer_path = 'F:\RHEV-Network64.msi'
+            virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\2k8\\amd64
+            extra_cdrom_ks:
+                virtio_storage_path = "F:\viostor\2k8\amd64"
+                virtio_network_path = 'F:\NetKVM\2k8\amd64'
+                virtio_scsi_path = 'F:\vioscsi\2k8\amd64'
+                virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\w7\\amd64
+        sysprep:
+            unattended_file = win2008-sp2-64-autounattend.xml
+    r2:
+        guest_name += -r2-64
+        vcpu_maxcpus_max = 128
+        vcpu_sockets_max = 64
+        unattended_install.cdrom, with_installation:
+            cdrom_cd1 = isos/ISO/Win2008R2/en_windows_server_2008_r2_standard_enterprise_datacenter_and_web_with_sp1_x64_dvd_617601.iso
+            md5sum_cd1 = 8dcde01d0da526100869e2457aafb7ca
+            md5sum_1m_cd1 = 1588cccf7e4ed868e1369b88fcb5e87e
+            sha1sum_cd1 = d3fd7bf85ee1d5bdd72de5b2c69a7b470733cd0a
+            #sha1sum_1m_cd1 = 9194a3aabae25b36e5f73cad001314b2c8d07d14
+            virtio_storage_path = 'A:\amd64\Win2008R2'
+            virtio_network_path = 'A:\amd64\Win2008R2'
+            virtio_scsi_path = 'A:\amd64\Win2008R2'
+            #virtio_network_installer_path = 'F:\RHEV-Network64.msi'
+            virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\2k8R2\\amd64
+            extra_cdrom_ks:
+                virtio_storage_path = "F:\viostor\2k8R2\amd64"
+                virtio_network_path = 'F:\NetKVM\2k8R2\amd64'
+                virtio_scsi_path = 'F:\vioscsi\2k8R2\amd64'
+                virtio_balloon_path = 'F:\Balloon\2k8R2\amd64'
+                virtio_viorng_path = 'F:\viorng\2k8R2\amd64'
+                virtio_vioser_path = 'F:\vioserial\2k8R2\amd64'
+                virtio_pvpanic_path = 'F:\pvpanic\2k8R2\amd64'
+                virtio_vioinput_path = 'F:\vioinput\2k8R2\amd64'
+                virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\2k8R2\\amd64
+        sysprep:
+            unattended_file = win2008-r2-autounattend.xml
diff --git a/shared/cfg/guest-os/Windows/Win2012.cfg b/shared/cfg/guest-os/Windows/Win2012.cfg
index 73619c61..d73b6853 100644
--- a/shared/cfg/guest-os/Windows/Win2012.cfg
+++ b/shared/cfg/guest-os/Windows/Win2012.cfg
@@ -17,3 +17,11 @@
     netperf_win.netperf_exe.best_registry_setting:
         shell_port = 23
         shell_client = telnet
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    netperf_win.netperf_exe.best_registry_setting:
+        shell_port = 23
+        shell_client = telnet
+    boot_cpu_model.model_cluster:
+        cpu_model_GenuineIntel = "Haswell SandyBridge Westmere Nehalem Penryn"
+        cpu_model_AuthenticAMD = "Opteron_G5 Opteron_G4 Opteron_G3 Opteron_G2"
diff --git a/shared/cfg/guest-os/Windows/Win2012/x86_64.cfg b/shared/cfg/guest-os/Windows/Win2012/x86_64.cfg
index 227f73a9..66ff35bf 100644
--- a/shared/cfg/guest-os/Windows/Win2012/x86_64.cfg
+++ b/shared/cfg/guest-os/Windows/Win2012/x86_64.cfg
@@ -55,3 +55,58 @@
                 status_balloon_service = "%s:\Balloon\2k12R2\amd64\blnsvr.exe status"
                 run_balloon_service = "%s:\Balloon\2k12R2\amd64\blnsvr.exe -r"
                 stop_balloon_service = "%s:\Balloon\2k12R2\amd64\blnsvr.exe -s"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -64
+    vcpu_maxcpus_max = 128
+    vcpu_sockets_max = 64
+    unattended_install.cdrom, with_installation, check_block_size..extra_cdrom_ks:
+        cdrom_cd1 = isos/ISO/Win2012/en_windows_server_2012_x64_dvd_915478.iso
+        md5sum_cd1 = 8dcde01d0da526100869e2457aafb7ca
+        md5sum_1m_cd1 = c6a4b1097449bb1f050492a6b57e7d21
+        sha1sum_cd1 = d3fd7bf85ee1d5bdd72de5b2c69a7b470733cd0a
+        sha1sum_1m_cd1 = 9194a3aabae25b36e5f73cad001314b2c8d07d14
+        # Uncomment virtio_network_installer_path line if
+        # you have an msi installer, also make sure the
+        # paths are properly set in your virtio driver iso.
+        virtio_storage_path = 'A:\amd64\Win2012'
+        virtio_network_path = 'A:\amd64\Win2012'
+        virtio_scsi_path = 'A:\amd64\Win2012'
+        #virtio_network_installer_path = 'F:\RHEV-Network64.msi'
+        virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\2k12\\amd64
+        extra_cdrom_ks:
+            virtio_storage_path = 'F:\viostor\2k12\amd64'
+            virtio_network_path = 'F:\NetKVM\2k12\amd64'
+            virtio_scsi_path = 'F:\vioscsi\2k12\amd64'
+            virtio_balloon_path = 'F:\Balloon\2k12\amd64'
+            virtio_viorng_path = 'F:\viorng\2k12\amd64'
+            virtio_vioser_path = 'F:\vioserial\2k12\amd64'
+            virtio_vioinput_path = 'F:\vioinput\2k12\amd64'
+            virtio_pvpanic_path = 'F:\pvpanic\2k12\amd64'
+            virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\Win8\\x64
+            cd_format = ide
+            q35:
+                cd_format = ahci
+    r2:
+        guest_name += r2
+        unattended_install.cdrom, with_installation, check_block_size..extra_cdrom_ks:
+            cdrom_cd1 = isos/ISO/Win2012R2/en_windows_server_2012_r2_with_update_x64_dvd_6052708.iso
+            md5sum_cd1 = 78bff6565f178ed08ab534397fe44845
+            md5sum_1m_cd1 = b978cdd8d89e50a55a03a80a0a3da3c9
+            virtio_storage_path = 'A:\amd64\Win2012R2'
+            virtio_network_path = 'A:\amd64\Win2012R2'
+            virtio_scsi_path = 'A:\amd64\Win2012R2'
+            #virtio_network_installer_path = 'F:\RHEV-Network64.msi'
+            virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\2k12R2\\amd64
+            extra_cdrom_ks:
+                virtio_storage_path = 'F:\viostor\2k12R2\amd64'
+                virtio_network_path = 'F:\NetKVM\2k12R2\amd64'
+                virtio_scsi_path = 'F:\vioscsi\2k12R2\amd64'
+                virtio_balloon_path = 'F:\Balloon\2k12R2\amd64'
+                virtio_viorng_path = 'F:\viorng\2k12R2\amd64'
+                virtio_vioser_path = 'F:\vioserial\2k12R2\amd64'
+                virtio_vioinput_path = 'F:\vioinput\2k12R2\amd64'
+                virtio_pvpanic_path = 'F:\pvpanic\2k12R2\amd64'
+                virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\Win8\\x64
+        sysprep:
+            unattended_file = unattended/win2012r2-autounattend.xml
diff --git a/shared/cfg/guest-os/Windows/Win2016.cfg b/shared/cfg/guest-os/Windows/Win2016.cfg
index b08c3fe4..a22e41a9 100644
--- a/shared/cfg/guest-os/Windows/Win2016.cfg
+++ b/shared/cfg/guest-os/Windows/Win2016.cfg
@@ -1,3 +1,8 @@
 - Win2016:
     os_variant = win2016
     image_name = images/win2016
+    ## Internal only configuration. Will add to end of upstream file.
+    guest_name = Win2016
+    boot_cpu_model.model_cluster:
+        cpu_model_GenuineIntel = "Haswell SandyBridge Westmere Nehalem Penryn"
+        cpu_model_AuthenticAMD = "Opteron_G5 Opteron_G4 Opteron_G3 Opteron_G2"
diff --git a/shared/cfg/guest-os/Windows/Win2016/x86_64.cfg b/shared/cfg/guest-os/Windows/Win2016/x86_64.cfg
index 4d32c99f..82946939 100644
--- a/shared/cfg/guest-os/Windows/Win2016/x86_64.cfg
+++ b/shared/cfg/guest-os/Windows/Win2016/x86_64.cfg
@@ -28,3 +28,33 @@
         status_balloon_service = "%s:\Balloon\2k16\amd64\blnsvr.exe status"
         run_balloon_service = "%s:\Balloon\2k16\amd64\blnsvr.exe -r"
         stop_balloon_service = "%s:\Balloon\2k16\amd64\blnsvr.exe -s"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -64
+    vm_mem_minimum = 4G
+    unattended_install.cdrom, whql.support_vm_install, with_installation, check_block_size..extra_cdrom_ks:
+        cdrom_cd1 = isos/ISO/Win2016/en_windows_server_2016_updated_feb_2018_x64_dvd_11636692.iso
+        md5sum_cd1 = e8adeebcd8076702593469e33cc2d092
+        md5sum_1m_cd1 = 248c966a31edc371942241a2a948e6a9
+        # Uncomment virtio_network_installer_path line if
+        # you have an msi installer, also make sure the
+        # paths are properly set in your virtio driver iso.
+        virtio_storage_path = 'A:\amd64\Win2016'
+        virtio_network_path = 'A:\amd64\Win2016'
+        virtio_scsi_path = 'A:\amd64\Win2016'
+        extra_cdrom_ks:
+            virtio_storage_path = 'F:\viostor\2k16\amd64'
+            virtio_network_path = 'F:\NetKVM\2k16\amd64'
+            virtio_scsi_path = 'F:\vioscsi\2k16\amd64'
+            virtio_balloon_path = 'F:\Balloon\2k16\amd64'
+            virtio_viorng_path = 'F:\viorng\2k16\amd64'
+            virtio_vioser_path = 'F:\vioserial\2k16\amd64'
+            virtio_vioinput_path = 'F:\vioinput\2k16\amd64'
+            virtio_pvpanic_path = 'F:\pvpanic\2k16\amd64'
+            virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\2k16\\x64
+            virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\2k16\\amd64
+            cd_format = ide
+            q35:
+                cd_format = ahci
+    sysprep:
+        unattended_file = win2016-autounattend.xml
diff --git a/shared/cfg/guest-os/Windows/Win2019.cfg b/shared/cfg/guest-os/Windows/Win2019.cfg
index 4b458f96..dade8c87 100644
--- a/shared/cfg/guest-os/Windows/Win2019.cfg
+++ b/shared/cfg/guest-os/Windows/Win2019.cfg
@@ -1,3 +1,8 @@
 - Win2019:
     os_variant = win2019
     image_name = images/win2019
+    ## Internal only configuration. Will add to end of upstream file.
+    guest_name = Win2019
+    boot_cpu_model.model_cluster:
+        cpu_model_GenuineIntel = "Haswell SandyBridge Westmere Nehalem Penryn"
+        cpu_model_AuthenticAMD = "Opteron_G5 Opteron_G4 Opteron_G3 Opteron_G2"
diff --git a/shared/cfg/guest-os/Windows/Win2019/x86_64.cfg b/shared/cfg/guest-os/Windows/Win2019/x86_64.cfg
index a477714c..15d39df0 100644
--- a/shared/cfg/guest-os/Windows/Win2019/x86_64.cfg
+++ b/shared/cfg/guest-os/Windows/Win2019/x86_64.cfg
@@ -28,3 +28,47 @@
         status_balloon_service = "%s:\Balloon\2k19\amd64\blnsvr.exe status"
         run_balloon_service = "%s:\Balloon\2k19\amd64\blnsvr.exe -r"
         stop_balloon_service = "%s:\Balloon\2k19\amd64\blnsvr.exe -s"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -64
+    vm_mem_minimum = 4G
+    install:
+        passwd = 1q2w3eP
+    unattended_install.cdrom, whql.support_vm_install, with_installation, check_block_size..extra_cdrom_ks:
+        cdrom_cd1 = isos/ISO/Win2019/en_windows_server_2019_updated_may_2020_x64_dvd_5651846f.iso
+        md5sum_cd1 = eeaeb5eb511335a259f6bb87b0bbfc02
+        md5sum_1m_cd1 = fb54c8fc120f6c384f77d61a4421437e
+        unattended_file = unattended/win2019-autounattend.xml
+        ovmf:
+            unattended_file = unattended/win2019-autounattend_ovmf.xml
+        # Uncomment virtio_network_installer_path line if
+        # you have an msi installer, also make sure the
+        # paths are properly set in your virtio driver iso.
+        virtio_storage_path = 'A:\amd64\Win2019'
+        virtio_network_path = 'A:\amd64\Win2019'
+        virtio_scsi_path = 'A:\amd64\Win2019'
+        #floppies = "fl"
+        #floppy_name = images/win2019-64/answer.vfd
+        extra_cdrom_ks:
+            floppies = ""
+            unattended_delivery_method = cdrom
+            cdroms = "cd1 winutils unattended"
+            drive_index_cd1 = 1
+            drive_index_winutils = 2
+            drive_index_unattended = 3
+            virtio_storage_path = 'F:\viostor\2k19\amd64'
+            virtio_network_path = 'F:\NetKVM\2k19\amd64'
+            virtio_scsi_path = 'F:\vioscsi\2k19\amd64'
+            virtio_balloon_path = 'F:\Balloon\2k19\amd64'
+            virtio_viorng_path = 'F:\viorng\2k19\amd64'
+            virtio_vioser_path = 'F:\vioserial\2k19\amd64'
+            virtio_vioinput_path = 'F:\vioinput\2k19\amd64'
+            virtio_pvpanic_path = 'F:\pvpanic\2k19\amd64'
+            virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\2k19\\x64
+            virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\2k19\\amd64
+            cd_format = ide
+            cdrom_unattended = "images/win2019-64/autounattend.iso"
+            q35:
+                cd_format = ahci
+    sysprep:
+        unattended_file = win2019-autounattend.xml
diff --git a/shared/cfg/guest-os/Windows/Win7.cfg b/shared/cfg/guest-os/Windows/Win7.cfg
index dd6514bb..4e261d79 100644
--- a/shared/cfg/guest-os/Windows/Win7.cfg
+++ b/shared/cfg/guest-os/Windows/Win7.cfg
@@ -19,3 +19,6 @@
         nic_model_nic1 = e1000
     physical_resources_check:
         catch_serial_cmd =
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name = Win7
diff --git a/shared/cfg/guest-os/Windows/Win7/i386.cfg b/shared/cfg/guest-os/Windows/Win7/i386.cfg
index 7c37e7a1..a3da8847 100644
--- a/shared/cfg/guest-os/Windows/Win7/i386.cfg
+++ b/shared/cfg/guest-os/Windows/Win7/i386.cfg
@@ -61,3 +61,41 @@
                     cdrom_unattended = "images/win7-32-sp1/autounattend.iso"
                     q35:
                         cd_format = ahci
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -32
+    vcpu_maxcpus_max = 32
+    vcpu_sockets_max = 2
+    no sp0
+    unattended_install.cdrom, whql.support_vm_install, with_installation:
+        cdrom_cd1 = isos/ISO/Win7/en_windows_7_ultimate_with_sp1_x86_dvd_u_677460.iso
+        md5sum_cd1 = 2572274e6b0acf4ed1b502b175f2c2db
+        md5sum_1m_cd1 = a00396ae3f23333b15dbb757d91f15d1
+        sha1sum_cd1 =
+        sha1sum_1m_cd1 =
+        # Uncomment virtio_network_installer_path line if
+        # you have an msi installer, also make sure the
+        # paths are properly set in your virtio driver iso.
+        virtio_storage_path = 'A:\i386\Win7'
+        virtio_network_path = 'A:\i386\Win7'
+        virtio_scsi_path = 'A:\i386\Win7'
+        #virtio_network_installer_path = 'F:\RHEV-Network32.msi'
+        virtio_qxl_installer_path = E:\\install_driver.bat A:\i386\Win7
+        extra_cdrom_ks:
+            virtio_storage_path = "F:\viostor\w7\x86"
+            virtio_network_path = 'F:\NetKVM\w7\x86'
+            virtio_scsi_path = 'F:\vioscsi\w7\x86'
+            virtio_balloon_path = 'F:\Balloon\w7\x86'
+            virtio_viorng_path = 'F:\viorng\w7\x86'
+            virtio_vioser_path = 'F:\vioserial\w7\x86'
+            virtio_vioinput_path = 'F:\vioinput\w7\x86'
+            virtio_pvpanic_path = 'F:\pvpanic\w7\x86'
+            virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\w7\\x86
+            virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\w7\\x86
+            cd_format = ide
+            q35:
+                cd_format = ahci
+    whql.submission:
+        dd_data_whqlqual = Logo
+    sysprep:
+        unattended_file = win7-32-autounattend.xml
diff --git a/shared/cfg/guest-os/Windows/Win7/x86_64.cfg b/shared/cfg/guest-os/Windows/Win7/x86_64.cfg
index 13278b5e..22ea22a0 100644
--- a/shared/cfg/guest-os/Windows/Win7/x86_64.cfg
+++ b/shared/cfg/guest-os/Windows/Win7/x86_64.cfg
@@ -71,3 +71,41 @@
                     cdrom_unattended = "images/win7-64-sp1/autounattend.iso"
                     q35:
                         cd_format = ahci
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -64
+    vcpu_maxcpus_max = 128
+    vcpu_sockets_max = 2
+    no sp0
+    unattended_install.cdrom, whql.support_vm_install, with_installation:
+        cdrom_cd1 = isos/ISO/Win7/en_windows_7_ultimate_with_sp1_x64_dvd_u_677332.iso
+        md5sum_cd1 = qc9f7ecb768acb82daacf5030e14b271e
+        md5sum_1m_cd1 = 0b45ee07fc26d8cbc7d08daed9be1a22
+        sha1sum_cd1 =
+        sha1sum_1m_cd1 =
+        # Uncomment virtio_network_installer_path line if
+        # you have an msi installer, also make sure the
+        # paths are properly set in your virtio driver iso.
+        virtio_storage_path = 'A:\amd64\Win7'
+        virtio_network_path = 'A:\amd64\Win7'
+        virtio_scsi_path = 'A:\amd64\Win7'
+        #virtio_network_installer_path = 'F:\RHEV-Network64.msi'
+        virtio_qxl_installer_path = E:\\install_driver.bat A:\amd64\Win7
+        extra_cdrom_ks:
+            virtio_storage_path = "F:\viostor\w7\amd64"
+            virtio_network_path = 'F:\NetKVM\w7\amd64'
+            virtio_scsi_path = 'F:\vioscsi\w7\amd64'
+            virtio_balloon_path = 'F:\Balloon\w7\amd64'
+            virtio_viorng_path = 'F:\viorng\w7\amd64'
+            virtio_vioser_path = 'F:\vioserial\w7\amd64'
+            virtio_vioinput_path = 'F:\vioinput\w7\amd64'
+            virtio_pvpanic_path = 'F:\pvpanic\w7\amd64'
+            virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\w7\\amd64
+            virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\w7\\amd64
+            cd_format = ide
+            q35:
+                cd_format = ahci
+    whql.submission:
+        dd_data_whqlqual = Logo
+    sysprep:
+        unattended_file = win7-64-autounattend.xml
diff --git a/shared/cfg/guest-os/Windows/Win8.cfg b/shared/cfg/guest-os/Windows/Win8.cfg
index da16a627..ed444442 100644
--- a/shared/cfg/guest-os/Windows/Win8.cfg
+++ b/shared/cfg/guest-os/Windows/Win8.cfg
@@ -9,3 +9,9 @@
         device_data += " adq"
         dd_name_adq = AdditionalQualificationGroup
         dd_data_adq = Windows 7
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name = Win8
+    boot_cpu_model.model_cluster:
+        cpu_model_GenuineIntel = "Haswell SandyBridge Westmere Nehalem Penryn"
+        cpu_model_AuthenticAMD = "Opteron_G5 Opteron_G4 Opteron_G3 Opteron_G2"
diff --git a/shared/cfg/guest-os/Windows/Win8/i386.cfg b/shared/cfg/guest-os/Windows/Win8/i386.cfg
index 2f11c218..45c938da 100644
--- a/shared/cfg/guest-os/Windows/Win8/i386.cfg
+++ b/shared/cfg/guest-os/Windows/Win8/i386.cfg
@@ -62,3 +62,57 @@
                 status_balloon_service = "%s:\Balloon\w8.1\x86\blnsvr.exe status"
                 run_balloon_service = "%s:\Balloon\w8.1\x86\blnsvr.exe -r"
                 stop_balloon_service = "%s:\Balloon\w8.1\x86\blnsvr.exe -s"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -32
+    vcpu_maxcpus_max = 32
+    vcpu_sockets_max = 2
+    unattended_install.cdrom, whql.support_vm_install, with_installation, check_block_size..extra_cdrom_ks:
+        cdrom_cd1 = isos/ISO/Win8/en_windows_8_enterprise_x86_dvd_917587.iso
+        md5sum_cd1 = ad055cae50cef987586c51cc6cc3c62e
+        md5sum_1m_cd1 = 92e5522e0ceff8c703d5fdca620c841f
+        # Uncomment virtio_network_installer_path line if
+        # you have an msi installer, also make sure the
+        # paths are properly set in your virtio driver iso.
+        virtio_storage_path = 'A:\i386\Win8'
+        virtio_network_path = 'A:\i386\Win8'
+        virtio_scsi_path = 'A:\i386\Win8'
+        #virtio_network_installer_path = 'F:\RHEV-Network32.msi'
+        extra_cdrom_ks:
+            virtio_storage_path = 'F:\viostor\w8\x86'
+            virtio_network_path = 'F:\NetKVM\w8\x86'
+            virtio_scsi_path = 'F:\vioscsi\w8\x86'
+            virtio_balloon_path = 'F:\Balloon\w8\x86'
+            virtio_viorng_path = 'F:\viorng\w8\x86'
+            virtio_vioser_path = 'F:\vioserial\w8\x86'
+            virtio_vioinput_path = 'F:\vioinput\w8\x86'
+            virtio_pvpanic_path = 'F:\pvpanic\w8\x86'
+            virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\Win8\\x86
+            virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\w8\\x86
+            cd_format = ide
+            q35:
+                cd_format = ahci
+    1:
+        guest_name += .1
+        unattended_install.cdrom, whql.support_vm_install, with_installation, check_block_size..extra_cdrom_ks:
+            cdrom_cd1 = isos/ISO/Win8u1/en_windows_8.1_enterprise_with_update_x86_dvd_6050710.iso
+            md5sum_cd1 = ce18de710a9c025323b8dee823bfbe7b
+            md5sum_1m_cd1 = 1bd7fed2a2dab8b6ffbe786c31594f1c
+            unattended_file = unattended/win8.1-32-autounattend.xml
+            virtio_storage_path = 'A:\i386\Win8.1'
+            virtio_network_path = 'A:\i386\Win8.1'
+            virtio_scsi_path = 'A:\i386\Win8.1'
+            #virtio_network_installer_path = 'F:\RHEV-Network32.msi'
+            extra_cdrom_ks:
+                virtio_storage_path = 'F:\viostor\w8.1\x86'
+                virtio_network_path = 'F:\NetKVM\w8.1\x86'
+                virtio_scsi_path = 'F:\vioscsi\w8.1\x86'
+                virtio_balloon_path = 'F:\Balloon\w8.1\x86'
+                virtio_viorng_path = 'F:\viorng\w8.1\x86'
+                virtio_vioser_path = 'F:\vioserial\w8.1\x86'
+                virtio_vioinput_path = 'F:\vioinput\w8.1\x86'
+                virtio_pvpanic_path = 'F:\pvpanic\w8.1\x86'
+                virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\Win8\\x86
+                virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\w8.1\\x86
+        sysprep:
+            unattended_file = win8.1-32-autounattend.xml
diff --git a/shared/cfg/guest-os/Windows/Win8/x86_64.cfg b/shared/cfg/guest-os/Windows/Win8/x86_64.cfg
index e4faabae..8208f7ca 100644
--- a/shared/cfg/guest-os/Windows/Win8/x86_64.cfg
+++ b/shared/cfg/guest-os/Windows/Win8/x86_64.cfg
@@ -70,3 +70,81 @@
                 status_balloon_service = "%s:\Balloon\w8.1\amd64\blnsvr.exe status"
                 run_balloon_service = "%s:\Balloon\w8.1\amd64\blnsvr.exe -r"
                 stop_balloon_service = "%s:\Balloon\w8.1\amd64\blnsvr.exe -s"
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    guest_name += -64
+    vcpu_maxcpus_max = 128
+    vcpu_sockets_max = 2
+    unattended_install.cdrom, whql.support_vm_install, with_installation, check_block_size..extra_cdrom_ks:
+        cdrom_cd1 = isos/ISO/Win8/en_windows_8_enterprise_x64_dvd_917522.iso
+        md5sum_cd1 = 27aa354b8088527ffcd32007b51b25bf
+        md5sum_1m_cd1 = 06f8883a669f55f27e98938e71e90d67
+        # Uncomment virtio_network_installer_path line if
+        # you have an msi installer, also make sure the
+        # paths are properly set in your virtio driver iso.
+        virtio_storage_path = 'A:\amd64\Win8'
+        virtio_network_path = 'A:\amd64\Win8'
+        virtio_scsi_path = 'A:\amd64\Win8'
+        #virtio_network_installer_path = 'F:\RHEV-Network32.msi'
+        extra_cdrom_ks:
+            virtio_storage_path = 'F:\viostor\w8\amd64'
+            virtio_network_path = 'F:\NetKVM\w8\amd64'
+            virtio_scsi_path = 'F:\vioscsi\w8\amd64'
+            virtio_balloon_path = 'F:\Balloon\w8\amd64'
+            virtio_viorng_path = 'F:\viorng\w8\amd64'
+            virtio_vioser_path = 'F:\vioserial\w8\amd64'
+            virtio_vioinput_path = 'F:\vioinput\w8\amd64'
+            virtio_pvpanic_path = 'F:\pvpanic\w8\amd64'
+            virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\Win8\\x64
+            virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\w8\\amd64
+            cd_format = ide
+            q35:
+                cd_format = ahci
+    sysprep:
+        unattended_file = win8-64-autounattend.xml
+    whql_env_setup:
+        cdrom_whql = images/win8-64/whql.iso
+    whql_env_setup.block_device:
+        symbol_files = "git://qe-git.englab.nay.redhat.com/whql/win7_64"
+    win_virtio_update:
+        driver_install_cmd_balloon = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\Balloon\w8\amd64
+        driver_install_cmd_virtio_blk = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\viostor\w8\amd64
+        driver_install_cmd_virtio_scsi = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\vioscsi\w8\amd64
+        driver_install_cmd_nic = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\NetKVM\w8\amd64
+        driver_install_cmd_virtio_serial = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\vioserial\w8\amd64
+        driver_install_cmd_virtio_rng = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\viorng\w8\amd64
+    1:
+        guest_name += .1
+        unattended_install.cdrom, whql.support_vm_install, with_installation, check_block_size..extra_cdrom_ks:
+            cdrom_cd1 = isos/ISO/Win8u1/en_windows_8.1_enterprise_with_update_x64_dvd_6054382.iso
+            md5sum_cd1 = 115d7c4203417e52c09d16b50043b10d
+            md5sum_1m_cd1 = 078945ff0ffea8da81aeb5e77f0233b3
+            unattended_file = unattended/win8.1-64-autounattend.xml
+            ovmf:
+                unattended_file = unattended/win8.1-64-autounattend_ovmf.xml
+            virtio_storage_path = 'A:\amd64\Win8.1'
+            virtio_network_path = 'A:\amd64\Win8.1'
+            virtio_scsi_path = 'A:\amd64\Win8.1'
+            #virtio_network_installer_path = 'F:\RHEV-Network32.msi'
+            extra_cdrom_ks:
+                virtio_storage_path = 'F:\viostor\w8.1\amd64'
+                virtio_network_path = 'F:\NetKVM\w8.1\amd64'
+                virtio_scsi_path = 'F:\vioscsi\w8.1\amd64'
+                virtio_balloon_path = 'F:\Balloon\w8.1\amd64'
+                virtio_viorng_path = 'F:\viorng\w8.1\amd64'
+                virtio_vioser_path = 'F:\vioserial\w8.1\amd64'
+                virtio_vioinput_path = 'F:\vioinput\w8.1\amd64'
+                virtio_pvpanic_path = 'F:\pvpanic\w8.1\amd64'
+                virtio_qxl_installer_path = E:\\install_driver.bat F:\\qxl\\Win8\\x64
+                virtio_balloon_installer_path = E:\\install_driver.bat F:\\Balloon\\w8.1\\amd64
+        sysprep:
+            unattended_file = win8.1-64-autounattend.xml
+        whql_env_setup:
+            cdrom_whql = images/win8.1-64/whql.iso
+        win_virtio_update:
+            driver_install_cmd_balloon = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\Balloon\w8.1\amd64
+            driver_install_cmd_virtio_blk = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\viostor\w8.1\amd64
+            driver_install_cmd_virtio_scsi = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\vioscsi\w8.1\amd64
+            driver_install_cmd_nic = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\NetKVM\w8.1\amd64
+            driver_install_cmd_virtio_serial = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\vioserial\w8.1\amd64
+            driver_install_cmd_virtio_rng = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\viorng\w8.1\amd64
diff --git a/shared/cfg/guest-os/Windows/WinXP.cfg b/shared/cfg/guest-os/Windows/WinXP.cfg
index 06ce06ec..fdbb902a 100644
--- a/shared/cfg/guest-os/Windows/WinXP.cfg
+++ b/shared/cfg/guest-os/Windows/WinXP.cfg
@@ -18,3 +18,28 @@
     # netsh interface set interface name="Local Area Connection" admin=DISABLED
     # this cmd works since Win2003
     # http://support.microsoft.com/kb/262265 http://forum.sysinternals.com/command-used-to-disable-network-interface_topic9483_page1.html
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    # e1000 does not support WinXP guest
+    no e1000
+    # virtio-scsi is not support WinXP guest
+    no virtio_scsi
+    no x86_64
+    guest_name = WinXP
+    inactivity_treshold = 2700
+    vcpu_maxcpus_max = 32
+    vcpu_sockets_max = 2
+    iometer_windows:
+        sleep_before_test = 0
+        create_partition_cmd = "echo select disk 1 > imDiskpart.script &&"
+         create_partition_cmd += " echo create partition primary >> imDiskpart.script &&"
+        create_partition_cmd += " echo assign letter=I >> imDiskpart.script &&"
+        create_partition_cmd  += " echo exit >> imDiskpart.script && diskpart /s imDiskpart.script"
+    iometer_performance:
+        sleep_before_test = 0
+        create_partition_cmd = "echo select disk 1 > imDiskpart.script &&"
+        create_partition_cmd += " echo create partition primary >> imDiskpart.script &&"
+        create_partition_cmd += " echo assign letter=I >> imDiskpart.script &&"
+        create_partition_cmd += " echo exit >> imDiskpart.script &&"
+        create_partition_cmd += " diskpart /s imDiskpart.script"
+
diff --git a/shared/cfg/guest-os/Windows/WinXP/i386.cfg b/shared/cfg/guest-os/Windows/WinXP/i386.cfg
index 89a3e2ad..5ea8bc7a 100644
--- a/shared/cfg/guest-os/Windows/WinXP/i386.cfg
+++ b/shared/cfg/guest-os/Windows/WinXP/i386.cfg
@@ -50,3 +50,39 @@
                 unattended_file = unattended/winxp32.sif
                 floppies = "fl"
                 floppy_name = images/winXP-32/answer.vfd
+    ## Internal only configuration. Will add to end of upstream file.
+    #
+    only sp3
+    guest_name += -32
+    unattended_install.cdrom, whql.support_vm_install:
+        cdrom_cd1 = isos/ISO/WinXP/32/en_windows_xp_professional_with_service_pack_3_x86_cd_x14-80428.iso
+        # Uncomment virtio_network_installer_path line if
+        # you have an msi installer, also make sure the
+        # paths are properly set in your virtio driver iso.
+        virtio_oemsetup_id = WXP32
+        virtio_network_path = 'A:\i386\WinXP'
+        virtio_network_installer_path = 'E:\\install_driver.bat A:\\i386\\WinXP'
+        virtio_qxl_installer_path = 'E:\\install_driver.bat A:\\i386\\WinXP'
+        virtio_balloon_installer_path = 'E:\\install_driver.bat F:\\Balloon\\xp\\x86'
+    whql.submission:
+        desc_path_desc1 = $\WDK\Logo Type\Device Logo\Windows XP
+        desc_path_desc2 = $\WDK\Logo Type\Systems Logo\Windows XP
+        dd_data_logoarch = X86
+        dd_data_logoos = Windows XP
+        dd_data_whqlos = Windows XP
+        device:
+            dd_data_whqlqual = Basic
+        device.net:
+            image_name_supportvm = winXP-32-supportvm
+    multi_disk, usb_multi_disk:
+        list_volume_command = fsutil fsinfo drives
+    win_virtio_update:
+        images = "image1 stg"
+        drivers_install = "balloon;virtio_blk;nic;virtio_serial"
+        driver_install_cmd_balloon = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\Balloon\xp\x86
+        driver_install_cmd_virtio_blk = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\viostor\xp\x86
+        driver_install_cmd_nic = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\NetKVM\xp\x86
+        driver_install_cmd_virtio_serial = cmd /c WIN_UTILS:\install_driver.bat WIN_VIRTIO:\vioserial\xp\x86
+        kill_rundll = yes
+    live_snapshot_chain.update:
+        post_snapshot_cmd = {shell:cmd /c D:\wua_update.exe && cmd /c net stop wuauserv && cmd /c net start wuauserv && D:\whql\WUInstall.exe /install}
diff --git a/shared/unattended/RHEL-5-series.ks b/shared/unattended/RHEL-5-series.ks
index e3ae7abb..fdf374bc 100644
--- a/shared/unattended/RHEL-5-series.ks
+++ b/shared/unattended/RHEL-5-series.ks
@@ -1,18 +1,18 @@
 install
 KVM_TEST_MEDIUM
-text
+graphical
+poweroff
 lang en_US.UTF-8
 keyboard us
 key --skip
 network --bootproto dhcp
-rootpw 123456
+rootpw kvmautotest
 firewall --enabled --ssh
 selinux --enforcing
-timezone --utc America/New_York
+timezone --utc Asia/Shanghai
 firstboot --disable
 bootloader --location=mbr --append="console=tty0 console=ttyS0,115200"
 zerombr
-xconfig --startxonboot
 #partitioning
 clearpart --all --initlabel
 part /boot --fstype=ext3 --size=500
@@ -20,8 +20,7 @@ part pv.01  --grow --size=1
 volgroup VolGroup --pesize=131072  pv.01
 logvol swap --name=LogVol_swap --vgname=VolGroup --size=4096
 logvol / --fstype=ext4 --name=LogVol_root --vgname=VolGroup --size=1 --grow
-poweroff
-KVM_TEST_LOGGING
+xconfig --startxonboot
 
 %packages
 @base
@@ -33,7 +32,6 @@ KVM_TEST_LOGGING
 xorg-x11-utils
 xorg-x11-server-Xnest
 kexec-tools
-watchdog
 gcc
 patch
 make
@@ -41,20 +39,40 @@ nc
 ntp
 redhat-lsb
 sg3_utils
-lsscsi
-libaio-devel
 NetworkManager
 
 %post
-function ECHO { for TTY in ttyS0 hvc0; do echo "$*" > /dev/$TTY; done }
-ECHO "OS install is completed"
+echo "OS install is completed" > /dev/ttyS0
+echo "remove rhgb quiet by grubby" > /dev/ttyS0
 grubby --remove-args="rhgb quiet" --update-kernel=$(grubby --default-kernel)
+echo "add divider=10 crashkernel=128M@16M by grubby" > /dev/ttyS0
 grubby --args="divider=10 crashkernel=128M@16M" --update-kernel=$(grubby --default-kernel)
+echo "dhclient" > /dev/ttyS0
 dhclient
+echo "get repo" > /dev/ttyS0
+cat > /etc/yum.repos.d/epel.repo << EOF
+[epel]
+name=Extra Packages for Enterprise Linux 5 - \$basearch
+baseurl=http://download.eng.pek2.redhat.com/pub/fedora/epel/5/\$basearch
+enabled=1
+gpgcheck=0
+EOF
+echo "yum install -y stress" > /dev/ttyS0
+yum install -y stress
+echo "yum install -y scsi-target-utils" > /dev/ttyS0
+yum install -y scsi-target-utils
+echo "chkconfig sshd on" > /dev/ttyS0
 chkconfig sshd on
+echo "chkconfig NetworkManager on" > /dev/ttyS0
 chkconfig NetworkManager on
+echo "iptables -F" > /dev/ttyS0
 iptables -F
+echo "echo 0 > selinux/enforce" > /dev/ttyS0
 echo 0 > /selinux/enforce
-sed -i "/^HWADDR/d" /etc/sysconfig/network-scripts/ifcfg-eth0
-ECHO 'Post set up finished'
+echo "update ifcfg-*" > /dev/ttyS0
+sed -i "/^HWADDR/d" /etc/sysconfig/network-scripts/ifcfg-*
+sed -i "/UUID/d" /etc/sysconfig/network-scripts/ifcfg-*
+echo "ifconfig -a | tee /dev/ttyS0" >> /etc/rc.local
+echo 'Post set up finished' > /dev/ttyS0
+echo Post set up finished > /dev/hvc0
 %end
diff --git a/shared/unattended/RHEL-6-perf-series.ks b/shared/unattended/RHEL-6-perf-series.ks
index 8c45046f..ba09006d 100644
--- a/shared/unattended/RHEL-6-perf-series.ks
+++ b/shared/unattended/RHEL-6-perf-series.ks
@@ -6,7 +6,7 @@ lang en_US.UTF-8
 keyboard us
 key --skip
 network --bootproto dhcp
-rootpw 123456
+rootpw kvmautotest
 firewall --enabled --ssh
 selinux --enforcing
 timezone --utc Asia/Shanghai
@@ -15,13 +15,9 @@ bootloader --location=mbr --append="console=tty0 console=ttyS0,115200 elevator=d
 zerombr
 #partitioning
 clearpart --all --initlabel
-part /boot --fstype=ext3 --size=500
-part pv.01  --grow --size=1
-volgroup VolGroup --pesize=131072  pv.01
-logvol swap --name=LogVol_swap --vgname=VolGroup --size=4096
-logvol / --fstype=ext4 --name=LogVol_root --vgname=VolGroup --size=1 --grow
+autopart
 
-%packages
+%packages --ignoremissing
 @base
 @core
 @development
@@ -43,6 +39,7 @@ telnet
 portmap
 net-snmp
 mkisofs
+libaio-devel
 
 %post
 echo "OS install is completed" > /dev/ttyS0
@@ -51,7 +48,13 @@ grubby --remove-args="rhgb quiet" --update-kernel=$(grubby --default-kernel)
 echo "dhclient" > /dev/ttyS0
 dhclient
 echo "get repo" > /dev/ttyS0
-rpm -ivh https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm
+cat > /etc/yum.repos.d/epel.repo << EOF
+[epel]
+name=Extra Packages for Enterprise Linux 6 - \$basearch
+baseurl=http://download.eng.pek2.redhat.com/pub/fedora/epel/6/\$basearch
+enabled=1
+gpgcheck=0
+EOF
 echo "yum makecache" > /dev/ttyS0
 yum makecache
 echo "yum install -y stress" > /dev/ttyS0
diff --git a/shared/unattended/RHEL-6-ppc-series.ks b/shared/unattended/RHEL-6-ppc-series.ks
index ba4df54d..ce822015 100644
--- a/shared/unattended/RHEL-6-ppc-series.ks
+++ b/shared/unattended/RHEL-6-ppc-series.ks
@@ -6,7 +6,7 @@ lang en_US.UTF-8
 keyboard us
 key --skip
 network --bootproto dhcp
-rootpw 123456
+rootpw kvmautotest
 firewall --enabled --ssh
 selinux --enforcing
 timezone --utc Asia/Shanghai
@@ -58,7 +58,14 @@ grubby --remove-args="rhgb quiet" --update-kernel=$(grubby --default-kernel)
 echo "dhclient" > /dev/hvc0
 dhclient
 echo "get repo" > /dev/ttyS0
-rpm -ivh https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm
+cat > /etc/yum.repos.d/epel.repo << EOF
+[epel]
+name=Extra Packages for Enterprise Linux 6 - \$basearch
+baseurl=http://download.eng.pek2.redhat.com/pub/fedora/epel/6/\$basearch
+enabled=1
+gpgcheck=0
+skip_if_unavailable=1
+EOF
 echo "yum makecache" > /dev/hvc0
 yum makecache
 echo "yum install -y stress" > /dev/hvc0
diff --git a/shared/unattended/RHEL-6-series.ks b/shared/unattended/RHEL-6-series.ks
index cdfebe90..81d16a88 100644
--- a/shared/unattended/RHEL-6-series.ks
+++ b/shared/unattended/RHEL-6-series.ks
@@ -1,18 +1,18 @@
 install
 KVM_TEST_MEDIUM
-text
+graphical
+poweroff
 lang en_US.UTF-8
 keyboard us
 key --skip
 network --bootproto dhcp
-rootpw 123456
+rootpw kvmautotest
 firewall --enabled --ssh
 selinux --enforcing
-timezone --utc America/New_York
+timezone --utc Asia/Shanghai
 firstboot --disable
 bootloader --location=mbr --append="console=tty0 console=ttyS0,115200"
 zerombr
-xconfig --startxonboot
 #partitioning
 clearpart --all --initlabel
 part /boot --fstype=ext4 --size=500
@@ -20,8 +20,7 @@ part pv.01  --grow --size=1
 volgroup VolGroup --pesize=131072  pv.01
 logvol swap --name=LogVol_swap --vgname=VolGroup --size=4096
 logvol / --fstype=ext4 --name=LogVol_root --vgname=VolGroup --size=1 --grow
-poweroff
-KVM_TEST_LOGGING
+xconfig --startxonboot
 
 %packages --ignoremissing
 @base
@@ -37,42 +36,55 @@ KVM_TEST_LOGGING
 @graphical-admin-tools
 @x11
 lftp
+ftp
+vsftpd
 gcc
 gcc-c++
 patch
 make
 git
 nc
-net-tools
 NetworkManager
 ntpdate
 redhat-lsb
-watchdog
-coreutils
-libblkid-devel
-koji
-usbutils
 qemu-guest-agent
 sg3_utils
-xfsprogs
-lsscsi
 libaio-devel
+lsscsi
 perl-Time-HiRes
-glibc-devel
-glibc-static
+flex
 scsi-target-utils
+telnet
+telnet-server
+xinetd
+httpd
 
 %post
-function ECHO { for TTY in ttyS0 hvc0; do echo "$*" > /dev/$TTY; done }
-ECHO "OS install is completed"
+ln -sf /dev/null /etc/udev/rules.d/70-persistent-net.rules
+echo "OS install is completed" > /dev/ttyS0
+echo "remove rhgb quiet by grubby" > /dev/ttyS0
 grubby --remove-args="rhgb quiet" --update-kernel=$(grubby --default-kernel)
+echo "dhclient" > /dev/ttyS0
 dhclient
+echo "get repo" > /dev/ttyS0
+yum install -y 'https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm'
+sed -i '/enabled=1/askip_if_unavailable=1' /etc/yum.repos.d/*.repo
+echo "yum makecache" > /dev/ttyS0
+yum makecache
+echo "yum install -y stress" > /dev/ttyS0
+yum install -y stress
+echo "chkconfig sshd on" > /dev/ttyS0
 chkconfig sshd on
+echo "iptables -F" > /dev/ttyS0
 iptables -F
+echo "echo 0 > selinux/enforce" > /dev/ttyS0
 echo 0 > /selinux/enforce
+echo "chkconfig NetworkManager on" > /dev/ttyS0
 chkconfig NetworkManager on
+echo "update ifcfg-*" > /dev/ttyS0
 sed -i "/^HWADDR/d" /etc/sysconfig/network-scripts/ifcfg-*
-ECHO "Remove 70-persistent-net.rules (prevent network device rename)"
-rm -f /etc/udev/rules.d/70-persistent-net.rules
-ECHO 'Post set up finished'
+sed -i "/UUID/d" /etc/sysconfig/network-scripts/ifcfg-*
+echo "ifconfig -a | tee /dev/ttyS0" >> /etc/rc.local
+echo 'Post set up finished' > /dev/ttyS0
+echo Post set up finished > /dev/hvc0
 %end
diff --git a/shared/unattended/RHEL-7-series.ks b/shared/unattended/RHEL-7-series.ks
index e9572e0b..215e8b73 100644
--- a/shared/unattended/RHEL-7-series.ks
+++ b/shared/unattended/RHEL-7-series.ks
@@ -1,39 +1,43 @@
 install
 KVM_TEST_MEDIUM
-text
+KVM_TEST_REPOS
+graphical
 poweroff
 lang en_US.UTF-8
 keyboard us
 network --onboot yes --device eth0 --bootproto dhcp
-rootpw --plaintext 123456
+rootpw kvmautotest
 firewall --enabled --ssh
 selinux --enforcing
-timezone --utc America/New_York
+timezone --utc Asia/Shanghai
 firstboot --disable
 bootloader --location=mbr --append="console=tty0 console=ttyS0,115200"
 zerombr
 clearpart --all --initlabel
 autopart
 xconfig --startxonboot
+services --enable rc-local
 
 %packages --ignoremissing
 @base
 @core
 @development
-@additional-devel
 @debugging-tools
 @network-tools
 @fonts
 @x11
 @gnome-desktop
 lftp
+ftp
+vsftpd
 gcc
 gcc-c++
+glibc-devel
+glibc-static
 patch
 make
 git
 nc
-net-tools
 NetworkManager
 ntpdate
 redhat-lsb
@@ -44,31 +48,85 @@ hdparm
 lsscsi
 libaio-devel
 perl-Time-HiRes
+python-devel
 flex
 prelink
+qemu-guest-agent
+dracut-config-generic
+iptables-services
+-abrt*
+-gnome-initial-setup
+-gnome-boxes
+scsi-target-utils
+xfsprogs-devel
+-strace32
+popt-devel
+ntp
+telnet
+telnet-server
+xinetd
+httpd
+pesign
 %end
 
 %post
-# Output to all consoles defined in /proc/consoles, use "major:minor" as
-# device names are unreliable on some platforms
-# https://bugzilla.redhat.com/show_bug.cgi?id=1351968
-function ECHO { for TTY in `cat /proc/consoles | awk '{print $NF}'`; do source "/sys/dev/char/$TTY/uevent" && echo "$*" > /dev/$DEVNAME; done }
-ECHO "OS install is completed"
-ECHO "remove rhgb quiet by grubby"
+echo "OS install is completed" > /dev/ttyS0
+echo "enable autologin" > /dev/ttyS0
+sed -i '/daemon/ a \AutomaticLoginEnable=true\n\AutomaticLogin=root' /etc/gdm/custom.conf
+echo "remove rhgb quiet by grubby" > /dev/ttyS0
 grubby --remove-args="rhgb quiet" --update-kernel=$(grubby --default-kernel)
-ECHO "dhclient"
+grubby --args="biosdevname=0 net.ifnames=0" --update-kernel=$(grubby --default-kernel)
+echo "dhclient" > /dev/ttyS0
 dhclient
-ECHO "chkconfig sshd on"
+echo "get repo" > /dev/ttyS0
+cat > /etc/yum.repos.d/epel.repo << EOF
+[epel]
+name=Extra Packages for Enterprise Linux 7 - \$basearch
+baseurl=http://download.eng.pek2.redhat.com/pub/fedora/epel/7/\$basearch
+enabled=1
+gpgcheck=0
+skip_if_unavailable=1
+EOF
+echo "distroverpkg=redhat-release-server" >> /etc/yum.conf
+cat > /etc/yum.repos.d/rhel.repo << EOF
+[RHEL\$releasever]
+name=Red Hat Enterprise Linux \$releasever - \$basearch
+baseurl=http://download.eng.pek2.redhat.com/released/rhel-6-7-8/rhel-7/RHEL-7/\$releasever/Server/\$basearch/os
+enabled=1
+gpgcheck=0
+skip_if_unavailable=1
+
+[RHEL\$releasever-optional]
+name=Red Hat Enterprise Linux \$releasever - \$basearch Optional
+baseurl=http://download.eng.pek2.redhat.com/released/rhel-6-7-8/rhel-7/RHEL-7/\$releasever/Server-optional/\$basearch/os
+enabled=1
+gpgcheck=0
+skip_if_unavailable=1
+EOF
+echo "yum makecache" > /dev/ttyS0
+yum makecache
+echo "yum install -y stress" > /dev/ttyS0
+yum install -y stress
+echo "chkconfig sshd on" > /dev/ttyS0
 chkconfig sshd on
-ECHO "iptables -F"
+echo "chkconfig iptables on" > /dev/ttyS0
+chkconfig iptables on
+echo "iptables -F" > /dev/ttyS0
 iptables -F
-ECHO "echo 0 > selinux/enforce"
+echo "echo 0 > selinux/enforce" > /dev/ttyS0
 echo 0 > /selinux/enforce
-ECHO "chkconfig NetworkManager on"
+echo "chkconfig NetworkManager on" > /dev/ttyS0
 chkconfig NetworkManager on
-ECHO "update ifcfg-eth0"
-sed -i "/^HWADDR/d" /etc/sysconfig/network-scripts/ifcfg-eth0
-ECHO "Disable lock cdrom udev rules"
+echo "update ifcfg-*" > /dev/ttyS0
+sed -i "/^HWADDR/d" /etc/sysconfig/network-scripts/ifcfg-*
+sed -i "/UUID/d" /etc/sysconfig/network-scripts/ifcfg-*
+sed -i "s/^/#/g" /usr/lib/udev/rules.d/80-net-name-slot.rules
+echo "Disable lock cdrom udev rules" > /dev/ttyS0
 sed -i "/--lock-media/s/^/#/" /usr/lib/udev/rules.d/60-cdrom_id.rules 2>/dev/null>&1
-ECHO 'Post set up finished'
+echo "ifconfig -a | tee /dev/ttyS0" >> /etc/rc.local
+echo "iptables -F">> /etc/rc.local
+chmod +x /etc/rc.local
+ln -sf /etc/rc.local /etc/rc.d/rc.local
+echo 'Post set up finished' > /dev/ttyS0
+echo Post set up finished > /dev/hvc0
 %end
diff --git a/shared/unattended/win10-32-autounattend.xml b/shared/unattended/win10-32-autounattend.xml
index a1d45b0d..6261adc0 100644
--- a/shared/unattended/win10-32-autounattend.xml
+++ b/shared/unattended/win10-32-autounattend.xml
@@ -21,15 +21,30 @@
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
 			<DriverPaths>
-				<PathAndCredentials wcm:keyValue="1" wcm:action="add">
-					<Path>KVM_TEST_SCSI_DRIVER_PATH</Path>
-				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="1" wcm:action="add">
+                                        <Path>KVM_TEST_SCSI_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 				<PathAndCredentials wcm:keyValue="2" wcm:action="add">
 					<Path>KVM_TEST_STORAGE_DRIVER_PATH</Path>
 				</PathAndCredentials>
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -37,41 +52,63 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
-				<WillShowUI>OnError</WillShowUI>
-				<Disk wcm:action="add">
-					<CreatePartitions>
-						<CreatePartition wcm:action="add">
-							<Order>1</Order>
-							<Size>30000</Size>
-							<Type>Primary</Type>
-						</CreatePartition>
-					</CreatePartitions>
-					<ModifyPartitions>
-						<ModifyPartition wcm:action="add">
-							<Active>true</Active>
-							<Extend>false</Extend>
-							<Format>NTFS</Format>
-							<Label>OS_Install</Label>
-							<Letter>C</Letter>
-							<Order>1</Order>
-							<PartitionID>1</PartitionID>
-						</ModifyPartition>
-					</ModifyPartitions>
-					<DiskID>0</DiskID>
-					<WillWipeDisk>true</WillWipeDisk>
-				</Disk>
-			</DiskConfiguration>
+                        <DiskConfiguration>
+                                <WillShowUI>OnError</WillShowUI>
+                                <Disk wcm:action="add">
+                                        <CreatePartitions>
+                                                <CreatePartition wcm:action="add">
+                                                        <Order>1</Order>
+                                                        <Size>300</Size>
+                                                        <Type>Primary</Type>
+                                                </CreatePartition>
+                                                <CreatePartition wcm:action="add">
+                                                        <Order>2</Order>
+                                                        <Extend>true</Extend>
+                                                        <Type>Primary</Type>
+                                                </CreatePartition>
+                                        </CreatePartitions>
+                                        <ModifyPartitions>
+                                                <!-- System partition -->
+                                                <ModifyPartition wcm:action="add">
+                                                        <Order>1</Order>
+                                                        <PartitionID>1</PartitionID>
+                                                        <Label>System</Label>
+                                                        <Letter>S</Letter>
+                                                        <Format>NTFS</Format>
+                                                        <Active>true</Active>
+                                                </ModifyPartition>
+                                                <!-- Windows partition -->
+                                                <ModifyPartition wcm:action="add">
+                                                        <Order>2</Order>
+                                                        <PartitionID>2</PartitionID>
+                                                        <Label>Windows</Label>
+                                                        <Letter>C</Letter>
+                                                        <Format>NTFS</Format>
+                                                </ModifyPartition>
+                                        </ModifyPartitions>
+                                        <DiskID>0</DiskID>
+                                        <WillWipeDisk>true</WillWipeDisk>
+                                </Disk>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
-					<InstallTo>
-						<DiskID>0</DiskID>
-						<PartitionID>1</PartitionID>
-					</InstallTo>
+					<InstallFrom>
+						<MetaData wcm:action="add">
+							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
+							<Value>Windows 10 Enterprise</Value>
+						</MetaData>
+					</InstallFrom>
+                                        <InstallTo>
+                                                <DiskID>0</DiskID>
+                                                <PartitionID>2</PartitionID>
+                                        </InstallTo>
 				</OSImage>
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -115,9 +152,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+			<TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -130,86 +169,154 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <!-- Disable console quickedit mode to prevent stuck of command executions -->
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Console" /v QuickEdit /t REG_DWORD /d 0 /f</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>11</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\NewNetworks" /v NetworkList /t REG_MULTI_SZ /d "" /f</CommandLine>
-					<Order>2</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>3</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat.cer</CommandLine>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>5</Order>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>6</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>8</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>9</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>10</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>11</Order>
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>12</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>15</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-				        <CommandLine>%WINDIR%\System32\Dism /online /enable-feature /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess</CommandLine>
-				        <Order>16</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log -->
+					<Order>23</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>17</Order>
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_32.bat</CommandLine>
-					<Order>18</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>19</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /All /LimitAccess /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>26</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\StartPage /v OpenAtLogon /t REG_DWORD /d 0 /f</CommandLine>
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>28</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>29</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>30</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>31</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>32</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>33</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/win10-64-autounattend.xml b/shared/unattended/win10-64-autounattend.xml
index 93f298b2..f14944f5 100644
--- a/shared/unattended/win10-64-autounattend.xml
+++ b/shared/unattended/win10-64-autounattend.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -37,41 +52,63 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
+                        <DiskConfiguration>
 				<WillShowUI>OnError</WillShowUI>
 				<Disk wcm:action="add">
 					<CreatePartitions>
-						<CreatePartition wcm:action="add">
-							<Order>1</Order>
-							<Size>30000</Size>
-							<Type>Primary</Type>
-						</CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>1</Order>
+					                <Size>300</Size>
+					                <Type>Primary</Type>
+					        </CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>2</Order>
+					                <Extend>true</Extend>
+					                <Type>Primary</Type>
+					        </CreatePartition>
 					</CreatePartitions>
 					<ModifyPartitions>
-						<ModifyPartition wcm:action="add">
-							<Active>true</Active>
-							<Extend>false</Extend>
-							<Format>NTFS</Format>
-							<Label>OS_Install</Label>
-							<Letter>C</Letter>
-							<Order>1</Order>
-							<PartitionID>1</PartitionID>
-						</ModifyPartition>
+					        <!-- System partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>1</Order>
+					                <PartitionID>1</PartitionID>
+					                <Label>System</Label>
+					                <Letter>S</Letter>
+					                <Format>NTFS</Format>
+					                <Active>true</Active>
+					        </ModifyPartition>
+					        <!-- Windows partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>2</Order>
+					                <PartitionID>2</PartitionID>
+					                <Label>Windows</Label>
+					                <Letter>C</Letter>
+					                <Format>NTFS</Format>
+					        </ModifyPartition>
 					</ModifyPartitions>
 					<DiskID>0</DiskID>
 					<WillWipeDisk>true</WillWipeDisk>
 				</Disk>
-			</DiskConfiguration>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
+					<InstallFrom>
+						<MetaData wcm:action="add">
+							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
+							<Value>Windows 10 Enterprise</Value>
+						</MetaData>
+					</InstallFrom>
 					<InstallTo>
-						<DiskID>0</DiskID>
-						<PartitionID>1</PartitionID>
+					        <DiskID>0</DiskID>
+					        <PartitionID>2</PartitionID>
 					</InstallTo>
 				</OSImage>
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -115,9 +152,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -130,82 +169,154 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <!-- Disable console quickedit mode to prevent stuck of command executions -->
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Console" /v QuickEdit /t REG_DWORD /d 0 /f</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>11</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\NewNetworks" /v NetworkList /t REG_MULTI_SZ /d "" /f</CommandLine>
-					<Order>2</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>3</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat.cer</CommandLine>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>5</Order>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>6</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>8</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>9</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>10</Order>
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>11</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>12</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>14</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\Dism /online /enable-feature /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess</CommandLine>
-					<Order>15</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log -->
+					<Order>23</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>16</Order>
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>17</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>18</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /All /LimitAccess /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>26</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\StartPage /v OpenAtLogon /t REG_DWORD /d 0 /f</CommandLine>
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>28</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>29</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>30</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>31</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>32</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>33</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/win10-64-autounattend_ovmf.xml b/shared/unattended/win10-64-autounattend_ovmf.xml
index e997b13f..09a9030d 100644
--- a/shared/unattended/win10-64-autounattend_ovmf.xml
+++ b/shared/unattended/win10-64-autounattend_ovmf.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -37,53 +52,61 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
+                        <DiskConfiguration>
 				<WillShowUI>OnError</WillShowUI>
-                                <Disk wcm:action="add">
-                                        <CreatePartitions>
-                                                <!-- EFI system partition (ESP) -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>1</Order>
-                                                  <Type>EFI</Type>
-                                                  <Size>100</Size>
-                                                </CreatePartition>
-                                                <!-- Microsoft reserved partition (MSR) -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>2</Order>
-                                                  <Type>MSR</Type>
-                                                  <Size>128</Size>
-                                                </CreatePartition>
-                                                <!-- Windows partition -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>3</Order>
-                                                  <Type>Primary</Type>
-                                                  <Extend>true</Extend>
-                                                </CreatePartition>
-                                        </CreatePartitions>
-                                        <ModifyPartitions>
-                                                <!-- EFI system partition (ESP) -->
-                                                <ModifyPartition wcm:action="add">
-                                                  <Order>1</Order>
-                                                  <PartitionID>1</PartitionID>
-                                                  <Label>System</Label>
-                                                  <Format>FAT32</Format>
-                                                </ModifyPartition>
-                                                <!-- MSR partition does not need to be modified -->
-                                                <!-- Windows partition -->
-                                                <ModifyPartition wcm:action="add">
-                                                  <Order>2</Order>
-                                                  <PartitionID>3</PartitionID>
-                                                  <Label>Windows</Label>
-                                                  <Letter>C</Letter>
-                                                  <Format>NTFS</Format>
-                                                </ModifyPartition>
-                                        </ModifyPartitions>
-                                        <DiskID>0</DiskID>
-                                        <WillWipeDisk>true</WillWipeDisk>
-                                </Disk>
-			</DiskConfiguration>
+				<Disk wcm:action="add">
+					<CreatePartitions>
+					        <!-- EFI system partition (ESP) -->
+					        <CreatePartition wcm:action="add">
+					          <Order>1</Order>
+					          <Type>EFI</Type>
+					          <Size>260</Size>
+					        </CreatePartition>
+					        <!-- Microsoft reserved partition (MSR) -->
+					        <CreatePartition wcm:action="add">
+					          <Order>2</Order>
+					          <Type>MSR</Type>
+					          <Size>128</Size>
+					        </CreatePartition>
+					        <!-- Windows partition -->
+					        <CreatePartition wcm:action="add">
+					          <Order>3</Order>
+					          <Type>Primary</Type>
+					          <Extend>true</Extend>
+					        </CreatePartition>
+					</CreatePartitions>
+					<ModifyPartitions>
+					        <!-- EFI system partition (ESP) -->
+					        <ModifyPartition wcm:action="add">
+					          <Order>1</Order>
+					          <PartitionID>1</PartitionID>
+					          <Label>System</Label>
+					          <Format>FAT32</Format>
+					        </ModifyPartition>
+					        <!-- MSR partition does not need to be modified -->
+					        <!-- Windows partition -->
+					        <ModifyPartition wcm:action="add">
+					          <Order>2</Order>
+					          <PartitionID>3</PartitionID>
+					          <Label>Windows</Label>
+					          <Letter>C</Letter>
+					          <Format>NTFS</Format>
+					        </ModifyPartition>
+					</ModifyPartitions>
+					<DiskID>0</DiskID>
+					<WillWipeDisk>true</WillWipeDisk>
+				</Disk>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
+					<InstallFrom>
+						<MetaData wcm:action="add">
+							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
+							<Value>Windows 10 Enterprise</Value>
+						</MetaData>
+					</InstallFrom>
 					<InstallTo>
 						<DiskID>0</DiskID>
 						<PartitionID>3</PartitionID>
@@ -92,6 +115,7 @@
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -135,9 +159,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -150,82 +176,154 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <!-- Disable console quickedit mode to prevent stuck of command executions -->
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Console" /v QuickEdit /t REG_DWORD /d 0 /f</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>11</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\NewNetworks" /v NetworkList /t REG_MULTI_SZ /d "" /f</CommandLine>
-					<Order>2</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>3</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat.cer</CommandLine>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>5</Order>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>6</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>8</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>9</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>10</Order>
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>11</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>12</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>14</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\Dism /online /enable-feature /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess</CommandLine>
-					<Order>15</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log -->
+					<Order>23</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>16</Order>
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>17</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>18</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /All /LimitAccess /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>26</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\StartPage /v OpenAtLogon /t REG_DWORD /d 0 /f</CommandLine>
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>28</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>29</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>30</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>31</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>32</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>33</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/win2003-32.sif b/shared/unattended/win2003-32.sif
index c19e3228..d70f0e85 100644
--- a/shared/unattended/win2003-32.sif
+++ b/shared/unattended/win2003-32.sif
@@ -19,7 +19,7 @@ AdminPassword = "1q2w3eP"
 AutoLogon = Yes
 AutoLogonCount = 1000
 OEMSkipRegional = 1
-TimeZone = 85
+TimeZone = 210
 OemSkipWelcome = 1
 
 [UserData]
diff --git a/shared/unattended/win2003-64.sif b/shared/unattended/win2003-64.sif
index d64ab216..024ebbd1 100644
--- a/shared/unattended/win2003-64.sif
+++ b/shared/unattended/win2003-64.sif
@@ -19,7 +19,7 @@ AdminPassword = "1q2w3eP"
 AutoLogon = Yes
 AutoLogonCount = 1000
 OEMSkipRegional = 1
-TimeZone = 85
+TimeZone = 210
 OemSkipWelcome = 1
 
 [UserData]
diff --git a/shared/unattended/win2008-32-autounattend.xml b/shared/unattended/win2008-32-autounattend.xml
index 0a07c1c9..2b24aa14 100644
--- a/shared/unattended/win2008-32-autounattend.xml
+++ b/shared/unattended/win2008-32-autounattend.xml
@@ -1,93 +1,105 @@
 <?xml version="1.0" encoding="utf-8"?>
 <unattend xmlns="urn:schemas-microsoft-com:unattend">
 	<settings pass="windowsPE">
+		<component name="Microsoft-Windows-International-Core-WinPE"
+			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
+			language="neutral" versionScope="nonSxS"
+			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
+			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+			<SetupUILanguage>
+				<UILanguage>en-us</UILanguage>
+			</SetupUILanguage>
+			<InputLocale>0409:00000409</InputLocale>
+			<SystemLocale>en-us</SystemLocale>
+			<UILanguage>en-us</UILanguage>
+			<UILanguageFallback>en-us</UILanguageFallback>
+			<UserLocale>en-us</UserLocale>
+		</component>
+		<component name="Microsoft-Windows-PnpCustomizationsWinPE"
+			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
+			language="neutral" versionScope="nonSxS"
+			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
+			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+			<DriverPaths>
+				<PathAndCredentials wcm:keyValue="1" wcm:action="add">
+					<Path>KVM_TEST_SCSI_DRIVER_PATH</Path>
+				</PathAndCredentials>
+				<PathAndCredentials wcm:keyValue="2" wcm:action="add">
+					<Path>KVM_TEST_STORAGE_DRIVER_PATH</Path>
+				</PathAndCredentials>
+				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
+					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
+				</PathAndCredentials>
+			</DriverPaths>
+		</component>
 		<component name="Microsoft-Windows-Setup"
 			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
+                        <DiskConfiguration>
 				<WillShowUI>OnError</WillShowUI>
 				<Disk wcm:action="add">
 					<CreatePartitions>
-						<CreatePartition wcm:action="add">
-							<Order>1</Order>
-							<Size>30000</Size>
-							<Type>Primary</Type>
-						</CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>1</Order>
+					                <Size>300</Size>
+					                <Type>Primary</Type>
+					        </CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>2</Order>
+					                <Extend>true</Extend>
+					                <Type>Primary</Type>
+					        </CreatePartition>
 					</CreatePartitions>
 					<ModifyPartitions>
-						<ModifyPartition wcm:action="add">
-							<Active>true</Active>
-							<Extend>false</Extend>
-							<Format>NTFS</Format>
-							<Label>OS_Install</Label>
-							<Letter>C</Letter>
-							<Order>1</Order>
-							<PartitionID>1</PartitionID>
-						</ModifyPartition>
+					        <!-- System partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>1</Order>
+					                <PartitionID>1</PartitionID>
+					                <Label>System</Label>
+					                <Letter>S</Letter>
+					                <Format>NTFS</Format>
+					                <Active>true</Active>
+					        </ModifyPartition>
+					        <!-- Windows partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>2</Order>
+					                <PartitionID>2</PartitionID>
+					                <Label>Windows</Label>
+					                <Letter>C</Letter>
+					                <Format>NTFS</Format>
+					        </ModifyPartition>
 					</ModifyPartitions>
 					<DiskID>0</DiskID>
 					<WillWipeDisk>true</WillWipeDisk>
 				</Disk>
-			</DiskConfiguration>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
 					<InstallFrom>
 						<MetaData wcm:action="add">
-							<Key>/IMAGE/INDEX</Key>
-                                                        <!--This index depends on your install ISO. Please update to a proper one if install failed.-->
-							<Value>3</Value>
+							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
+							<Value>Windows Longhorn SERVERDATACENTER</Value>
 						</MetaData>
 					</InstallFrom>
 					<InstallTo>
-						<DiskID>0</DiskID>
-						<PartitionID>1</PartitionID>
+					        <DiskID>0</DiskID>
+					        <PartitionID>2</PartitionID>
 					</InstallTo>
-					<WillShowUI>OnError</WillShowUI>
 				</OSImage>
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
 				<AcceptEula>true</AcceptEula>
-				<FullName>Autotest Mindless Drone</FullName>
-				<Organization>Autotest</Organization>
 			</UserData>
 		</component>
-		<component name="Microsoft-Windows-International-Core-WinPE"
-			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<SetupUILanguage>
-				<UILanguage>en-us</UILanguage>
-			</SetupUILanguage>
-			<InputLocale>0409:00000409</InputLocale>
-			<SystemLocale>en-us</SystemLocale>
-			<UILanguage>en-us</UILanguage>
-			<UserLocale>en-us</UserLocale>
-			<UILanguageFallback>en-us</UILanguageFallback>
-		</component>
-		<component name="Microsoft-Windows-PnpCustomizationsWinPE"
-			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DriverPaths>
-				<PathAndCredentials wcm:keyValue="1" wcm:action="add">
-					<Path>KVM_TEST_SCSI_DRIVER_PATH</Path>
-				</PathAndCredentials>
-				<PathAndCredentials wcm:keyValue="2" wcm:action="add">
-					<Path>KVM_TEST_STORAGE_DRIVER_PATH</Path>
-				</PathAndCredentials>
-				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
-					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
-				</PathAndCredentials>
-			</DriverPaths>
-		</component>
 	</settings>
 	<settings pass="specialize">
 		<component name="Microsoft-Windows-Deployment"
@@ -106,16 +118,6 @@
 					<Order>2</Order>
 					<Path>cmd /c reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v FilterAdministratorToken /t REG_DWORD /d 0 /f</Path>
 				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>3</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>4</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
 			</RunSynchronous>
 		</component>
 		<component name="Microsoft-Windows-International-Core"
@@ -135,112 +137,218 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
+			<OOBE>
+				<HideEULAPage>true</HideEULAPage>
+				<NetworkLocation>Work</NetworkLocation>
+				<ProtectYourPC>1</ProtectYourPC>
+				<SkipUserOOBE>true</SkipUserOOBE>
+				<SkipMachineOOBE>true</SkipMachineOOBE>
+			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
-				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c xcopy E:\Windows2008-KB970158-x86.cab C:\Windows\SoftwareDistribution\Download\</CommandLine>
+                                        <Order>11</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c start /w pkgmgr /ip /m:C:\Windows\SoftwareDistribution\Download\Windows2008-KB970158-x86.cab /quiet</CommandLine>
+                                        <Order>12</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c start /w pkgmgr /iu:"TelnetServer"</CommandLine>
-					<Order>3</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>9</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe E:\git\git.au3</CommandLine>
-					<Order>10</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>11</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>12</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
+					<Order>22</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f root E:\root.cer</CommandLine>
+                                        <Order>23</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f CA E:\CA-1.cer</CommandLine>
+                                        <Order>24</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat_win7.cer</CommandLine>
+                                        <Order>25</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>14</Order>
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c OCSetup.exe NetFx3 /quiet /norestart /log:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log. dism is not supported on this OS, use ocsetup instead -->
+					<Order>28</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>15</Order>
+					<Order>29</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_32.bat</CommandLine>
-					<Order>16</Order>
+					<Order>30</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>17</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c OCSetup.exe MicrosoftWindowsPowerShell /quiet /norestart /log:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log. dism is not supported on this OS, use ocsetup instead -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>31</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</CommandLine>
+					<Order>32</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- these two registry update makes ahci bootable, NT6.0 or NT6.1 needs http://support.microsoft.com/kb/922976 -->
+					<Order>33</Order>
 				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>34</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>35</Order>
+				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows6.0-kb4056759-x86.msu /quiet /norestart</CommandLine>
+                                        <Order>36</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>37</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>38</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c pnputil -i -a F:\pvpanic\2k8\x86\pvpanic.inf</CommandLine>
+                                        <Order>39</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c pnputil -i -a F:\Balloon\2k8\x86\balloon.inf</CommandLine>
+                                        <Order>40</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c pnputil -i -a F:\vioserial\2k8\x86\vioser.inf</CommandLine>
+                                        <Order>41</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c pnputil -i -a F:\viorng\2k8\x86\viorng.inf</CommandLine>
+                                        <Order>42</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>43</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>44</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
-			<OOBE>
-				<HideEULAPage>true</HideEULAPage>
-				<NetworkLocation>Work</NetworkLocation>
-				<ProtectYourPC>1</ProtectYourPC>
-				<SkipUserOOBE>true</SkipUserOOBE>
-				<SkipMachineOOBE>true</SkipMachineOOBE>
-			</OOBE>
-		</component>
-		<component name="Microsoft-Windows-International-Core"
-			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<InputLocale>0409:00000409</InputLocale>
-			<SystemLocale>en-us</SystemLocale>
-			<UILanguage>en-us</UILanguage>
-			<UILanguageFallback>en-us</UILanguageFallback>
-			<UserLocale>en-us</UserLocale>
 		</component>
 	</settings>
-	<cpi:offlineImage
-		cpi:source="wim:d:/os/win2k8/i386/sources/install.wim#Windows Longhorn SERVERSTANDARD"
+	<cpi:offlineImage cpi:source="wim:c:/install.wim#Windows Longhorn SERVERSTANDARD"
 		xmlns:cpi="urn:schemas-microsoft-com:cpi" />
 </unattend>
diff --git a/shared/unattended/win2008-64-autounattend.xml b/shared/unattended/win2008-64-autounattend.xml
index 302baec9..3df1e50f 100644
--- a/shared/unattended/win2008-64-autounattend.xml
+++ b/shared/unattended/win2008-64-autounattend.xml
@@ -1,97 +1,109 @@
 <?xml version="1.0" encoding="utf-8"?>
 <unattend xmlns="urn:schemas-microsoft-com:unattend">
 	<settings pass="windowsPE">
+		<component name="Microsoft-Windows-International-Core-WinPE"
+			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
+			language="neutral" versionScope="nonSxS"
+			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
+			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+			<SetupUILanguage>
+				<UILanguage>en-us</UILanguage>
+			</SetupUILanguage>
+			<InputLocale>0409:00000409</InputLocale>
+			<SystemLocale>en-us</SystemLocale>
+			<UILanguage>en-us</UILanguage>
+			<UILanguageFallback>en-us</UILanguageFallback>
+			<UserLocale>en-us</UserLocale>
+		</component>
+		<component name="Microsoft-Windows-PnpCustomizationsWinPE"
+			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
+			language="neutral" versionScope="nonSxS"
+			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
+			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+			<DriverPaths>
+				<PathAndCredentials wcm:keyValue="1" wcm:action="add">
+					<Path>KVM_TEST_SCSI_DRIVER_PATH</Path>
+				</PathAndCredentials>
+				<PathAndCredentials wcm:keyValue="2" wcm:action="add">
+					<Path>KVM_TEST_STORAGE_DRIVER_PATH</Path>
+				</PathAndCredentials>
+				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
+					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
+				</PathAndCredentials>
+			</DriverPaths>
+		</component>
 		<component name="Microsoft-Windows-Setup"
 			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
+                        <DiskConfiguration>
 				<WillShowUI>OnError</WillShowUI>
 				<Disk wcm:action="add">
 					<CreatePartitions>
-						<CreatePartition wcm:action="add">
-							<Order>1</Order>
-							<Size>30000</Size>
-							<Type>Primary</Type>
-						</CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>1</Order>
+					                <Size>300</Size>
+					                <Type>Primary</Type>
+					        </CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>2</Order>
+					                <Extend>true</Extend>
+					                <Type>Primary</Type>
+					        </CreatePartition>
 					</CreatePartitions>
 					<ModifyPartitions>
-						<ModifyPartition wcm:action="add">
-							<Active>true</Active>
-							<Extend>false</Extend>
-							<Format>NTFS</Format>
-							<Label>OS_Install</Label>
-							<Letter>C</Letter>
-							<Order>1</Order>
-							<PartitionID>1</PartitionID>
-						</ModifyPartition>
+					        <!-- System partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>1</Order>
+					                <PartitionID>1</PartitionID>
+					                <Label>System</Label>
+					                <Letter>S</Letter>
+					                <Format>NTFS</Format>
+					                <Active>true</Active>
+					        </ModifyPartition>
+					        <!-- Windows partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>2</Order>
+					                <PartitionID>2</PartitionID>
+					                <Label>Windows</Label>
+					                <Letter>C</Letter>
+					                <Format>NTFS</Format>
+					        </ModifyPartition>
 					</ModifyPartitions>
 					<DiskID>0</DiskID>
 					<WillWipeDisk>true</WillWipeDisk>
 				</Disk>
-			</DiskConfiguration>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
 					<InstallFrom>
 						<MetaData wcm:action="add">
-							<Key>/IMAGE/INDEX</Key>
-                                                        <!--This index depends on your install ISO. Please update to a proper one if install failed.-->
-							<Value>3</Value>
+							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
+							<Value>Windows Longhorn SERVERDATACENTER</Value>
 						</MetaData>
 					</InstallFrom>
 					<InstallTo>
-						<DiskID>0</DiskID>
-						<PartitionID>1</PartitionID>
+					        <DiskID>0</DiskID>
+					        <PartitionID>2</PartitionID>
 					</InstallTo>
-					<WillShowUI>OnError</WillShowUI>
 				</OSImage>
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
 				<AcceptEula>true</AcceptEula>
-				<FullName>Autotest Mindless Drone</FullName>
-				<Organization>Autotest</Organization>
 			</UserData>
 		</component>
-		<component name="Microsoft-Windows-International-Core-WinPE"
-			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<SetupUILanguage>
-				<UILanguage>en-us</UILanguage>
-			</SetupUILanguage>
-			<InputLocale>0409:00000409</InputLocale>
-			<SystemLocale>en-us</SystemLocale>
-			<UILanguage>en-us</UILanguage>
-			<UserLocale>en-us</UserLocale>
-			<UILanguageFallback>en-us</UILanguageFallback>
-		</component>
-		<component name="Microsoft-Windows-PnpCustomizationsWinPE"
-			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DriverPaths>
-				<PathAndCredentials wcm:keyValue="1" wcm:action="add">
-					<Path>KVM_TEST_SCSI_DRIVER_PATH</Path>
-				</PathAndCredentials>
-				<PathAndCredentials wcm:keyValue="2" wcm:action="add">
-					<Path>KVM_TEST_STORAGE_DRIVER_PATH</Path>
-				</PathAndCredentials>
-				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
-					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
-				</PathAndCredentials>
-			</DriverPaths>
-		</component>
 	</settings>
 	<settings pass="specialize">
 		<component name="Microsoft-Windows-Deployment"
-			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
+			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
@@ -106,20 +118,10 @@
 					<Order>2</Order>
 					<Path>cmd /c reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v FilterAdministratorToken /t REG_DWORD /d 0 /f</Path>
 				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>3</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>4</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
 			</RunSynchronous>
 		</component>
 		<component name="Microsoft-Windows-International-Core"
-			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
+			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
@@ -135,112 +137,218 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
+			<OOBE>
+				<HideEULAPage>true</HideEULAPage>
+				<NetworkLocation>Work</NetworkLocation>
+				<ProtectYourPC>1</ProtectYourPC>
+				<SkipUserOOBE>true</SkipUserOOBE>
+				<SkipMachineOOBE>true</SkipMachineOOBE>
+			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
-				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c xcopy E:\Windows2008-KB970158-x64.cab C:\Windows\SoftwareDistribution\Download\</CommandLine>
+                                        <Order>11</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c start /w pkgmgr /ip /m:C:\Windows\SoftwareDistribution\Download\Windows2008-KB970158-x64.cab /quiet</CommandLine>
+                                        <Order>12</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c start /w pkgmgr /iu:"TelnetServer"</CommandLine>
-					<Order>3</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>9</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe E:\git\git.au3</CommandLine>
-					<Order>10</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>11</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>12</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
+					<Order>22</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f root E:\root.cer</CommandLine>
+                                        <Order>23</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f CA E:\CA-1.cer</CommandLine>
+                                        <Order>24</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat_win7.cer</CommandLine>
+                                        <Order>25</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>14</Order>
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c OCSetup.exe NetFx3 /quiet /norestart /log:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log. dism is not supported on this OS, use ocsetup instead -->
+					<Order>28</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>15</Order>
+					<Order>29</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>16</Order>
+					<Order>30</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>17</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c OCSetup.exe MicrosoftWindowsPowerShell /quiet /norestart /log:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log. dism is not supported on this OS, use ocsetup instead -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>31</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</CommandLine>
+					<Order>32</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- these two registry update makes ahci bootable, NT6.0 or NT6.1 needs http://support.microsoft.com/kb/922976 -->
+					<Order>33</Order>
 				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>34</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>35</Order>
+				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows6.0-kb4056759-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>36</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>37</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>38</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c pnputil -i -a F:\pvpanic\2k8\amd64\pvpanic.inf</CommandLine>
+                                        <Order>39</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c pnputil -i -a F:\Balloon\2k8\amd64\balloon.inf</CommandLine>
+                                        <Order>40</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c pnputil -i -a F:\vioserial\2k8\amd64\vioser.inf</CommandLine>
+                                        <Order>41</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c pnputil -i -a F:\viorng\2k8\amd64\viorng.inf</CommandLine>
+                                        <Order>42</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>43</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>44</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
-			<OOBE>
-				<HideEULAPage>true</HideEULAPage>
-				<NetworkLocation>Work</NetworkLocation>
-				<ProtectYourPC>1</ProtectYourPC>
-				<SkipUserOOBE>true</SkipUserOOBE>
-				<SkipMachineOOBE>true</SkipMachineOOBE>
-			</OOBE>
-		</component>
-		<component name="Microsoft-Windows-International-Core"
-			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<InputLocale>0409:00000409</InputLocale>
-			<SystemLocale>en-us</SystemLocale>
-			<UILanguage>en-us</UILanguage>
-			<UILanguageFallback>en-us</UILanguageFallback>
-			<UserLocale>en-us</UserLocale>
 		</component>
 	</settings>
-	<cpi:offlineImage
-		cpi:source="wim:d:/os/vista/x64/sources/install.wim#Windows Vista ENTERPRISE"
+	<cpi:offlineImage cpi:source="wim:c:/install.wim#Windows Longhorn SERVERSTANDARD"
 		xmlns:cpi="urn:schemas-microsoft-com:cpi" />
 </unattend>
diff --git a/shared/unattended/win2008-64-autounattend_ovmf.xml b/shared/unattended/win2008-64-autounattend_ovmf.xml
index 8b381abb..4d1653a5 100644
--- a/shared/unattended/win2008-64-autounattend_ovmf.xml
+++ b/shared/unattended/win2008-64-autounattend_ovmf.xml
@@ -1,83 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <unattend xmlns="urn:schemas-microsoft-com:unattend">
 	<settings pass="windowsPE">
-		<component name="Microsoft-Windows-Setup"
-			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
-				<WillShowUI>OnError</WillShowUI>
-                                <Disk wcm:action="add">
-                                        <CreatePartitions>
-                                                <!-- EFI system partition (ESP) -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>1</Order>
-                                                  <Type>EFI</Type>
-                                                  <Size>100</Size>
-                                                </CreatePartition>
-                                                <!-- Microsoft reserved partition (MSR) -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>2</Order>
-                                                  <Type>MSR</Type>
-                                                  <Size>128</Size>
-                                                </CreatePartition>
-
-                                                <!-- Windows partition -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>3</Order>
-                                                  <Type>Primary</Type>
-                                                  <Extend>true</Extend>
-                                                </CreatePartition>
-                                        </CreatePartitions>
-                                        <ModifyPartitions>
-                                                <!-- EFI system partition (ESP) -->
-                                                <ModifyPartition wcm:action="add">
-                                                  <Order>1</Order>
-                                                  <PartitionID>1</PartitionID>
-                                                  <Label>System</Label>
-                                                  <Format>FAT32</Format>
-                                                </ModifyPartition>
-                                                <!-- MSR partition does not need to be modified -->
-                                                <!-- Windows partition -->
-                                                <ModifyPartition wcm:action="add">
-                                                  <Order>2</Order>
-                                                  <PartitionID>3</PartitionID>
-                                                  <Label>Windows</Label>
-                                                  <Letter>C</Letter>
-                                                  <Format>NTFS</Format>
-                                                </ModifyPartition>
-                                        </ModifyPartitions>
-                                        <DiskID>0</DiskID>
-                                        <WillWipeDisk>true</WillWipeDisk>
-                                </Disk>
-			</DiskConfiguration>
-			<ImageInstall>
-				<OSImage>
-					<InstallFrom>
-						<MetaData wcm:action="add">
-							<Key>/IMAGE/INDEX</Key>
-                                                        <!--This index depends on your install ISO. Please update to a proper one if install failed.-->
-							<Value>3</Value>
-						</MetaData>
-					</InstallFrom>
-					<InstallTo>
-						<DiskID>0</DiskID>
-						<PartitionID>3</PartitionID>
-					</InstallTo>
-					<WillShowUI>OnError</WillShowUI>
-				</OSImage>
-			</ImageInstall>
-			<UserData>
-				<ProductKey>
-					<Key>KVM_TEST_CDKEY</Key>
-					<WillShowUI>OnError</WillShowUI>
-				</ProductKey>
-				<AcceptEula>true</AcceptEula>
-				<FullName>Autotest Mindless Drone</FullName>
-				<Organization>Autotest</Organization>
-			</UserData>
-		</component>
 		<component name="Microsoft-Windows-International-Core-WinPE"
 			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
 			language="neutral" versionScope="nonSxS"
@@ -89,8 +12,8 @@
 			<InputLocale>0409:00000409</InputLocale>
 			<SystemLocale>en-us</SystemLocale>
 			<UILanguage>en-us</UILanguage>
-			<UserLocale>en-us</UserLocale>
 			<UILanguageFallback>en-us</UILanguageFallback>
+			<UserLocale>en-us</UserLocale>
 		</component>
 		<component name="Microsoft-Windows-PnpCustomizationsWinPE"
 			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
@@ -109,10 +32,85 @@
 				</PathAndCredentials>
 			</DriverPaths>
 		</component>
+		<component name="Microsoft-Windows-Setup"
+			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
+			language="neutral" versionScope="nonSxS"
+			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
+			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+                        <DiskConfiguration>
+				<WillShowUI>OnError</WillShowUI>
+				<Disk wcm:action="add">
+					<CreatePartitions>
+					        <!-- EFI system partition (ESP) -->
+					        <CreatePartition wcm:action="add">
+					          <Order>1</Order>
+					          <Type>EFI</Type>
+					          <Size>100</Size>
+					        </CreatePartition>
+					        <!-- Microsoft reserved partition (MSR) -->
+					        <CreatePartition wcm:action="add">
+					          <Order>2</Order>
+					          <Type>MSR</Type>
+					          <Size>128</Size>
+					        </CreatePartition>
+					        <!-- Windows partition -->
+					        <CreatePartition wcm:action="add">
+					          <Order>3</Order>
+					          <Type>Primary</Type>
+					          <Extend>true</Extend>
+					        </CreatePartition>
+					</CreatePartitions>
+					<ModifyPartitions>
+					        <!-- EFI system partition (ESP) -->
+					        <ModifyPartition wcm:action="add">
+					          <Order>1</Order>
+					          <PartitionID>1</PartitionID>
+					          <Label>System</Label>
+					          <Format>FAT32</Format>
+					        </ModifyPartition>
+					        <!-- MSR partition does not need to be modified -->
+					        <!-- Windows partition -->
+					        <ModifyPartition wcm:action="add">
+					          <Order>2</Order>
+					          <PartitionID>3</PartitionID>
+					          <Label>Windows</Label>
+					          <Letter>C</Letter>
+					          <Format>NTFS</Format>
+					        </ModifyPartition>
+					</ModifyPartitions>
+					<DiskID>0</DiskID>
+					<WillWipeDisk>true</WillWipeDisk>
+				</Disk>
+                        </DiskConfiguration>
+			<ImageInstall>
+				<OSImage>
+					<InstallFrom>
+						<MetaData wcm:action="add">
+							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
+							<Value>Windows Longhorn SERVERDATACENTER</Value>
+						</MetaData>
+					</InstallFrom>
+					<InstallTo>
+						<DiskID>0</DiskID>
+						<PartitionID>3</PartitionID>
+					</InstallTo>
+				</OSImage>
+			</ImageInstall>
+			<UserData>
+				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
+					<Key>KVM_TEST_CDKEY</Key>
+					<WillShowUI>OnError</WillShowUI>
+				</ProductKey>
+				<AcceptEula>true</AcceptEula>
+			</UserData>
+		</component>
 	</settings>
 	<settings pass="specialize">
 		<component name="Microsoft-Windows-Deployment"
-			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
+			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
@@ -127,20 +125,10 @@
 					<Order>2</Order>
 					<Path>cmd /c reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v FilterAdministratorToken /t REG_DWORD /d 0 /f</Path>
 				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>3</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>4</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
 			</RunSynchronous>
 		</component>
 		<component name="Microsoft-Windows-International-Core"
-			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
+			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
@@ -156,112 +144,218 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
+			<OOBE>
+				<HideEULAPage>true</HideEULAPage>
+				<NetworkLocation>Work</NetworkLocation>
+				<ProtectYourPC>1</ProtectYourPC>
+				<SkipUserOOBE>true</SkipUserOOBE>
+				<SkipMachineOOBE>true</SkipMachineOOBE>
+			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
-				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c xcopy E:\Windows2008-KB970158-x64.cab C:\Windows\SoftwareDistribution\Download\</CommandLine>
+                                        <Order>11</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c start /w pkgmgr /ip /m:C:\Windows\SoftwareDistribution\Download\Windows2008-KB970158-x64.cab /quiet</CommandLine>
+                                        <Order>12</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c start /w pkgmgr /iu:"TelnetServer"</CommandLine>
-					<Order>3</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>9</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe E:\git\git.au3</CommandLine>
-					<Order>10</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>11</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>12</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
+					<Order>22</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f root E:\root.cer</CommandLine>
+                                        <Order>23</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f CA E:\CA-1.cer</CommandLine>
+                                        <Order>24</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat_win7.cer</CommandLine>
+                                        <Order>25</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>14</Order>
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c OCSetup.exe NetFx3 /quiet /norestart /log:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log. dism is not supported on this OS, use ocsetup instead -->
+					<Order>28</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>15</Order>
+					<Order>29</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>16</Order>
+					<Order>30</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>17</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c OCSetup.exe MicrosoftWindowsPowerShell /quiet /norestart /log:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log. dism is not supported on this OS, use ocsetup instead -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>31</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</CommandLine>
+					<Order>32</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- these two registry update makes ahci bootable, NT6.0 or NT6.1 needs http://support.microsoft.com/kb/922976 -->
+					<Order>33</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>34</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>35</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows6.0-kb4056759-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>36</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>37</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>38</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c pnputil -i -a F:\pvpanic\2k8\amd64\pvpanic.inf</CommandLine>
+                                        <Order>39</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c pnputil -i -a F:\Balloon\2k8\amd64\balloon.inf</CommandLine>
+                                        <Order>40</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c pnputil -i -a F:\vioserial\2k8\amd64\vioser.inf</CommandLine>
+                                        <Order>41</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c pnputil -i -a F:\viorng\2k8\amd64\viorng.inf</CommandLine>
+                                        <Order>42</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>43</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>44</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
-			<OOBE>
-				<HideEULAPage>true</HideEULAPage>
-				<NetworkLocation>Work</NetworkLocation>
-				<ProtectYourPC>1</ProtectYourPC>
-				<SkipUserOOBE>true</SkipUserOOBE>
-				<SkipMachineOOBE>true</SkipMachineOOBE>
-			</OOBE>
-		</component>
-		<component name="Microsoft-Windows-International-Core"
-			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<InputLocale>0409:00000409</InputLocale>
-			<SystemLocale>en-us</SystemLocale>
-			<UILanguage>en-us</UILanguage>
-			<UILanguageFallback>en-us</UILanguageFallback>
-			<UserLocale>en-us</UserLocale>
 		</component>
 	</settings>
-	<cpi:offlineImage
-		cpi:source="wim:d:/os/vista/x64/sources/install.wim#Windows Vista ENTERPRISE"
+	<cpi:offlineImage cpi:source="wim:c:/install.wim#Windows Longhorn SERVERSTANDARD"
 		xmlns:cpi="urn:schemas-microsoft-com:cpi" />
 </unattend>
diff --git a/shared/unattended/win2008-r2-autounattend.xml b/shared/unattended/win2008-r2-autounattend.xml
index 18c5bc57..53fdd7fa 100644
--- a/shared/unattended/win2008-r2-autounattend.xml
+++ b/shared/unattended/win2008-r2-autounattend.xml
@@ -1,58 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <unattend xmlns="urn:schemas-microsoft-com:unattend">
 	<settings pass="windowsPE">
-		<component name="Microsoft-Windows-Setup"
-			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
-				<WillShowUI>OnError</WillShowUI>
-				<Disk wcm:action="add">
-					<CreatePartitions>
-						<CreatePartition wcm:action="add">
-							<Order>1</Order>
-							<Size>30000</Size>
-							<Type>Primary</Type>
-						</CreatePartition>
-					</CreatePartitions>
-					<ModifyPartitions>
-						<ModifyPartition wcm:action="add">
-							<Active>true</Active>
-							<Extend>false</Extend>
-							<Format>NTFS</Format>
-							<Label>OS_Install</Label>
-							<Letter>C</Letter>
-							<Order>1</Order>
-							<PartitionID>1</PartitionID>
-						</ModifyPartition>
-					</ModifyPartitions>
-					<DiskID>0</DiskID>
-					<WillWipeDisk>true</WillWipeDisk>
-				</Disk>
-			</DiskConfiguration>
-			<ImageInstall>
-				<OSImage>
-					<InstallFrom>
-						<MetaData wcm:action="add">
-							<Key>/IMAGE/INDEX</Key>
-                                                        <!--This index depends on your install ISO. Please update to a proper one if install failed.-->
-							<Value>5</Value>
-						</MetaData>
-					</InstallFrom>
-					<InstallTo>
-						<DiskID>0</DiskID>
-						<PartitionID>1</PartitionID>
-					</InstallTo>
-					<WillShowUI>OnError</WillShowUI>
-				</OSImage>
-			</ImageInstall>
-			<UserData>
-				<AcceptEula>true</AcceptEula>
-				<FullName>Autotest Mindless Drone</FullName>
-				<Organization>Autotest</Organization>
-			</UserData>
-		</component>
 		<component name="Microsoft-Windows-International-Core-WinPE"
 			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
 			language="neutral" versionScope="nonSxS"
@@ -64,8 +12,8 @@
 			<InputLocale>0409:00000409</InputLocale>
 			<SystemLocale>en-us</SystemLocale>
 			<UILanguage>en-us</UILanguage>
-			<UserLocale>en-us</UserLocale>
 			<UILanguageFallback>en-us</UILanguageFallback>
+			<UserLocale>en-us</UserLocale>
 		</component>
 		<component name="Microsoft-Windows-PnpCustomizationsWinPE"
 			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
@@ -82,12 +30,95 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
+		<component name="Microsoft-Windows-Setup"
+			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
+			language="neutral" versionScope="nonSxS"
+			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
+			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+                        <DiskConfiguration>
+                                <WillShowUI>OnError</WillShowUI>
+                                <Disk wcm:action="add">
+                                        <CreatePartitions>
+                                                <CreatePartition wcm:action="add">
+                                                        <Order>1</Order>
+                                                        <Size>300</Size>
+                                                        <Type>Primary</Type>
+                                                </CreatePartition>
+                                                <CreatePartition wcm:action="add">
+                                                        <Order>2</Order>
+                                                        <Extend>true</Extend>
+                                                        <Type>Primary</Type>
+                                                </CreatePartition>
+                                        </CreatePartitions>
+                                        <ModifyPartitions>
+                                                <!-- System partition -->
+                                                <ModifyPartition wcm:action="add">
+                                                        <Order>1</Order>
+                                                        <PartitionID>1</PartitionID>
+                                                        <Label>System</Label>
+                                                        <Letter>S</Letter>
+                                                        <Format>NTFS</Format>
+                                                        <Active>true</Active>
+                                                </ModifyPartition>
+                                                <!-- Windows partition -->
+                                                <ModifyPartition wcm:action="add">
+                                                        <Order>2</Order>
+                                                        <PartitionID>2</PartitionID>
+                                                        <Label>Windows</Label>
+                                                        <Letter>C</Letter>
+                                                        <Format>NTFS</Format>
+                                                </ModifyPartition>
+                                        </ModifyPartitions>
+                                        <DiskID>0</DiskID>
+                                        <WillWipeDisk>true</WillWipeDisk>
+                                </Disk>
+                        </DiskConfiguration>
+			<ImageInstall>
+				<OSImage>
+					<InstallFrom>
+						<MetaData wcm:action="add">
+							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
+							<Value>Windows Server 2008 R2 SERVERDATACENTER</Value>
+						</MetaData>
+					</InstallFrom>
+                                        <InstallTo>
+                                                <DiskID>0</DiskID>
+                                                <PartitionID>2</PartitionID>
+                                        </InstallTo>
+				</OSImage>
+			</ImageInstall>
+			<UserData>
+				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
+					<Key>KVM_TEST_CDKEY</Key>
+					<WillShowUI>OnError</WillShowUI>
+				</ProductKey>
+				<AcceptEula>true</AcceptEula>
+			</UserData>
+		</component>
 	</settings>
 	<settings pass="specialize">
 		<component name="Microsoft-Windows-Deployment"
-			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
+			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
@@ -102,20 +133,10 @@
 					<Order>2</Order>
 					<Path>cmd /c reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v FilterAdministratorToken /t REG_DWORD /d 0 /f</Path>
 				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>3</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>4</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
 			</RunSynchronous>
 		</component>
 		<component name="Microsoft-Windows-International-Core"
-			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
+			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
@@ -124,13 +145,6 @@
 			<UILanguage>en-US</UILanguage>
 			<UserLocale>en-US</UserLocale>
 		</component>
-		<component name="Microsoft-Windows-Shell-Setup"
-			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<ProductKey>KVM_TEST_CDKEY</ProductKey>
-		</component>
 	</settings>
 	<settings pass="oobeSystem">
 		<component name="Microsoft-Windows-Shell-Setup"
@@ -138,116 +152,195 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
+			<OOBE>
+				<HideEULAPage>true</HideEULAPage>
+				<NetworkLocation>Work</NetworkLocation>
+				<ProtectYourPC>1</ProtectYourPC>
+				<SkipUserOOBE>true</SkipUserOOBE>
+				<SkipMachineOOBE>true</SkipMachineOOBE>
+			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER"</CommandLine>
-					<Order>2</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat_win7.cer</CommandLine>
+					<Order>11</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c start /w pkgmgr /iu:"TelnetServer"</CommandLine>
-					<Order>3</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>9</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe E:\git\git.au3</CommandLine>
-					<Order>10</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>11</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>12</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>15</Order>
+					<Order>23</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log. these options are not supported on this OS: /All /LimitAccess -->
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>16</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>17</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>18</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log, and write down the log. these options are not supported on this OS: /All /LimitAccess -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>27</Order>
 				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</CommandLine>
+					<Order>28</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- these two registry update makes ahci bootable, NT6.0 or NT6.1 needs http://support.microsoft.com/kb/922976 -->
+					<Order>29</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>30</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>31</Order>
+				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+        <!---BZ# 1266075 -->
+                                        <CommandLine>%WINDIR%\System32\cmd /c %WINDIR%\System32\wusa.exe E:\msu\Windows6.1-KB2528507-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>32</Order>
+				</SynchronousCommand>
+                               <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c  %WINDIR%\System32\wusa.exe E:\msu\windows6.1-kb4486563-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>33</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows6.1-kb4056894-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>34</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>35</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>36</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>37</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>38</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
-			<OOBE>
-				<HideEULAPage>true</HideEULAPage>
-				<NetworkLocation>Work</NetworkLocation>
-				<ProtectYourPC>1</ProtectYourPC>
-				<SkipUserOOBE>true</SkipUserOOBE>
-				<SkipMachineOOBE>true</SkipMachineOOBE>
-			</OOBE>
-		</component>
-		<component name="Microsoft-Windows-International-Core"
-			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<InputLocale>0409:00000409</InputLocale>
-			<SystemLocale>en-us</SystemLocale>
-			<UILanguage>en-us</UILanguage>
-			<UILanguageFallback>en-us</UILanguageFallback>
-			<UserLocale>en-us</UserLocale>
 		</component>
 	</settings>
-	<cpi:offlineImage
-		cpi:source="wim:d:/os/vista/x64/sources/install.wim#Windows Vista ENTERPRISE"
+	<cpi:offlineImage cpi:source="wim:c:/install.wim#Windows Longhorn SERVERSTANDARD"
 		xmlns:cpi="urn:schemas-microsoft-com:cpi" />
 </unattend>
diff --git a/shared/unattended/win2008-r2-autounattend_ovmf.xml b/shared/unattended/win2008-r2-autounattend_ovmf.xml
index 6c344ca8..9470bd23 100644
--- a/shared/unattended/win2008-r2-autounattend_ovmf.xml
+++ b/shared/unattended/win2008-r2-autounattend_ovmf.xml
@@ -1,13 +1,59 @@
 <?xml version="1.0" encoding="utf-8"?>
 <unattend xmlns="urn:schemas-microsoft-com:unattend">
 	<settings pass="windowsPE">
+		<component name="Microsoft-Windows-International-Core-WinPE"
+			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
+			language="neutral" versionScope="nonSxS"
+			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
+			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+			<SetupUILanguage>
+				<UILanguage>en-us</UILanguage>
+			</SetupUILanguage>
+			<InputLocale>0409:00000409</InputLocale>
+			<SystemLocale>en-us</SystemLocale>
+			<UILanguage>en-us</UILanguage>
+			<UILanguageFallback>en-us</UILanguageFallback>
+			<UserLocale>en-us</UserLocale>
+		</component>
+		<component name="Microsoft-Windows-PnpCustomizationsWinPE"
+			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
+			language="neutral" versionScope="nonSxS"
+			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
+			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+			<DriverPaths>
+				<PathAndCredentials wcm:keyValue="1" wcm:action="add">
+					<Path>KVM_TEST_SCSI_DRIVER_PATH</Path>
+				</PathAndCredentials>
+				<PathAndCredentials wcm:keyValue="2" wcm:action="add">
+					<Path>KVM_TEST_STORAGE_DRIVER_PATH</Path>
+				</PathAndCredentials>
+				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
+					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
+				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+			</DriverPaths>
+		</component>
 		<component name="Microsoft-Windows-Setup"
 			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
-				<WillShowUI>OnError</WillShowUI>
+                        <DiskConfiguration>
+                                <WillShowUI>OnError</WillShowUI>
                                 <Disk wcm:action="add">
                                         <CreatePartitions>
                                                 <!-- EFI system partition (ESP) -->
@@ -50,64 +96,36 @@
                                         <DiskID>0</DiskID>
                                         <WillWipeDisk>true</WillWipeDisk>
                                 </Disk>
-			</DiskConfiguration>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
 					<InstallFrom>
 						<MetaData wcm:action="add">
-							<Key>/IMAGE/INDEX</Key>
-                                                        <!--This index depends on your install ISO. Please update to a proper one if install failed.-->
-							<Value>5</Value>
+							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
+							<Value>Windows Server 2008 R2 SERVERDATACENTER</Value>
 						</MetaData>
 					</InstallFrom>
 					<InstallTo>
 						<DiskID>0</DiskID>
 						<PartitionID>3</PartitionID>
 					</InstallTo>
-					<WillShowUI>OnError</WillShowUI>
 				</OSImage>
 			</ImageInstall>
 			<UserData>
+				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
+					<Key>KVM_TEST_CDKEY</Key>
+					<WillShowUI>OnError</WillShowUI>
+				</ProductKey>
 				<AcceptEula>true</AcceptEula>
-				<FullName>Autotest Mindless Drone</FullName>
-				<Organization>Autotest</Organization>
 			</UserData>
 		</component>
-		<component name="Microsoft-Windows-International-Core-WinPE"
-			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<SetupUILanguage>
-				<UILanguage>en-us</UILanguage>
-			</SetupUILanguage>
-			<InputLocale>0409:00000409</InputLocale>
-			<SystemLocale>en-us</SystemLocale>
-			<UILanguage>en-us</UILanguage>
-			<UserLocale>en-us</UserLocale>
-			<UILanguageFallback>en-us</UILanguageFallback>
-		</component>
-		<component name="Microsoft-Windows-PnpCustomizationsWinPE"
-			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DriverPaths>
-				<PathAndCredentials wcm:keyValue="1" wcm:action="add">
-					<Path>KVM_TEST_SCSI_DRIVER_PATH</Path>
-				</PathAndCredentials>
-				<PathAndCredentials wcm:keyValue="2" wcm:action="add">
-					<Path>KVM_TEST_STORAGE_DRIVER_PATH</Path>
-				</PathAndCredentials>
-				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
-					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
-				</PathAndCredentials>
-			</DriverPaths>
-		</component>
 	</settings>
 	<settings pass="specialize">
 		<component name="Microsoft-Windows-Deployment"
-			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
+			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
@@ -122,20 +140,10 @@
 					<Order>2</Order>
 					<Path>cmd /c reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v FilterAdministratorToken /t REG_DWORD /d 0 /f</Path>
 				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>3</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>4</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
 			</RunSynchronous>
 		</component>
 		<component name="Microsoft-Windows-International-Core"
-			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
+			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
@@ -144,13 +152,6 @@
 			<UILanguage>en-US</UILanguage>
 			<UserLocale>en-US</UserLocale>
 		</component>
-		<component name="Microsoft-Windows-Shell-Setup"
-			processorArchitecture="x86" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<ProductKey>KVM_TEST_CDKEY</ProductKey>
-		</component>
 	</settings>
 	<settings pass="oobeSystem">
 		<component name="Microsoft-Windows-Shell-Setup"
@@ -158,116 +159,195 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
+			<OOBE>
+				<HideEULAPage>true</HideEULAPage>
+				<NetworkLocation>Work</NetworkLocation>
+				<ProtectYourPC>1</ProtectYourPC>
+				<SkipUserOOBE>true</SkipUserOOBE>
+				<SkipMachineOOBE>true</SkipMachineOOBE>
+			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER"</CommandLine>
-					<Order>2</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat_win7.cer</CommandLine>
+					<Order>11</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c start /w pkgmgr /iu:"TelnetServer"</CommandLine>
-					<Order>3</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>9</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe E:\git\git.au3</CommandLine>
-					<Order>10</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>11</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>12</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>15</Order>
+					<Order>23</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log. these options are not supported on this OS: /All /LimitAccess -->
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>16</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>17</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>18</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log, and write down the log. these options are not supported on this OS: /All /LimitAccess -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</CommandLine>
+					<Order>28</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- these two registry update makes ahci bootable, NT6.0 or NT6.1 needs http://support.microsoft.com/kb/922976 -->
+					<Order>29</Order>
 				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>30</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+				<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>31</Order>
+				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+        <!---BZ# 1266075 -->
+                                        <CommandLine>%WINDIR%\System32\cmd /c %WINDIR%\System32\wusa.exe E:\msu\Windows6.1-KB2528507-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>32</Order>
+				</SynchronousCommand>
+                               <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c  %WINDIR%\System32\wusa.exe E:\msu\windows6.1-kb4486563-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>33</Order>
+                                </SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows6.1-kb4056894-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>34</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>35</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>36</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>37</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>38</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
-			<OOBE>
-				<HideEULAPage>true</HideEULAPage>
-				<NetworkLocation>Work</NetworkLocation>
-				<ProtectYourPC>1</ProtectYourPC>
-				<SkipUserOOBE>true</SkipUserOOBE>
-				<SkipMachineOOBE>true</SkipMachineOOBE>
-			</OOBE>
-		</component>
-		<component name="Microsoft-Windows-International-Core"
-			processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35"
-			language="neutral" versionScope="nonSxS"
-			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
-			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<InputLocale>0409:00000409</InputLocale>
-			<SystemLocale>en-us</SystemLocale>
-			<UILanguage>en-us</UILanguage>
-			<UILanguageFallback>en-us</UILanguageFallback>
-			<UserLocale>en-us</UserLocale>
 		</component>
 	</settings>
-	<cpi:offlineImage
-		cpi:source="wim:d:/os/vista/x64/sources/install.wim#Windows Vista ENTERPRISE"
+	<cpi:offlineImage cpi:source="wim:c:/install.wim#Windows Longhorn SERVERSTANDARD"
 		xmlns:cpi="urn:schemas-microsoft-com:cpi" />
 </unattend>
diff --git a/shared/unattended/win2012-autounattend.xml b/shared/unattended/win2012-autounattend.xml
index f44a09e0..3584d300 100644
--- a/shared/unattended/win2012-autounattend.xml
+++ b/shared/unattended/win2012-autounattend.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -37,47 +52,63 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
+                        <DiskConfiguration>
 				<WillShowUI>OnError</WillShowUI>
 				<Disk wcm:action="add">
-					<CreatePartitions>
-						<CreatePartition wcm:action="add">
-							<Order>1</Order>
-							<Size>30000</Size>
-							<Type>Primary</Type>
-						</CreatePartition>
-					</CreatePartitions>
-					<ModifyPartitions>
-						<ModifyPartition wcm:action="add">
-							<Active>true</Active>
-							<Extend>false</Extend>
-							<Format>NTFS</Format>
-							<Label>OS_Install</Label>
-							<Letter>C</Letter>
-							<Order>1</Order>
-							<PartitionID>1</PartitionID>
-						</ModifyPartition>
-					</ModifyPartitions>
-					<DiskID>0</DiskID>
-					<WillWipeDisk>true</WillWipeDisk>
+				        <CreatePartitions>
+				                <CreatePartition wcm:action="add">
+				                	<Order>1</Order>
+				                        <Size>300</Size>
+				                        <Type>Primary</Type>
+				                </CreatePartition>
+				                <CreatePartition wcm:action="add">
+				                	<Order>2</Order>
+				                        <Extend>true</Extend>
+				                        <Type>Primary</Type>
+				                </CreatePartition>
+				        </CreatePartitions>
+				        <ModifyPartitions>
+				                <!-- System partition -->
+				                <ModifyPartition wcm:action="add">
+				                	<Order>1</Order>
+				                        <PartitionID>1</PartitionID>
+				                        <Label>System</Label>
+				                        <Letter>S</Letter>
+				                        <Format>NTFS</Format>
+				                        <Active>true</Active>
+				                </ModifyPartition>
+				                <!-- Windows partition -->
+				                <ModifyPartition wcm:action="add">
+				                	<Order>2</Order>
+				                        <PartitionID>2</PartitionID>
+				                        <Label>Windows</Label>
+				                        <Letter>C</Letter>
+				                        <Format>NTFS</Format>
+				                </ModifyPartition>
+				        </ModifyPartitions>
+				        <DiskID>0</DiskID>
+				        <WillWipeDisk>true</WillWipeDisk>
 				</Disk>
-			</DiskConfiguration>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
 					<InstallFrom>
 						<MetaData wcm:action="add">
 							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
 							<Value>Windows Server 2012 SERVERDATACENTER</Value>
 						</MetaData>
 					</InstallFrom>
-					<InstallTo>
-						<DiskID>0</DiskID>
-						<PartitionID>1</PartitionID>
-					</InstallTo>
+				        <InstallTo>
+				                <DiskID>0</DiskID>
+				                <PartitionID>2</PartitionID>
+				        </InstallTo>
 				</OSImage>
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -121,9 +152,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -136,90 +169,157 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat.cer</CommandLine>
+					<Order>11</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c dism /online /Enable-Feature /FeatureName:TelnetServer</CommandLine>
-					<Order>3</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>9</Order>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>10</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>11</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>12</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>15</Order>
+					<Order>23</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\Dism /online /enable-feature /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess</CommandLine>
-					<Order>16</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log -->
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>17</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>18</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>19</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /All /LimitAccess /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>28</Order>
 				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>29</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows8-rt-kb4056896-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>30</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>31</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>32</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>33</Order>
+                                </SynchronousCommand>
+                               <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>34</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/win2012-autounattend_ovmf.xml b/shared/unattended/win2012-autounattend_ovmf.xml
index 13a85ea3..39c8342a 100644
--- a/shared/unattended/win2012-autounattend_ovmf.xml
+++ b/shared/unattended/win2012-autounattend_ovmf.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -37,56 +52,58 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
+                        <DiskConfiguration>
 				<WillShowUI>OnError</WillShowUI>
-                                <Disk wcm:action="add">
-                                        <CreatePartitions>
-                                                <!-- EFI system partition (ESP) -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>1</Order>
-                                                  <Type>EFI</Type>
-                                                  <Size>100</Size>
-                                                </CreatePartition>
-                                                <!-- Microsoft reserved partition (MSR) -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>2</Order>
-                                                  <Type>MSR</Type>
-                                                  <Size>128</Size>
-                                                </CreatePartition>
-                                                <!-- Windows partition -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>3</Order>
-                                                  <Type>Primary</Type>
-                                                  <Extend>true</Extend>
-                                                </CreatePartition>
-                                        </CreatePartitions>
-                                        <ModifyPartitions>
-                                                <!-- EFI system partition (ESP) -->
-                                                <ModifyPartition wcm:action="add">
-                                                  <Order>1</Order>
-                                                  <PartitionID>1</PartitionID>
-                                                  <Label>System</Label>
-                                                  <Format>FAT32</Format>
-                                                </ModifyPartition>
-                                                <!-- MSR partition does not need to be modified -->
-                                                <!-- Windows partition -->
-                                                <ModifyPartition wcm:action="add">
-                                                  <Order>2</Order>
-                                                  <PartitionID>3</PartitionID>
-                                                  <Label>Windows</Label>
-                                                  <Letter>C</Letter>
-                                                  <Format>NTFS</Format>
-                                                </ModifyPartition>
-                                        </ModifyPartitions>
-                                        <DiskID>0</DiskID>
-                                        <WillWipeDisk>true</WillWipeDisk>
-                                </Disk>
-			</DiskConfiguration>
+				<Disk wcm:action="add">
+					<CreatePartitions>
+					        <!-- EFI system partition (ESP) -->
+					        <CreatePartition wcm:action="add">
+					          <Order>1</Order>
+					          <Type>EFI</Type>
+					          <Size>260</Size>
+					        </CreatePartition>
+					        <!-- Microsoft reserved partition (MSR) -->
+					        <CreatePartition wcm:action="add">
+					          <Order>2</Order>
+					          <Type>MSR</Type>
+					          <Size>128</Size>
+					        </CreatePartition>
+					        <!-- Windows partition -->
+					        <CreatePartition wcm:action="add">
+					          <Order>3</Order>
+					          <Type>Primary</Type>
+					          <Extend>true</Extend>
+					        </CreatePartition>
+					</CreatePartitions>
+					<ModifyPartitions>
+					        <!-- EFI system partition (ESP) -->
+					        <ModifyPartition wcm:action="add">
+					          <Order>1</Order>
+					          <PartitionID>1</PartitionID>
+					          <Label>System</Label>
+					          <Format>FAT32</Format>
+					        </ModifyPartition>
+					        <!-- MSR partition does not need to be modified -->
+					        <!-- Windows partition -->
+					        <ModifyPartition wcm:action="add">
+					          <Order>2</Order>
+					          <PartitionID>3</PartitionID>
+					          <Label>Windows</Label>
+					          <Letter>C</Letter>
+					          <Format>NTFS</Format>
+					        </ModifyPartition>
+					</ModifyPartitions>
+					<DiskID>0</DiskID>
+					<WillWipeDisk>true</WillWipeDisk>
+				</Disk>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
 					<InstallFrom>
 						<MetaData wcm:action="add">
 							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
 							<Value>Windows Server 2012 SERVERDATACENTER</Value>
 						</MetaData>
 					</InstallFrom>
@@ -98,6 +115,7 @@
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -141,9 +159,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -156,90 +176,157 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat.cer</CommandLine>
+					<Order>11</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c dism /online /Enable-Feature /FeatureName:TelnetServer</CommandLine>
-					<Order>3</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>9</Order>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>10</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>11</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>12</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>15</Order>
+					<Order>23</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\Dism /online /enable-feature /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess</CommandLine>
-					<Order>16</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log -->
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>17</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>18</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>19</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /All /LimitAccess /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>28</Order>
 				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>29</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows8-rt-kb4056896-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>30</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>31</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>32</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>33</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>34</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/win2012r2-autounattend.xml b/shared/unattended/win2012r2-autounattend.xml
index e80e002e..193be711 100644
--- a/shared/unattended/win2012r2-autounattend.xml
+++ b/shared/unattended/win2012r2-autounattend.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -37,47 +52,63 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
+                        <DiskConfiguration>
 				<WillShowUI>OnError</WillShowUI>
 				<Disk wcm:action="add">
 					<CreatePartitions>
-						<CreatePartition wcm:action="add">
-							<Order>1</Order>
-							<Size>30000</Size>
-							<Type>Primary</Type>
-						</CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>1</Order>
+					                <Size>300</Size>
+					                <Type>Primary</Type>
+					        </CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>2</Order>
+					                <Extend>true</Extend>
+					                <Type>Primary</Type>
+					        </CreatePartition>
 					</CreatePartitions>
 					<ModifyPartitions>
-						<ModifyPartition wcm:action="add">
-							<Active>true</Active>
-							<Extend>false</Extend>
-							<Format>NTFS</Format>
-							<Label>OS_Install</Label>
-							<Letter>C</Letter>
-							<Order>1</Order>
-							<PartitionID>1</PartitionID>
-						</ModifyPartition>
+					        <!-- System partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>1</Order>
+					                <PartitionID>1</PartitionID>
+					                <Label>System</Label>
+					                <Letter>S</Letter>
+					                <Format>NTFS</Format>
+					                <Active>true</Active>
+					        </ModifyPartition>
+					        <!-- Windows partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>2</Order>
+					                <PartitionID>2</PartitionID>
+					                <Label>Windows</Label>
+					                <Letter>C</Letter>
+					                <Format>NTFS</Format>
+					        </ModifyPartition>
 					</ModifyPartitions>
 					<DiskID>0</DiskID>
 					<WillWipeDisk>true</WillWipeDisk>
 				</Disk>
-			</DiskConfiguration>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
 					<InstallFrom>
 						<MetaData wcm:action="add">
 							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
 							<Value>Windows Server 2012 R2 SERVERDATACENTER</Value>
 						</MetaData>
 					</InstallFrom>
 					<InstallTo>
-						<DiskID>0</DiskID>
-						<PartitionID>1</PartitionID>
+					        <DiskID>0</DiskID>
+					        <PartitionID>2</PartitionID>
 					</InstallTo>
 				</OSImage>
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -121,9 +152,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -136,90 +169,157 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat.cer</CommandLine>
+					<Order>11</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c dism /online /Enable-Feature /FeatureName:TelnetServer</CommandLine>
-					<Order>3</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>9</Order>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>10</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>11</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>12</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>15</Order>
+					<Order>23</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\Dism /online /enable-feature /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess</CommandLine>
-					<Order>16</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log -->
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>17</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>18</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>19</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /All /LimitAccess /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>28</Order>
 				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>29</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows8.1-kb4056898-v2-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>30</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>31</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>32</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>33</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>34</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/win2012r2-autounattend_ovmf.xml b/shared/unattended/win2012r2-autounattend_ovmf.xml
index 09539bf7..d56a67e5 100644
--- a/shared/unattended/win2012r2-autounattend_ovmf.xml
+++ b/shared/unattended/win2012r2-autounattend_ovmf.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -37,56 +52,58 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
+                        <DiskConfiguration>
 				<WillShowUI>OnError</WillShowUI>
-                                <Disk wcm:action="add">
-                                        <CreatePartitions>
-                                                <!-- EFI system partition (ESP) -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>1</Order>
-                                                  <Type>EFI</Type>
-                                                  <Size>100</Size>
-                                                </CreatePartition>
-                                                <!-- Microsoft reserved partition (MSR) -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>2</Order>
-                                                  <Type>MSR</Type>
-                                                  <Size>128</Size>
-                                                </CreatePartition>
-                                                <!-- Windows partition -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>3</Order>
-                                                  <Type>Primary</Type>
-                                                  <Extend>true</Extend>
-                                                </CreatePartition>
-                                        </CreatePartitions>
-                                        <ModifyPartitions>
-                                                <!-- EFI system partition (ESP) -->
-                                                <ModifyPartition wcm:action="add">
-                                                  <Order>1</Order>
-                                                  <PartitionID>1</PartitionID>
-                                                  <Label>System</Label>
-                                                  <Format>FAT32</Format>
-                                                </ModifyPartition>
-                                                <!-- MSR partition does not need to be modified -->
-                                                <!-- Windows partition -->
-                                                <ModifyPartition wcm:action="add">
-                                                  <Order>2</Order>
-                                                  <PartitionID>3</PartitionID>
-                                                  <Label>Windows</Label>
-                                                  <Letter>C</Letter>
-                                                  <Format>NTFS</Format>
-                                                </ModifyPartition>
-                                        </ModifyPartitions>
-                                        <DiskID>0</DiskID>
-                                        <WillWipeDisk>true</WillWipeDisk>
-                                </Disk>
-			</DiskConfiguration>
+				<Disk wcm:action="add">
+					<CreatePartitions>
+					        <!-- EFI system partition (ESP) -->
+					        <CreatePartition wcm:action="add">
+					          <Order>1</Order>
+					          <Type>EFI</Type>
+					          <Size>260</Size>
+					        </CreatePartition>
+					        <!-- Microsoft reserved partition (MSR) -->
+					        <CreatePartition wcm:action="add">
+					          <Order>2</Order>
+					          <Type>MSR</Type>
+					          <Size>128</Size>
+					        </CreatePartition>
+					        <!-- Windows partition -->
+					        <CreatePartition wcm:action="add">
+					          <Order>3</Order>
+					          <Type>Primary</Type>
+					          <Extend>true</Extend>
+					        </CreatePartition>
+					</CreatePartitions>
+					<ModifyPartitions>
+					        <!-- EFI system partition (ESP) -->
+					        <ModifyPartition wcm:action="add">
+					          <Order>1</Order>
+					          <PartitionID>1</PartitionID>
+					          <Label>System</Label>
+					          <Format>FAT32</Format>
+					        </ModifyPartition>
+					        <!-- MSR partition does not need to be modified -->
+					        <!-- Windows partition -->
+					        <ModifyPartition wcm:action="add">
+					          <Order>2</Order>
+					          <PartitionID>3</PartitionID>
+					          <Label>Windows</Label>
+					          <Letter>C</Letter>
+					          <Format>NTFS</Format>
+					        </ModifyPartition>
+					</ModifyPartitions>
+					<DiskID>0</DiskID>
+					<WillWipeDisk>true</WillWipeDisk>
+				</Disk>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
 					<InstallFrom>
 						<MetaData wcm:action="add">
 							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
 							<Value>Windows Server 2012 R2 SERVERDATACENTER</Value>
 						</MetaData>
 					</InstallFrom>
@@ -98,6 +115,7 @@
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -141,9 +159,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -156,90 +176,157 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat.cer</CommandLine>
+					<Order>11</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c dism /online /Enable-Feature /FeatureName:TelnetServer</CommandLine>
-					<Order>3</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>9</Order>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>10</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>11</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>12</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>15</Order>
+					<Order>23</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\Dism /online /enable-feature /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess</CommandLine>
-					<Order>16</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log -->
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>17</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>18</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>19</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /All /LimitAccess /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>28</Order>
 				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>29</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows8.1-kb4056898-v2-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>30</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>31</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>32</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>33</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>34</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/win2016-autounattend.xml b/shared/unattended/win2016-autounattend.xml
index fb53753d..4a8f9360 100644
--- a/shared/unattended/win2016-autounattend.xml
+++ b/shared/unattended/win2016-autounattend.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -43,19 +58,32 @@
 					<CreatePartitions>
 						<CreatePartition wcm:action="add">
 							<Order>1</Order>
-							<Size>30000</Size>
+							<Size>300</Size>
+							<Type>Primary</Type>
+						</CreatePartition>
+						<CreatePartition wcm:action="add">
+							<Order>2</Order>
+							<Extend>true</Extend>
 							<Type>Primary</Type>
 						</CreatePartition>
 					</CreatePartitions>
 					<ModifyPartitions>
+						<!-- System partition -->
 						<ModifyPartition wcm:action="add">
-							<Active>true</Active>
-							<Extend>false</Extend>
-							<Format>NTFS</Format>
-							<Label>OS_Install</Label>
-							<Letter>C</Letter>
 							<Order>1</Order>
 							<PartitionID>1</PartitionID>
+							<Label>System</Label>
+							<Letter>S</Letter>
+							<Format>NTFS</Format>
+							<Active>true</Active>
+						</ModifyPartition>
+						<!-- Windows partition -->
+						<ModifyPartition wcm:action="add">  not exist this item
+							<Order>2</Order>
+							<PartitionID>2</PartitionID>
+							<Label>Windows</Label>
+							<Letter>C</Letter>
+							<Format>NTFS</Format>
 						</ModifyPartition>
 					</ModifyPartitions>
 					<DiskID>0</DiskID>
@@ -67,17 +95,20 @@
 					<InstallFrom>
 						<MetaData wcm:action="add">
 							<Key>/IMAGE/NAME</Key>
+		<!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+		<!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
 							<Value>Windows Server 2016 SERVERDATACENTER</Value>
 						</MetaData>
 					</InstallFrom>
 					<InstallTo>
 						<DiskID>0</DiskID>
-						<PartitionID>1</PartitionID>
+						<PartitionID>2</PartitionID>
 					</InstallTo>
 				</OSImage>
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		<!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -121,9 +152,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+	<TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+	<!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -136,90 +169,154 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+	<!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+        <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <!-- Disable console quickedit mode to prevent stuck of command executions -->
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Console" /v QuickEdit /t REG_DWORD /d 0 /f</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>11</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\NewNetworks" /v NetworkList /t REG_MULTI_SZ /d "" /f</CommandLine>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c dism /online /Enable-Feature /FeatureName:TelnetServer</CommandLine>
-					<Order>3</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat.cer</CommandLine>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>9</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>10</Order>
+	<!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>11</Order>
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>12</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>15</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\Dism /online /enable-feature /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess</CommandLine>
-					<Order>16</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
+	<!-- Enable .Net Framework version 3.X, and write down the log -->
+					<Order>23</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>17</Order>
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>18</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>19</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /All /LimitAccess /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+	<!-- Enable PowerShell, and write down the log -->
+	<!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>26</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\StartPage /v OpenAtLogon /t REG_DWORD /d 0 /f</CommandLine>
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>28</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>29</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>30</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>31</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>32</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
+        <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>33</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/win2016-autounattend_ovmf.xml b/shared/unattended/win2016-autounattend_ovmf.xml
index b52d2dfd..d3e93341 100644
--- a/shared/unattended/win2016-autounattend_ovmf.xml
+++ b/shared/unattended/win2016-autounattend_ovmf.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -39,54 +54,56 @@
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
 			<DiskConfiguration>
 				<WillShowUI>OnError</WillShowUI>
-                                <Disk wcm:action="add">
-                                        <CreatePartitions>
-                                                <!-- EFI system partition (ESP) -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>1</Order>
-                                                  <Type>EFI</Type>
-                                                  <Size>100</Size>
-                                                </CreatePartition>
-                                                <!-- Microsoft reserved partition (MSR) -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>2</Order>
-                                                  <Type>MSR</Type>
-                                                  <Size>128</Size>
-                                                </CreatePartition>
-                                                <!-- Windows partition -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>3</Order>
-                                                  <Type>Primary</Type>
-                                                  <Extend>true</Extend>
-                                                </CreatePartition>
-                                        </CreatePartitions>
-                                        <ModifyPartitions>
-                                                <!-- EFI system partition (ESP) -->
-                                                <ModifyPartition wcm:action="add">
-                                                  <Order>1</Order>
-                                                  <PartitionID>1</PartitionID>
-                                                  <Label>System</Label>
-                                                  <Format>FAT32</Format>
-                                                </ModifyPartition>
-                                                <!-- MSR partition does not need to be modified -->
-                                                <!-- Windows partition -->
-                                                <ModifyPartition wcm:action="add">
-                                                  <Order>2</Order>
-                                                  <PartitionID>3</PartitionID>
-                                                  <Label>Windows</Label>
-                                                  <Letter>C</Letter>
-                                                  <Format>NTFS</Format>
-                                                </ModifyPartition>
-                                        </ModifyPartitions>
-                                        <DiskID>0</DiskID>
-                                        <WillWipeDisk>true</WillWipeDisk>
-                                </Disk>
+				<Disk wcm:action="add">
+					<CreatePartitions>
+						<!-- EFI system partition (ESP) -->
+						<CreatePartition wcm:action="add">
+							<Order>1</Order>
+							<Type>EFI</Type>
+							<Size>260</Size>
+						</CreatePartition>
+						<!-- Microsoft reserved partition (MSR) -->
+						<CreatePartition wcm:action="add">
+							<Order>2</Order>
+							<Type>MSR</Type>
+							<Size>128</Size>
+						</CreatePartition>
+						<!-- Windows partition -->
+						<CreatePartition wcm:action="add">
+							<Order>3</Order>
+							<Type>Primary</Type>
+							<Extend>true</Extend>
+						</CreatePartition>
+					</CreatePartitions>
+					<ModifyPartitions>
+						<!-- EFI system partition (ESP) -->
+						<ModifyPartition wcm:action="add">
+							<Order>1</Order>
+							<PartitionID>1</PartitionID>
+							<Label>System</Label>
+							<Format>FAT32</Format>
+						</ModifyPartition>
+						<!-- MSR partition does not need to be modified -->
+						<!-- Windows partition -->
+						<ModifyPartition wcm:action="add">
+							<Order>2</Order>
+							<PartitionID>3</PartitionID>
+							<Label>Windows</Label>
+							<Letter>C</Letter>
+							<Format>NTFS</Format>
+						</ModifyPartition>
+					</ModifyPartitions>
+					<DiskID>0</DiskID>
+					<WillWipeDisk>true</WillWipeDisk>
+				</Disk>
 			</DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
 					<InstallFrom>
 						<MetaData wcm:action="add">
 							<Key>/IMAGE/NAME</Key>
+		<!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+		<!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
 							<Value>Windows Server 2016 SERVERDATACENTER</Value>
 						</MetaData>
 					</InstallFrom>
@@ -98,6 +115,7 @@
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		<!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -141,9 +159,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+	<TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+	<!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -156,90 +176,154 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+	<!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                            <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+        <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <!-- Disable console quickedit mode to prevent stuck of command executions -->
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Console" /v QuickEdit /t REG_DWORD /d 0 /f</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>11</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\NewNetworks" /v NetworkList /t REG_MULTI_SZ /d "" /f</CommandLine>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c dism /online /Enable-Feature /FeatureName:TelnetServer</CommandLine>
-					<Order>3</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat.cer</CommandLine>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>9</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>10</Order>
+	<!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>11</Order>
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>12</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>15</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\Dism /online /enable-feature /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess</CommandLine>
-					<Order>16</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
+	<!-- Enable .Net Framework version 3.X, and write down the log -->
+					<Order>23</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>17</Order>
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>18</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>19</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /All /LimitAccess /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+	<!-- Enable PowerShell, and write down the log -->
+	<!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>26</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\StartPage /v OpenAtLogon /t REG_DWORD /d 0 /f</CommandLine>
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>28</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>29</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>30</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>31</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>32</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
+        <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>33</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/win2019-autounattend.xml b/shared/unattended/win2019-autounattend.xml
index f5359e25..970bd24c 100644
--- a/shared/unattended/win2019-autounattend.xml
+++ b/shared/unattended/win2019-autounattend.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -171,85 +186,85 @@
                                         <Order>2</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <!-- Disable console quickedit mode to prevent stuck of command executions -->
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Console" /v QuickEdit /t REG_DWORD /d 0 /f</CommandLine>
                                         <Order>3</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
                                         <Order>4</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
                                         <Order>5</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
                                         <Order>6</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
                                         <Order>7</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
                                         <Order>8</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
                                         <Order>9</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
                                         <Order>10</Order>
                                 </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>11</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\NewNetworks" /v NetworkList /t REG_MULTI_SZ /d "" /f</CommandLine>
-					<Order>11</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat.cer</CommandLine>
-					<Order>12</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>13</Order>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
-					<Order>14</Order>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>15</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>16</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
 	<!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
-					<Order>17</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
 					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
+					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
 					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
+					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
 					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
+					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
 					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
-	<!-- Enable .Net Framework version 3.X, and write down the log -->
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
 					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
@@ -260,40 +275,45 @@
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
 					<Order>24</Order>
 				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
+	<!-- Enable .Net Framework version 3.X, and write down the log -->
+					<Order>25</Order>
+				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /All /LimitAccess /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
 	<!-- Enable PowerShell, and write down the log -->
 	<!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
-					<Order>25</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\StartPage /v OpenAtLogon /t REG_DWORD /d 0 /f</CommandLine>
-					<Order>26</Order>
+					<Order>27</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
-					<Order>27</Order>
+					<Order>28</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
-					<Order>28</Order>
+					<Order>29</Order>
 				</SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
                                         <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
-                                        <Order>29</Order>
+                                        <Order>30</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
                                         <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
-                                        <Order>30</Order>
+                                        <Order>31</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
                                         <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
-                                        <Order>31</Order>
+                                        <Order>32</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
                                         <CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
         <!-- When modifying cmds, pls keep finish.bat always the last one. -->
-                                        <Order>32</Order>
+                                        <Order>33</Order>
                                 </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
diff --git a/shared/unattended/win2019-autounattend_ovmf.xml b/shared/unattended/win2019-autounattend_ovmf.xml
index 68a56d6a..3b157f3e 100644
--- a/shared/unattended/win2019-autounattend_ovmf.xml
+++ b/shared/unattended/win2019-autounattend_ovmf.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -45,7 +60,7 @@
                                                 <CreatePartition wcm:action="add">
                                                         <Order>1</Order>
                                                         <Type>EFI</Type>
-                                                        <Size>100</Size>
+                                                        <Size>260</Size>
                                                 </CreatePartition>
                                                 <!-- Microsoft reserved partition (MSR) -->
                                                 <CreatePartition wcm:action="add">
@@ -178,85 +193,85 @@
                                         <Order>2</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <!-- Disable console quickedit mode to prevent stuck of command executions -->
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Console" /v QuickEdit /t REG_DWORD /d 0 /f</CommandLine>
                                         <Order>3</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
                                         <Order>4</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
                                         <Order>5</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
                                         <Order>6</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
                                         <Order>7</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
                                         <Order>8</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
                                         <Order>9</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
-                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
                                         <Order>10</Order>
                                 </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>11</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\NewNetworks" /v NetworkList /t REG_MULTI_SZ /d "" /f</CommandLine>
-					<Order>11</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat.cer</CommandLine>
-					<Order>12</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>13</Order>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
-					<Order>14</Order>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>15</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>16</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
 	<!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
-					<Order>17</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
 					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
+					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
 					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
+					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
 					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
+					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
 					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
-	<!-- Enable .Net Framework version 3.X, and write down the log -->
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
 					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
@@ -267,40 +282,45 @@
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
 					<Order>24</Order>
 				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
+	<!-- Enable .Net Framework version 3.X, and write down the log -->
+					<Order>25</Order>
+				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /All /LimitAccess /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
 	<!-- Enable PowerShell, and write down the log -->
 	<!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
-					<Order>25</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\StartPage /v OpenAtLogon /t REG_DWORD /d 0 /f</CommandLine>
-					<Order>26</Order>
+					<Order>27</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
-					<Order>27</Order>
+					<Order>28</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
-					<Order>28</Order>
+					<Order>29</Order>
 				</SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
                                         <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
-                                        <Order>29</Order>
+                                        <Order>30</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
                                         <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
-                                        <Order>30</Order>
+                                        <Order>31</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
                                         <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
-                                        <Order>31</Order>
+                                        <Order>32</Order>
                                 </SynchronousCommand>
                                 <SynchronousCommand wcm:action="add">
                                         <CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
         <!-- When modifying cmds, pls keep finish.bat always the last one. -->
-                                        <Order>32</Order>
+                                        <Order>33</Order>
                                 </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
diff --git a/shared/unattended/win7-32-autounattend.xml b/shared/unattended/win7-32-autounattend.xml
index c3761a9f..334d9321 100644
--- a/shared/unattended/win7-32-autounattend.xml
+++ b/shared/unattended/win7-32-autounattend.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -37,41 +52,63 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
+                        <DiskConfiguration>
 				<WillShowUI>OnError</WillShowUI>
 				<Disk wcm:action="add">
 					<CreatePartitions>
-						<CreatePartition wcm:action="add">
-							<Order>1</Order>
-							<Size>30000</Size>
-							<Type>Primary</Type>
-						</CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>1</Order>
+					                <Size>300</Size>
+					                <Type>Primary</Type>
+					        </CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>2</Order>
+					                <Extend>true</Extend>
+					                <Type>Primary</Type>
+					        </CreatePartition>
 					</CreatePartitions>
 					<ModifyPartitions>
-						<ModifyPartition wcm:action="add">
-							<Active>true</Active>
-							<Extend>false</Extend>
-							<Format>NTFS</Format>
-							<Label>OS_Install</Label>
-							<Letter>C</Letter>
-							<Order>1</Order>
-							<PartitionID>1</PartitionID>
-						</ModifyPartition>
+					        <!-- System partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>1</Order>
+					                <PartitionID>1</PartitionID>
+					                <Label>System</Label>
+					                <Letter>S</Letter>
+					                <Format>NTFS</Format>
+					                <Active>true</Active>
+					        </ModifyPartition>
+					        <!-- Windows partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>2</Order>
+					                <PartitionID>2</PartitionID>
+					                <Label>Windows</Label>
+					                <Letter>C</Letter>
+					                <Format>NTFS</Format>
+					        </ModifyPartition>
 					</ModifyPartitions>
 					<DiskID>0</DiskID>
 					<WillWipeDisk>true</WillWipeDisk>
 				</Disk>
-			</DiskConfiguration>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
+					<InstallFrom>
+						<MetaData wcm:action="add">
+							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
+							<Value>Windows 7 ULTIMATE</Value>
+						</MetaData>
+					</InstallFrom>
 					<InstallTo>
-						<DiskID>0</DiskID>
-						<PartitionID>1</PartitionID>
+					        <DiskID>0</DiskID>
+					        <PartitionID>2</PartitionID>
 					</InstallTo>
 				</OSImage>
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -96,16 +133,6 @@
 					<Order>2</Order>
 					<Path>cmd /c reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v FilterAdministratorToken /t REG_DWORD /d 0 /f</Path>
 				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>3</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>4</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
 			</RunSynchronous>
 		</component>
 		<component name="Microsoft-Windows-International-Core"
@@ -125,9 +152,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -140,90 +169,170 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat_win7.cer</CommandLine>
+					<Order>11</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c start /w pkgmgr /iu:"TelnetServer"</CommandLine>
-					<Order>3</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>9</Order>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>10</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>11</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>12</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>13</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>15</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>16</Order>
+					<Order>23</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log. these options are not supported on this OS: /All /LimitAccess -->
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>17</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_32.bat</CommandLine>
-					<Order>18</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>19</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log, and write down the log. these options are not supported on this OS: /All /LimitAccess -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</CommandLine>
+					<Order>28</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- these two registry update makes ahci bootable, NT6.0 or NT6.1 needs http://support.microsoft.com/kb/922976 -->
+					<Order>29</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>30</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+                                        <Order>31</Order>
+                                </SynchronousCommand>
+                               <SynchronousCommand wcm:action="add">
+				       <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\msu\windows6.1-kb4486563-x86.msu /quiet /norestart</CommandLine>
+					<Order>32</Order>
 				</SynchronousCommand>
+                               <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows6.1-kb4056894-x86.msu /quiet /norestart</CommandLine>
+                                        <Order>33</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>34</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>35</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>36</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>37</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/win7-64-autounattend.xml b/shared/unattended/win7-64-autounattend.xml
index 83075564..959112df 100644
--- a/shared/unattended/win7-64-autounattend.xml
+++ b/shared/unattended/win7-64-autounattend.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -37,41 +52,63 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
+                        <DiskConfiguration>
 				<WillShowUI>OnError</WillShowUI>
 				<Disk wcm:action="add">
 					<CreatePartitions>
-						<CreatePartition wcm:action="add">
-							<Order>1</Order>
-							<Size>30000</Size>
-							<Type>Primary</Type>
-						</CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>1</Order>
+					                <Size>300</Size>
+					                <Type>Primary</Type>
+					        </CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>2</Order>
+					                <Extend>true</Extend>
+					                <Type>Primary</Type>
+					        </CreatePartition>
 					</CreatePartitions>
 					<ModifyPartitions>
-						<ModifyPartition wcm:action="add">
-							<Active>true</Active>
-							<Extend>false</Extend>
-							<Format>NTFS</Format>
-							<Label>OS_Install</Label>
-							<Letter>C</Letter>
-							<Order>1</Order>
-							<PartitionID>1</PartitionID>
-						</ModifyPartition>
+					        <!-- System partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>1</Order>
+					                <PartitionID>1</PartitionID>
+					                <Label>System</Label>
+					                <Letter>S</Letter>
+					                <Format>NTFS</Format>
+					                <Active>true</Active>
+					        </ModifyPartition>
+					        <!-- Windows partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>2</Order>
+					                <PartitionID>2</PartitionID>
+					                <Label>Windows</Label>
+					                <Letter>C</Letter>
+					                <Format>NTFS</Format>
+					        </ModifyPartition>
 					</ModifyPartitions>
 					<DiskID>0</DiskID>
 					<WillWipeDisk>true</WillWipeDisk>
 				</Disk>
-			</DiskConfiguration>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
+					<InstallFrom>
+						<MetaData wcm:action="add">
+							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
+							<Value>Windows 7 ULTIMATE</Value>
+						</MetaData>
+					</InstallFrom>
 					<InstallTo>
-						<DiskID>0</DiskID>
-						<PartitionID>1</PartitionID>
+					        <DiskID>0</DiskID>
+					        <PartitionID>2</PartitionID>
 					</InstallTo>
 				</OSImage>
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -96,16 +133,6 @@
 					<Order>2</Order>
 					<Path>cmd /c reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v FilterAdministratorToken /t REG_DWORD /d 0 /f</Path>
 				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>3</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>4</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
 			</RunSynchronous>
 		</component>
 		<component name="Microsoft-Windows-International-Core"
@@ -125,9 +152,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -140,86 +169,175 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat_win7.cer</CommandLine>
+					<Order>11</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c start /w pkgmgr /iu:"TelnetServer"</CommandLine>
-					<Order>3</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>9</Order>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>10</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>11</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>12</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>15</Order>
+					<Order>23</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log. these options are not supported on this OS: /All /LimitAccess -->
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>16</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>17</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>18</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log, and write down the log. these options are not supported on this OS: /All /LimitAccess -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</CommandLine>
+					<Order>28</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- these two registry update makes ahci bootable, NT6.0 or NT6.1 needs http://support.microsoft.com/kb/922976 -->
+					<Order>29</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>30</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>31</Order>
 				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+	<!---BZ# 1266075 -->
+					<CommandLine>%WINDIR%\System32\cmd /c %WINDIR%\System32\wusa.exe E:\msu\Windows6.1-KB2528507-x64.msu /quiet /norestart</CommandLine>
+					<Order>32</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+          <CommandLine>%WINDIR%\System32\cmd /c %WINDIR%\System32\wusa.exe E:\msu\windows6.1-kb4486563-x64.msu /quiet /norestart</CommandLine>
+          <Order>33</Order>
+        </SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+          <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows6.1-kb4056894-x64.msu /quiet /norestart</CommandLine>
+          <Order>34</Order>
+        </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>35</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>36</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>37</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>38</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/win7-64-autounattend_ovmf.xml b/shared/unattended/win7-64-autounattend_ovmf.xml
index b37471c9..6a80feb5 100644
--- a/shared/unattended/win7-64-autounattend_ovmf.xml
+++ b/shared/unattended/win7-64-autounattend_ovmf.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -37,53 +52,61 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
+                        <DiskConfiguration>
 				<WillShowUI>OnError</WillShowUI>
-                                <Disk wcm:action="add">
-                                        <CreatePartitions>
-                                                <!-- EFI system partition (ESP) -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>1</Order>
-                                                  <Type>EFI</Type>
-                                                  <Size>100</Size>
-                                                </CreatePartition>
-                                                <!-- Microsoft reserved partition (MSR) -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>2</Order>
-                                                  <Type>MSR</Type>
-                                                  <Size>128</Size>
-                                                </CreatePartition>
-                                                <!-- Windows partition -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>3</Order>
-                                                  <Type>Primary</Type>
-                                                  <Extend>true</Extend>
-                                                </CreatePartition>
-                                        </CreatePartitions>
-                                        <ModifyPartitions>
-                                                <!-- EFI system partition (ESP) -->
-                                                <ModifyPartition wcm:action="add">
-                                                  <Order>1</Order>
-                                                  <PartitionID>1</PartitionID>
-                                                  <Label>System</Label>
-                                                  <Format>FAT32</Format>
-                                                </ModifyPartition>
-                                                <!-- MSR partition does not need to be modified -->
-                                                <!-- Windows partition -->
-                                                <ModifyPartition wcm:action="add">
-                                                  <Order>2</Order>
-                                                  <PartitionID>3</PartitionID>
-                                                  <Label>Windows</Label>
-                                                  <Letter>C</Letter>
-                                                  <Format>NTFS</Format>
-                                                </ModifyPartition>
-                                        </ModifyPartitions>
-                                        <DiskID>0</DiskID>
-                                        <WillWipeDisk>true</WillWipeDisk>
-                                </Disk>
-			</DiskConfiguration>
+				<Disk wcm:action="add">
+					<CreatePartitions>
+					        <!-- EFI system partition (ESP) -->
+					        <CreatePartition wcm:action="add">
+					          <Order>1</Order>
+					          <Type>EFI</Type>
+					          <Size>100</Size>
+					        </CreatePartition>
+					        <!-- Microsoft reserved partition (MSR) -->
+					        <CreatePartition wcm:action="add">
+					          <Order>2</Order>
+					          <Type>MSR</Type>
+					          <Size>128</Size>
+					        </CreatePartition>
+					        <!-- Windows partition -->
+					        <CreatePartition wcm:action="add">
+					          <Order>3</Order>
+					          <Type>Primary</Type>
+					          <Extend>true</Extend>
+					        </CreatePartition>
+					</CreatePartitions>
+					<ModifyPartitions>
+					        <!-- EFI system partition (ESP) -->
+					        <ModifyPartition wcm:action="add">
+					          <Order>1</Order>
+					          <PartitionID>1</PartitionID>
+					          <Label>System</Label>
+					          <Format>FAT32</Format>
+					        </ModifyPartition>
+					        <!-- MSR partition does not need to be modified -->
+					        <!-- Windows partition -->
+					        <ModifyPartition wcm:action="add">
+					          <Order>2</Order>
+					          <PartitionID>3</PartitionID>
+					          <Label>Windows</Label>
+					          <Letter>C</Letter>
+					          <Format>NTFS</Format>
+					        </ModifyPartition>
+					</ModifyPartitions>
+					<DiskID>0</DiskID>
+					<WillWipeDisk>true</WillWipeDisk>
+				</Disk>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
+					<InstallFrom>
+						<MetaData wcm:action="add">
+							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
+							<Value>Windows 7 ULTIMATE</Value>
+						</MetaData>
+					</InstallFrom>
 					<InstallTo>
 						<DiskID>0</DiskID>
 						<PartitionID>3</PartitionID>
@@ -92,6 +115,7 @@
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -116,16 +140,6 @@
 					<Order>2</Order>
 					<Path>cmd /c reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v FilterAdministratorToken /t REG_DWORD /d 0 /f</Path>
 				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>3</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
-				<RunSynchronousCommand wcm:action="add">
-					<Description>SataBootable</Description>
-					<Order>4</Order>
-					<Path>cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</Path>
-				</RunSynchronousCommand>
 			</RunSynchronous>
 		</component>
 		<component name="Microsoft-Windows-International-Core"
@@ -145,9 +159,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -160,86 +176,175 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat_win7.cer</CommandLine>
+					<Order>11</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c start /w pkgmgr /iu:"TelnetServer"</CommandLine>
-					<Order>3</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>9</Order>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>10</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>11</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>12</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>15</Order>
+					<Order>23</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log. these options are not supported on this OS: /All /LimitAccess -->
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>16</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>17</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>18</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log, and write down the log. these options are not supported on this OS: /All /LimitAccess -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</CommandLine>
+					<Order>28</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- these two registry update makes ahci bootable, NT6.0 or NT6.1 needs http://support.microsoft.com/kb/922976 -->
+					<Order>29</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>30</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>31</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+        <!---BZ# 1266075 -->
+					<CommandLine>%WINDIR%\System32\cmd /c %WINDIR%\System32\wusa.exe E:\msu\Windows6.1-KB2528507-x64.msu /quiet /norestart</CommandLine>
+					<Order>32</Order>
 				</SynchronousCommand>
+                               <SynchronousCommand wcm:action="add">
+                                       <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\msu\windows6.1-kb4486563-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>33</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows6.1-kb4056894-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>34</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>35</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>36</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>37</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>38</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/win8-32-autounattend.xml b/shared/unattended/win8-32-autounattend.xml
index 4fa9641b..50c52697 100644
--- a/shared/unattended/win8-32-autounattend.xml
+++ b/shared/unattended/win8-32-autounattend.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -37,41 +52,63 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
+                        <DiskConfiguration>
 				<WillShowUI>OnError</WillShowUI>
 				<Disk wcm:action="add">
 					<CreatePartitions>
-						<CreatePartition wcm:action="add">
-							<Order>1</Order>
-							<Size>30000</Size>
-							<Type>Primary</Type>
-						</CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>1</Order>
+					                <Size>300</Size>
+					                <Type>Primary</Type>
+					        </CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>2</Order>
+					                <Extend>true</Extend>
+					                <Type>Primary</Type>
+					        </CreatePartition>
 					</CreatePartitions>
 					<ModifyPartitions>
-						<ModifyPartition wcm:action="add">
-							<Active>true</Active>
-							<Extend>false</Extend>
-							<Format>NTFS</Format>
-							<Label>OS_Install</Label>
-							<Letter>C</Letter>
-							<Order>1</Order>
-							<PartitionID>1</PartitionID>
-						</ModifyPartition>
+					        <!-- System partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>1</Order>
+					                <PartitionID>1</PartitionID>
+					                <Label>System</Label>
+					                <Letter>S</Letter>
+					                <Format>NTFS</Format>
+					                <Active>true</Active>
+					        </ModifyPartition>
+					        <!-- Windows partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>2</Order>
+					                <PartitionID>2</PartitionID>
+					                <Label>Windows</Label>
+					                <Letter>C</Letter>
+					                <Format>NTFS</Format>
+					        </ModifyPartition>
 					</ModifyPartitions>
 					<DiskID>0</DiskID>
 					<WillWipeDisk>true</WillWipeDisk>
 				</Disk>
-			</DiskConfiguration>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
+					<InstallFrom>
+						<MetaData wcm:action="add">
+							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
+							<Value>Windows 8 Enterprise</Value>
+						</MetaData>
+					</InstallFrom>
 					<InstallTo>
-						<DiskID>0</DiskID>
-						<PartitionID>1</PartitionID>
+					        <DiskID>0</DiskID>
+					        <PartitionID>2</PartitionID>
 					</InstallTo>
 				</OSImage>
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -115,9 +152,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -130,94 +169,172 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat.cer</CommandLine>
+					<Order>11</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c dism /online /Enable-Feature /FeatureName:TelnetServer</CommandLine>
-					<Order>3</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>9</Order>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>10</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>11</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>12</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>13</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>15</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>16</Order>
+					<Order>23</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-				        <CommandLine>%WINDIR%\System32\Dism /online /enable-feature /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess</CommandLine>
-				        <Order>17</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log -->
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>18</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_32.bat</CommandLine>
-					<Order>19</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>20</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /All /LimitAccess /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c echo "NT6.2 or later can boot from AHCI without modify anything, keep this line to make cmd num on all Win OS same"</CommandLine>
+					<!-- <CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</CommandLine> -->
+					<Order>28</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c echo "NT6.2 or later can boot from AHCI without modify anything, keep this line to make cmd num on all Win OS same"</CommandLine>
+					<!-- <CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</CommandLine> -->
+          <!-- these two registry update makes ahci bootable, NT6.0 or NT6.1 needs http://support.microsoft.com/kb/922976 -->
+					<Order>29</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c SCHTASKS /Create /SC ONLOGON /TN Desktop-Start-W8 /TR explorer</CommandLine>
+					<Order>30</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>31</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>32</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows8-rt-kb4056896-x86.msu /quiet /norestart</CommandLine>
+                                        <Order>33</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>34</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>35</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>36</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>37</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/win8-64-autounattend.xml b/shared/unattended/win8-64-autounattend.xml
index c7e74a88..1109a2ae 100644
--- a/shared/unattended/win8-64-autounattend.xml
+++ b/shared/unattended/win8-64-autounattend.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -37,41 +52,63 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
-				<WillShowUI>OnError</WillShowUI>
-				<Disk wcm:action="add">
+                        <DiskConfiguration>
+                                <WillShowUI>OnError</WillShowUI>
+                                <Disk wcm:action="add">
 					<CreatePartitions>
-						<CreatePartition wcm:action="add">
-							<Order>1</Order>
-							<Size>30000</Size>
-							<Type>Primary</Type>
-						</CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>1</Order>
+					                <Size>300</Size>
+					                <Type>Primary</Type>
+					        </CreatePartition>
+					        <CreatePartition wcm:action="add">
+					                <Order>2</Order>
+					                <Extend>true</Extend>
+					                <Type>Primary</Type>
+					        </CreatePartition>
 					</CreatePartitions>
 					<ModifyPartitions>
-						<ModifyPartition wcm:action="add">
-							<Active>true</Active>
-							<Extend>false</Extend>
-							<Format>NTFS</Format>
-							<Label>OS_Install</Label>
-							<Letter>C</Letter>
-							<Order>1</Order>
-							<PartitionID>1</PartitionID>
-						</ModifyPartition>
+					        <!-- System partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>1</Order>
+					                <PartitionID>1</PartitionID>
+					                <Label>System</Label>
+					                <Letter>S</Letter>
+					                <Format>NTFS</Format>
+					                <Active>true</Active>
+					        </ModifyPartition>
+					        <!-- Windows partition -->
+					        <ModifyPartition wcm:action="add">
+					                <Order>2</Order>
+					                <PartitionID>2</PartitionID>
+					                <Label>Windows</Label>
+					                <Letter>C</Letter>
+					                <Format>NTFS</Format>
+					        </ModifyPartition>
 					</ModifyPartitions>
 					<DiskID>0</DiskID>
 					<WillWipeDisk>true</WillWipeDisk>
-				</Disk>
-			</DiskConfiguration>
+                                </Disk>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
+					<InstallFrom>
+						<MetaData wcm:action="add">
+							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
+							<Value>Windows 8 Enterprise</Value>
+						</MetaData>
+					</InstallFrom>
 					<InstallTo>
-						<DiskID>0</DiskID>
-						<PartitionID>1</PartitionID>
+					        <DiskID>0</DiskID>
+					        <PartitionID>2</PartitionID>
 					</InstallTo>
 				</OSImage>
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -115,9 +152,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -130,90 +169,172 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat.cer</CommandLine>
+					<Order>11</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c dism /online /Enable-Feature /FeatureName:TelnetServer</CommandLine>
-					<Order>3</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>9</Order>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>10</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>11</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>12</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>15</Order>
+					<Order>23</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\Dism /online /enable-feature /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess</CommandLine>
-					<Order>16</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log -->
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>17</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>18</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>19</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /All /LimitAccess /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>27</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c echo "NT6.2 or later can boot from AHCI without modify anything, keep this line to make cmd num on all Win OS same"</CommandLine>
+					<!-- <CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Msahci /v Start /t REG_DWORD /d 0 /f</CommandLine> -->
+					<Order>28</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c echo "NT6.2 or later can boot from AHCI without modify anything, keep this line to make cmd num on all Win OS same"</CommandLine>
+					<!-- <CommandLine>%WINDIR%\System32\cmd /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IastorV /v Start /t REG_DWORD /d 0 /f</CommandLine> -->
+          <!-- these two registry update makes ahci bootable, NT6.0 or NT6.1 needs http://support.microsoft.com/kb/922976 -->
+					<Order>29</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c SCHTASKS /Create /SC ONLOGON /TN Desktop-Start-W8 /TR explorer</CommandLine>
+					<Order>30</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>31</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>32</Order>
 				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows8-rt-kb4056896-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>33</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>34</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>35</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>36</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>37</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/win8-64-autounattend_ovmf.xml b/shared/unattended/win8-64-autounattend_ovmf.xml
index 2487277a..4d46f98a 100644
--- a/shared/unattended/win8-64-autounattend_ovmf.xml
+++ b/shared/unattended/win8-64-autounattend_ovmf.xml
@@ -30,6 +30,21 @@
 				<PathAndCredentials wcm:keyValue="3" wcm:action="add">
 					<Path>KVM_TEST_NETWORK_DRIVER_PATH</Path>
 				</PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="4" wcm:action="add">
+                                        <Path>KVM_TEST_BALLOON_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="5" wcm:action="add">
+                                        <Path>KVM_TEST_VIORNG_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="6" wcm:action="add">
+                                        <Path>KVM_TEST_VIOSER_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="7" wcm:action="add">
+                                        <Path>KVM_TEST_VIOINPUT_DRIVER_PATH</Path>
+                                </PathAndCredentials>
+                                <PathAndCredentials wcm:keyValue="8" wcm:action="add">
+                                        <Path>KVM_TEST_PVPANIC_DRIVER_PATH</Path>
+                                </PathAndCredentials>
 			</DriverPaths>
 		</component>
 		<component name="Microsoft-Windows-Setup"
@@ -37,53 +52,61 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
-			<DiskConfiguration>
+                        <DiskConfiguration>
 				<WillShowUI>OnError</WillShowUI>
-                                <Disk wcm:action="add">
-                                        <CreatePartitions>
-                                                <!-- EFI system partition (ESP) -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>1</Order>
-                                                  <Type>EFI</Type>
-                                                  <Size>100</Size>
-                                                </CreatePartition>
-                                                <!-- Microsoft reserved partition (MSR) -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>2</Order>
-                                                  <Type>MSR</Type>
-                                                  <Size>128</Size>
-                                                </CreatePartition>
-                                                <!-- Windows partition -->
-                                                <CreatePartition wcm:action="add">
-                                                  <Order>3</Order>
-                                                  <Type>Primary</Type>
-                                                  <Extend>true</Extend>
-                                                </CreatePartition>
-                                        </CreatePartitions>
-                                        <ModifyPartitions>
-                                                <!-- EFI system partition (ESP) -->
-                                                <ModifyPartition wcm:action="add">
-                                                  <Order>1</Order>
-                                                  <PartitionID>1</PartitionID>
-                                                  <Label>System</Label>
-                                                  <Format>FAT32</Format>
-                                                </ModifyPartition>
-                                                <!-- MSR partition does not need to be modified -->
-                                                <!-- Windows partition -->
-                                                <ModifyPartition wcm:action="add">
-                                                  <Order>2</Order>
-                                                  <PartitionID>3</PartitionID>
-                                                  <Label>Windows</Label>
-                                                  <Letter>C</Letter>
-                                                  <Format>NTFS</Format>
-                                                </ModifyPartition>
-                                        </ModifyPartitions>
-                                        <DiskID>0</DiskID>
-                                        <WillWipeDisk>true</WillWipeDisk>
-                                </Disk>
-			</DiskConfiguration>
+				<Disk wcm:action="add">
+					<CreatePartitions>
+					        <!-- EFI system partition (ESP) -->
+					        <CreatePartition wcm:action="add">
+					          <Order>1</Order>
+					          <Type>EFI</Type>
+					          <Size>260</Size>
+					        </CreatePartition>
+					        <!-- Microsoft reserved partition (MSR) -->
+					        <CreatePartition wcm:action="add">
+					          <Order>2</Order>
+					          <Type>MSR</Type>
+					          <Size>128</Size>
+					        </CreatePartition>
+					        <!-- Windows partition -->
+					        <CreatePartition wcm:action="add">
+					          <Order>3</Order>
+					          <Type>Primary</Type>
+					          <Extend>true</Extend>
+					        </CreatePartition>
+					</CreatePartitions>
+					<ModifyPartitions>
+					        <!-- EFI system partition (ESP) -->
+					        <ModifyPartition wcm:action="add">
+					          <Order>1</Order>
+					          <PartitionID>1</PartitionID>
+					          <Label>System</Label>
+					          <Format>FAT32</Format>
+					        </ModifyPartition>
+					        <!-- MSR partition does not need to be modified -->
+					        <!-- Windows partition -->
+					        <ModifyPartition wcm:action="add">
+					          <Order>2</Order>
+					          <PartitionID>3</PartitionID>
+					          <Label>Windows</Label>
+					          <Letter>C</Letter>
+					          <Format>NTFS</Format>
+					        </ModifyPartition>
+					</ModifyPartitions>
+					<DiskID>0</DiskID>
+					<WillWipeDisk>true</WillWipeDisk>
+				</Disk>
+                        </DiskConfiguration>
 			<ImageInstall>
 				<OSImage>
+					<InstallFrom>
+						<MetaData wcm:action="add">
+							<Key>/IMAGE/NAME</Key>
+              <!--This index depends on your install ISO. Please update to a proper one if install failed. http://technet.microsoft.com/en-us/library/ff716384.aspx -->
+              <!-- use "dism /get-wiminfo /wimfile:D:\sources\install.wim" to know which value should be used.-->
+							<Value>Windows 8 Enterprise</Value>
+						</MetaData>
+					</InstallFrom>
 					<InstallTo>
 						<DiskID>0</DiskID>
 						<PartitionID>3</PartitionID>
@@ -92,6 +115,7 @@
 			</ImageInstall>
 			<UserData>
 				<ProductKey>
+		      <!-- Work with Product Keys and Activation http://technet.microsoft.com/en-us/library/hh825195.aspx -->
 					<Key>KVM_TEST_CDKEY</Key>
 					<WillShowUI>OnError</WillShowUI>
 				</ProductKey>
@@ -135,9 +159,11 @@
 			language="neutral" versionScope="nonSxS"
 			xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
 			xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+      <TimeZone>China Standard Time</TimeZone>
 			<UserAccounts>
+      <!-- Enable the Built-in Administrator Account Starts http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 				<AdministratorPassword>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</AdministratorPassword>
 			</UserAccounts>
@@ -150,90 +176,161 @@
 			</OOBE>
 			<AutoLogon>
 				<Password>
-					<Value>1q2w3eP</Value>
+					<Value>Kvm_autotest</Value>
 					<PlainText>true</PlainText>
 				</Password>
 				<Enabled>true</Enabled>
 				<LogonCount>1000</LogonCount>
 				<Username>Administrator</Username>
+      <!-- Enable the Built-in Administrator Account End http://technet.microsoft.com/en-us/library/hh825104.aspx -->
 			</AutoLogon>
 			<FirstLogonCommands>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c echo OS install is completed > COM1</CommandLine>
 					<Order>1</Order>
 				</SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c reg add "HKCU\Control Panel\Desktop" /v ScreenSaveActive /t REG_DWORD /d 0 /f</CommandLine>
+          <!-- Disable screen saver to let us always can see what happen in guest OS -->
+                                        <Order>2</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-ac 0</CommandLine>
+                                        <Order>3</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change monitor-timeout-dc 0</CommandLine>
+                                        <Order>4</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-ac 0</CommandLine>
+                                        <Order>5</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change disk-timeout-dc 0</CommandLine>
+                                        <Order>6</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-ac 0</CommandLine>
+                                        <Order>7</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change standby-timeout-dc 0</CommandLine>
+                                        <Order>8</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-ac 0</CommandLine>
+                                        <Order>9</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c powercfg -Change hibernate-timeout-dc 0</CommandLine>
+                                        <Order>10</Order>
+                                </SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_NETWORK_INSTALLER</CommandLine>
-					<Order>2</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c certutil -addstore -f TrustedPublisher E:\redhat.cer</CommandLine>
+					<Order>11</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c dism /online /Enable-Feature /FeatureName:TelnetServer</CommandLine>
-					<Order>3</Order>
+					<Order>12</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c sc config TlntSvr start= auto</CommandLine>
-					<Order>4</Order>
+					<Order>13</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c netsh firewall set opmode disable</CommandLine>
-					<Order>5</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c NetSh Advfirewall set allprofiles state off</CommandLine>
+					<Order>14</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config maxconn=30</CommandLine>
-					<Order>6</Order>
+					<Order>15</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c tlntadmn config timeout=10:0:0</CommandLine>
-					<Order>7</Order>
+					<Order>16</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c net start telnet</CommandLine>
-					<Order>8</Order>
+					<Order>17</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\autoit3.exe  E:\git\git.au3</CommandLine>
-					<Order>9</Order>
+					<Order>18</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} USEPLATFORMCLOCK yes</CommandLine>
-					<Order>10</Order>
+          <!-- This is for OS time compensation, https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-KVM_guest_timing_management.html -->
+					<Order>19</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c bcdedit /set {current} bootstatuspolicy ignoreallfailures</CommandLine>
-					<Order>11</Order>
+					<Order>20</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c netsh interface ip set address "Local Area Connection" dhcp</CommandLine>
-					<Order>12</Order>
-				</SynchronousCommand>
-				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_BALLOON_INSTALLER</CommandLine>
-					<Order>13</Order>
+					<Order>21</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c KVM_TEST_VIRTIO_QXL_INSTALLER</CommandLine>
-					<Order>14</Order>
+					<Order>22</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss.bat</CommandLine>
-					<Order>15</Order>
+					<Order>23</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\Dism /online /enable-feature /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess</CommandLine>
-					<Order>16</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess /logpath:C:\install-NetFx3-log.txt</CommandLine>
+          <!-- Enable .Net Framework version 3.X, and write down the log -->
+					<Order>24</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\setupsp.bat</CommandLine>
-					<Order>17</Order>
+					<Order>25</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
 					<CommandLine>%WINDIR%\System32\cmd /c E:\software_install_64.bat</CommandLine>
-					<Order>18</Order>
+					<Order>26</Order>
 				</SynchronousCommand>
 				<SynchronousCommand wcm:action="add">
-					<CommandLine>%WINDIR%\System32\cmd /c wmic datafile where "filename='finish' and extension='bat'" call copy "c:\\finish.bat" &amp;&amp; c:\finish.bat PROCESS_CHECK</CommandLine>
-					<Order>19</Order>
+					<CommandLine>%WINDIR%\System32\cmd /c Dism /online /enable-feature /norestart /All /LimitAccess /featurename:MicrosoftWindowsPowerShell /logpath:C:\install-MicrosoftWindowsPowerShell-log.txt</CommandLine>
+          <!-- Enable PowerShell, and write down the log -->
+          <!-- Packages for each OS: http://technet.microsoft.com/en-us/library/ff699034.aspx -->
+					<Order>27</Order>
 				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c SCHTASKS /Create /SC ONLOGON /TN Desktop-Start-W8 /TR explorer</CommandLine>
+					<Order>28</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>cmd /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v IPCheck /t REG_SZ /d "cmd /c ipconfig > COM1" </CommandLine>
+					<Order>29</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+					<CommandLine>%WINDIR%\System32\cmd /c E:\setuprss6.bat</CommandLine>
+					<Order>30</Order>
+				</SynchronousCommand>
+				<SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c wusa.exe E:\CVE-update\windows8-rt-kb4056896-x64.msu /quiet /norestart</CommandLine>
+                                        <Order>31</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc config wuauserv start= disabled</CommandLine>
+                                        <Order>32</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c sc stop wuauserv</CommandLine>
+                                        <Order>33</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c verifier.exe /standard /driver viostor.sys netkvm.sys vioscsi.sys balloon.sys vioser.sys viorng.sys vioinput.sys hidclass.sys hidparse.sys viohidkmdf.sys pvpanic.sys</CommandLine>
+                                        <Order>34</Order>
+                                </SynchronousCommand>
+                                <SynchronousCommand wcm:action="add">
+                                        <CommandLine>%WINDIR%\System32\cmd /c E:\finish.bat PROCESS_CHECK "" -AccomplishWinUpdates</CommandLine>
+          <!-- When modifying cmds, pls keep finish.bat always the last one. -->
+                                        <Order>35</Order>
+                                </SynchronousCommand>
 			</FirstLogonCommands>
 		</component>
 	</settings>
diff --git a/shared/unattended/winxp32.sif b/shared/unattended/winxp32.sif
index 731ece14..fd34d2e1 100644
--- a/shared/unattended/winxp32.sif
+++ b/shared/unattended/winxp32.sif
@@ -18,7 +18,7 @@ WaitForReboot=no
 [GuiUnattended]
 AdminPassword="1q2w3eP"
 EncryptedAdminPassword=NO
-TimeZone=85
+TimeZone=210
 OemSkipWelcome=1
 AutoLogon=Yes
 AutoLogonCount=1000
diff --git a/test-providers.d/io-github-autotest-libvirt.ini b/test-providers.d/io-github-autotest-libvirt.ini
deleted file mode 100644
index 1e06aad9..00000000
--- a/test-providers.d/io-github-autotest-libvirt.ini
+++ /dev/null
@@ -1,10 +0,0 @@
-[provider]
-uri: https://github.com/autotest/tp-libvirt.git
-[libvirt]
-subdir: libvirt/
-[libguestfs]
-subdir: libguestfs/
-[lvsb]
-subdir: lvsb/
-[v2v]
-subdir: v2v/
diff --git a/test-providers.d/io-github-spiceqa-spice.ini b/test-providers.d/io-github-spiceqa-spice.ini
deleted file mode 100644
index 3a37ddc2..00000000
--- a/test-providers.d/io-github-spiceqa-spice.ini
+++ /dev/null
@@ -1,5 +0,0 @@
-[provider]
-uri: https://github.com/spiceqa/tp-spice.git
-[spice]
-subdir: spice/
-configs: build.cfg, run.cfg, spice-base.cfg, tests.cfg, tests-variants.cfg, join.cfg
diff --git a/virttest/qemu_devices/qcontainer.py b/virttest/qemu_devices/qcontainer.py
index 3cc8519b..10f08842 100644
--- a/virttest/qemu_devices/qcontainer.py
+++ b/virttest/qemu_devices/qcontainer.py
@@ -24,6 +24,8 @@ from avocado.utils import process
 import six
 from six.moves import xrange
 
+from virttest.qemu_devices.qdevices import ThrottleGroupManager
+
 try:
     from collections.abc import Sequence
 except ImportError:
@@ -164,6 +166,11 @@ class DevContainer(object):
         self.__iothread_manager = None
         self.__iothread_supported_devices = set()
         self.temporary_image_snapshots = set()
+        self.throttle_group_manger = ThrottleGroupManager()
+
+    #wq
+    def get_throttle_group_manger(self):
+        return self.throttle_group_manger
 
     def initialize_iothread_manager(self, params, guestcpuinfo):
         """Initialize iothread manager.
@@ -1556,7 +1563,7 @@ class DevContainer(object):
                                    scsi=None, drv_extra_params=None,
                                    num_queues=None, bus_extra_params=None,
                                    force_fmt=None, image_encryption=None,
-                                   image_access=None):
+                                   image_access=None, image_filter_throttle=None):
         """
         Creates related devices by variables
         :note: To skip the argument use None, to disable it use False
@@ -1910,6 +1917,18 @@ class DevContainer(object):
             format_node.add_child_node(protocol_node)
             devices.append(protocol_node)
             devices.append(format_node)
+            top_node=format_node
+            # wq add filter node
+            if image_filter_throttle:
+                filter_node=qdevices.QBlockdevFilterThrottle(name,image_filter_throttle)
+                filter_node.add_child_node(format_node)
+                devices.append(filter_node)
+                top_node=filter_node
+                # devices.insert(-2,filter_node)
+                filter_node.set_param('file', format_node.get_qid())
+                format_node.set_param('file', protocol_node.get_qid())
+
+
         else:
             if self.has_hmp_cmd('__com.redhat_drive_add') and use_device:
                 devices.append(qdevices.QRHDrive(name))
@@ -1920,6 +1939,9 @@ class DevContainer(object):
             else:       # very old qemu without 'addr' support
                 devices.append(qdevices.QOldDrive(name, use_device))
 
+            format_node = devices[-1]
+            protocol_node = format_node
+
         if Flags.BLOCKDEV in self.caps:
             for opt, val in zip(('serial', 'boot'), (serial, boot)):
                 if val is not None:
@@ -1927,16 +1949,16 @@ class DevContainer(object):
                                  "on %s by -blockdev." % (opt, name))
             if media == 'cdrom':
                 readonly = 'on'
-            devices[-2].set_param('read-only', readonly, bool)
-            devices[-1].set_param('read-only', readonly, bool)
+            protocol_node.set_param('read-only', readonly, bool)
+            format_node.set_param('read-only', readonly, bool)
             if secret_obj:
-                if isinstance(devices[-1], qdevices.QBlockdevFormatQcow2):
-                    devices[-1].set_param('encrypt.format',
+                if isinstance(format_node, qdevices.QBlockdevFormatQcow2):
+                    format_node.set_param('encrypt.format',
                                           image_encryption.format)
-                    devices[-1].set_param('encrypt.key-secret',
+                    format_node.set_param('encrypt.key-secret',
                                           secret_obj.get_qid())
-                elif isinstance(devices[-1], qdevices.QBlockdevFormatLuks):
-                    devices[-1].set_param('key-secret', secret_obj.get_qid())
+                elif isinstance(format_node, qdevices.QBlockdevFormatLuks):
+                    format_node.set_param('key-secret', secret_obj.get_qid())
         else:
             devices[-1].set_param('if', 'none')
             devices[-1].set_param('rerror', rerror)
@@ -1959,12 +1981,12 @@ class DevContainer(object):
                 logging.warn('snapshot is on, fallback aio to threads.')
                 aio = 'threads'
             if Flags.BLOCKDEV in self.caps:
-                if isinstance(devices[-2], (qdevices.QBlockdevProtocolFile,
+                if isinstance(protocol_node, (qdevices.QBlockdevProtocolFile,
                                             qdevices.QBlockdevProtocolHostDevice,
                                             qdevices.QBlockdevProtocolHostCdrom)):
-                    devices[-2].set_param('aio', aio)
+                    protocol_node.set_param('aio', aio)
             else:
-                devices[-1].set_param('aio', aio)
+                format_node.set_param('aio', aio)
             if aio == 'native':
                 # Since qemu 2.6, aio=native has no effect without
                 # cache.direct=on or cache=none, It will be error out.
@@ -1978,26 +2000,26 @@ class DevContainer(object):
             if filename:
                 file_opts = qemu_storage.filename_to_file_opts(filename)
                 for key, value in six.iteritems(file_opts):
-                    devices[-2].set_param(key, value)
+                    protocol_node.set_param(key, value)
 
             if access_secret is not None:
                 if secret_type == 'password':
-                    devices[-2].set_param('password-secret',
+                    protocol_node.set_param('password-secret',
                                           access_secret_obj.get_qid())
                 elif secret_type == 'key':
-                    devices[-2].set_param('key-secret',
+                    protocol_node.set_param('key-secret',
                                           access_secret_obj.get_qid())
 
             if iscsi_initiator:
-                devices[-2].set_param('initiator-name', iscsi_initiator)
+                protocol_node.set_param('initiator-name', iscsi_initiator)
             if gluster_debug:
-                devices[-2].set_param('debug', int(gluster_debug))
+                protocol_node.set_param('debug', int(gluster_debug))
             if gluster_logfile:
-                devices[-2].set_param('logfile', gluster_logfile)
+                protocol_node.set_param('logfile', gluster_logfile)
             for key, value in six.iteritems(gluster_peers):
-                devices[-2].set_param(key, value)
+                protocol_node.set_param(key, value)
 
-            for dev in (devices[-1], devices[-2]):
+            for dev in (format_node, protocol_node):
                 if not cache:
                     direct, no_flush = (None, None)
                 else:
@@ -2005,7 +2027,8 @@ class DevContainer(object):
                                         self.cache_map[cache]['cache.no-flush'])
                 dev.set_param('cache.direct', direct)
                 dev.set_param('cache.no-flush', no_flush)
-            devices[-1].set_param('file', devices[-2].get_qid())
+
+            format_node.set_param('file', protocol_node.get_qid())
         else:
             devices[-1].set_param('cache', cache)
             devices[-1].set_param('media', media)
@@ -2037,8 +2060,8 @@ class DevContainer(object):
                 if Flags.BLOCKDEV in self.caps:
                     if key == 'discard':
                         value = re.sub('on', 'unmap', re.sub('off', 'ignore', value))
-                    devices[-2].set_param(key, value)
-                devices[-1].set_param(key, value)
+                    protocol_node.set_param(key, value)
+                format_node.set_param(key, value)
         if not use_device:
             if fmt and fmt.startswith('scsi-'):
                 if scsi_hba == 'lsi53c895a' or scsi_hba == 'spapr-vscsi':
@@ -2047,24 +2070,24 @@ class DevContainer(object):
                                    'pflash', 'virtio'):
                 raise virt_vm.VMDeviceNotSupportedError(self.vmname,
                                                         fmt)
-            devices[-1].set_param('if', fmt)    # overwrite previously set None
+            format_node.set_param('if', fmt)    # overwrite previously set None
             if not fmt:     # When fmt unspecified qemu uses ide
                 fmt = 'ide'
-            devices[-1].set_param('index', index)
+            format_node.set_param('index', index)
             if fmt == 'ide':
-                devices[-1].parent_bus = ({'type': fmt.upper(), 'atype': fmt},)
+                format_node.parent_bus = ({'type': fmt.upper(), 'atype': fmt},)
             elif fmt == 'scsi':
                 if arch.ARCH in ('ppc64', 'ppc64le'):
-                    devices[-1].parent_bus = ({'atype': 'spapr-vscsi',
+                    format_node.parent_bus = ({'atype': 'spapr-vscsi',
                                                'type': 'SCSI'},)
                 else:
-                    devices[-1].parent_bus = ({'atype': 'lsi53c895a',
+                    format_node.parent_bus = ({'atype': 'lsi53c895a',
                                                'type': 'SCSI'},)
             elif fmt == 'floppy':
-                devices[-1].parent_bus = ({'type': fmt},)
+                format_node.parent_bus = ({'type': fmt},)
             elif fmt == 'virtio':
-                devices[-1].set_param('addr', pci_addr)
-                devices[-1].parent_bus = (pci_bus,)
+                format_node.set_param('addr', pci_addr)
+                format_node.parent_bus = (pci_bus,)
             if not media == 'cdrom':
                 logging.warn("Using -drive fmt=xxx for %s is unsupported "
                              "method, false errors might occur.", name)
@@ -2073,6 +2096,7 @@ class DevContainer(object):
         #
         # Device
         #
+        # idx will change above
         devices.append(qdevices.QDevice(params={}, aobject=name))
         devices[-1].parent_bus += ({'busid': 'drive_%s' % name}, dev_parent)
         if fmt in ("ide", "ahci"):
@@ -2262,7 +2286,8 @@ class DevContainer(object):
                                                image_params.get(
                                                    "force_drive_format"),
                                                image_encryption,
-                                               image_access)
+                                               image_access,
+                                               image_params.get("image_filter_throttle"))
 
     def serials_define_by_variables(self, serial_id, serial_type, chardev_id,
                                     bus_type=None, serial_name=None,
@@ -2575,6 +2600,17 @@ class DevContainer(object):
                                 parent_bus=parent_bus,
                                 child_bus=bus)
 
+    # wq add
+    def throttle_group_define_by_params(self, params, name):
+        throttle_group_parameter = params.get(
+            "throttle_group_parameter_%s" % name,
+            params.get("throttle_group_parameter"))
+        return self.throttle_group_manger.create_throttle_group(name,
+                                                                throttle_group_parameter)
+
+
+
+
     def memory_object_define_by_params(self, params, name):
         """
         Create memory object from params, default backend type is
diff --git a/virttest/qemu_devices/qdevices.py b/virttest/qemu_devices/qdevices.py
index 6bc61601..4e4df700 100644
--- a/virttest/qemu_devices/qdevices.py
+++ b/virttest/qemu_devices/qdevices.py
@@ -657,12 +657,22 @@ class QBlockdevNode(QCustomDevice):
         super(QBlockdevNode, self).__init__(
             "blockdev", {}, aobject, (), child_bus)
 
-        if is_root:
-            self.params['node-name'] = '%s_%s' % ('drive', aobject)
-        else:
-            self.params['node-name'] = '%s_%s' % (self.TYPE, aobject)
+        self.is_root=is_root
+        # if is_root:
+        #     self.params['node-name'] = '%s_%s' % ('drive', aobject)
+        # else:
+        #     self.params['node-name'] = '%s_%s' % (self.TYPE, aobject)
+        self.set_root(is_root)
         self.set_param('driver', self.TYPE)
 
+    def set_root(self,flag):
+        self.is_root = flag
+        if self.is_root:
+            self.params['node-name'] = '%s_%s' % ('drive', self.aobject)
+        else:
+            self.params['node-name'] = '%s_%s' % (self.TYPE, self.aobject)
+
+
     @staticmethod
     def _convert_blkdev_args(args):
         """
@@ -783,6 +793,7 @@ class QBlockdevFormatNode(QBlockdevNode):
         :param node: the blockdev node which will be added.
         :type node: qdevices.QBlockdevNode
         """
+        node.set_root(False)
         self._child_nodes.append(node)
 
     def del_child_node(self, node):
@@ -884,6 +895,21 @@ class QBlockdevProtocolRBD(QBlockdevProtocol):
     TYPE = 'rbd'
 
 
+#wq
+class QBlockdevFilter(QBlockdevFormatNode):
+    pass
+
+
+class QBlockdevFilterThrottle(QBlockdevFilter):
+    TYPE= "throttle"
+
+    def __init__(self, aobject,group):
+
+        # busid='throttle_%s' % aobject
+        # print("throttle busid:"+busid)
+        super(QBlockdevFilterThrottle, self).__init__(aobject)
+        self.set_param("throttle-group",group)
+
 class QBlockdevProtocolGluster(QBlockdevProtocol):
     """ New a protocol gluster blockdev node. """
     TYPE = 'gluster'
@@ -1239,6 +1265,106 @@ class QIOThread(QObject):
         """Verify if it is unplugged from VM."""
         return not self._is_attached_to_qemu(monitor)
 
+#wq
+class QThrottleGroup(QObject):
+    """throttle-group object.
+    attributes of throttle-group
+
+    """
+    KEY_MAP_TABLE={"iops":"x-iops"}
+
+    def __init__(self, throttle_group_id, raw):
+        if not raw:
+            #set default
+            pass
+
+        self.raw=raw
+        l=[]
+        for item in raw.split(","):
+            l.append(tuple(item.split("=")))
+        params=dict(l)
+        params["id"] = throttle_group_id
+        kwargs = dict(backend="throttle-group", params=params)
+        super(QThrottleGroup, self).__init__(**kwargs)
+        self.set_aid(throttle_group_id)
+        self.hook_drive_bus = None
+
+    # def __init__(self, throttle_group_id, params=None):
+    #     if params is None:
+    #         params = dict()
+    #     params["id"] = throttle_group_id
+    #     kwargs = dict(backend="throttle-group", params=params)
+    #     super(QThrottleGroup, self).__init__(**kwargs)
+    #     self.set_aid(throttle_group_id)
+    #     # self.iothread_bus = QIOThreadBus(throttle_group_id)
+    #     # self.add_child_bus(self.iothread_bus)
+
+
+    # def unplug_hook(self):
+    #     """Remove iothread from attached devices' params."""
+    #     for device in self.iothread_bus:
+    #         device.set_param("iothread", None)
+    #
+    # def unplug_unhook(self):
+    #     """Reset attached devices' params."""
+    #     for device in self.iothread_bus:
+    #         device.set_param(self.get_qid())
+
+    def hotplug_qmp(self):
+        """Return hotplug qmp command string."""
+        params = dict(self.params)
+        backend = params.pop("backend")
+        iothread_id = params.pop("id")
+        kwargs = {"qom-type": backend, "id": iothread_id, "props": { "limits":params}}
+        return "object-add", kwargs
+
+    def _is_attached_to_qemu(self, monitor):
+        """Check if iothread is in use by QEMU."""
+        out = QIOThread._query(monitor)
+        return any(self.get_qid() == iothread["id"] for iothread in out)
+
+    def verify_hotplug(self, out, monitor):
+        """Verify if it is plugged into VM."""
+        return self._is_attached_to_qemu(monitor)
+
+    def verify_unplug(self, out, monitor):
+        """Verify if it is unplugged from VM."""
+        return not self._is_attached_to_qemu(monitor)
+
+
+class ThrottleGroupManager(object):
+    def __init__(self):
+        self.groups = {}
+
+    def set_monitor(self,monitor):
+        self.monitor=monitor
+
+    def create_throttle_group(self, throttle_group_id, raw_string):
+        self.groups[throttle_group_id]=QThrottleGroup(throttle_group_id,raw_string)
+        return self.groups[throttle_group_id]
+
+    #object-add
+    def add_throttle_group(self, throttle_group_id, raw_string,monitor=None):
+        pass
+    #object-del
+    def delete_throttle_group(self, throttle_group_id,monitor=None):
+        pass
+
+    #return QThrottleGroup
+    def get_throttle_group(self, throttle_group_id):
+        pass
+
+    def query_throttle_group(self, throttle_group_id,monitor=None):
+        pass
+
+    #qom-set
+    def update_throttle_group(self, throttle_group_id,raw_string,monitor=None):
+        pass
+
+    #x-blockdev-reopen
+    def change_blockdev_other_group(self,node_name,file,throttle_group_id,monitor=None):
+        pass
+
 
 class Memory(QObject):
 
diff --git a/virttest/qemu_vm.py b/virttest/qemu_vm.py
index a6d34929..0df0cba4 100644
--- a/virttest/qemu_vm.py
+++ b/virttest/qemu_vm.py
@@ -42,6 +42,7 @@ from virttest import utils_vsock
 from virttest import error_event
 from virttest.compat_52lts import decode_to_text
 from virttest.qemu_devices import qdevices, qcontainer
+from virttest.qemu_devices.qdevices import ThrottleGroupManager
 from virttest.qemu_devices.utils import DeviceError
 from virttest.qemu_capabilities import Flags
 
@@ -202,6 +203,7 @@ class VM(virt_vm.BaseVM):
         self.last_boot_index = 0
         self.last_driver_index = 0
 
+
     def check_capability(self, capability):
         """
         Check whether the given capability is set in the vm capabilities.
@@ -1831,6 +1833,12 @@ class VM(virt_vm.BaseVM):
         # initialize iothread manager
         devices.initialize_iothread_manager(params, self.cpuinfo)
 
+        # TODO Wq add object throttle command line
+
+        for throttle_group in params.get("throttle_groups",
+                                         "").strip().split():
+            devices.insert(devices.throttle_group_define_by_params(params,throttle_group))
+
         # Add images (harddrives)
         for image_name in params.objects("images"):
             # FIXME: Use qemu_devices for handling indexes
